<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Example 1: Split-plot design with one qualitative and one quantitative level factor — example1 • agriTutorial</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Example 1: Split-plot design with one qualitative and one quantitative level factor — example1" />

<meta property="og:description" content="Gomez &amp;amp; Gomez (1984, p. 143) report a rice experiment with three 
             management practices (minimum, optimum, intensive), five different amounts of
             nitrogen (N) fertilizer (0, 50, 80, 110, 140 kg/ha), and three varieties (V1, V2, V3).
             The experiment involved variety and management as qualitative treatment factors and 
             nitrogen fertilizer as a quantitative treatment factor. Overall, 
             there were 45 treatments with three replicates in complete replicate blocks. 
             The fertilizer treatments were applied to main plots, the management practices to 
             split-plots and the varieties to split-split-plots." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agriTutorial</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Example 1: Split-plot design with one qualitative and one quantitative level factor</h1>
    
    <div class="hidden name"><code>example1.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Gomez &amp; Gomez (1984, p. 143) report a rice experiment with three 
             management practices (minimum, optimum, intensive), five different amounts of
             nitrogen (N) fertilizer (0, 50, 80, 110, 140 kg/ha), and three varieties (V1, V2, V3).
             The experiment involved variety and management as qualitative treatment factors and 
             nitrogen fertilizer as a quantitative treatment factor. Overall, 
             there were 45 treatments with three replicates in complete replicate blocks. 
             The fertilizer treatments were applied to main plots, the management practices to 
             split-plots and the varieties to split-split-plots.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Section 1
Section 1 examines treatment effects by fitting qualitative factorial models and 
the first analysis calculates a full analysis of variance (Table 1) for 
main plots (nitrogen), split-plots (management) and split-split-plots (variety). 
Each type of experimental unit (or "stratum") requires a separate error term in 
the fitted analysis.</p>
<p>The second analysis (Table 2) uses a REML mixed model analysis to find treatment means 
and SE's for each marginal treatment classification averaged over all the 
other treatment factors, together with estimates of pairwise contrasts of 
treatment means and the SE's of the pairwise treatment comparisons. 
This analysis fits the full set of nitrogen-by-variety interaction effects 
assuming additive management effects and the fit of the model is tested by 
a graphical plot of the model residuals. Residual plots provide an important 
check on model assumptions but many more options for model testing are 
available and further methods for diagnostic testing are examined in the 
subsequent examples.</p>
<p>The third analysis (Table 3) shows a mixed model analysis of the full factorial model 
fitted by REML using the lmer function of the lme4 package. Generally with 
mixed models, determination of the denominator degrees of freedom for 
Wald-type F- and t-statistics becomes an issue, and here we use the 
method proposed by Kenward &amp; Roger (1997).</p>
<p>Section 2
Section 2 examines treatment effects by fitting polynomial models and 
the first step calculates a full set of four raw polynomials for the 
5-levels of N using the poly() function. The N rates are re-scaled by 
division by 100 to improve numerical stability.</p>
<p>The second step fits a mixed model polynomial analysis of nitrogen effects 
assuming additive management effects (Table 7). In this analysis, 
most of the nitrogen treatment effect can be explained by linear and 
quadratic trend effects. but it is important to note that there is a 
non-negligible Variety x Cubic N interaction effect. This suggests 
that not all the varieties responded in a similar way to the N treatments 
and that some further analysis of the data may be required 
(see also the N plots of individual varieties and replicates in Fig 1).</p>
<p>The third step fits the required model for the actual fitted model coefficients 
(Table 8). When estimating model effects, only effects that are significant for 
the fitted model or that are marginal to those effects (functional marginality) 
should be included in the model therefore only linear and quadratic nitrogen effects 
are included in this model. The fitted model for the nitrogen effects fits the actual 
actual nitrogen levels used in the experiment therefore this model provides the 
required coefficients for the actual applied nitrogen levels.</p>
    <p>Section 3</p>
<p>Section 3 provides checks on some of the assumptions underlying 
the blocks-by-treatments model.</p>
<p>The first analysis in this section shows a complete partition of 
the blocks-by-treatments interaction effects into factorial mean 
square terms where all the terms that contain a replicate:variety 
interaction effect are estimates of the split-split-plot error 
variance. If the blocks-by-treatments assumptions are valid, 
all the estimates of the split-split-plot error variance are 
expected to have the same error mean square. However, 
the Replicate:variety effect has a mean square of 1.54 on 4 
degrees of freedom whereas the Replicate:management:variety:nitrogen 
effect has a mean square of 0.26 on 32 degrees of freedom. 
The ratio of these mean squares is 5.92 with an F-probability of 
0.00110 on 4 and 32 degrees of freedom, which means that the 
Replicate:variety interaction effect is significantly inflated 
relative to the Replicate:management:variety:nitrogen effect. 
This shows that the assumptions underlying the blocks-by-treatments 
analysis of the model are invalid with a high level of probability.</p>
<p>The 4 degrees of freedom in the Replicate:variety interaction 
effect are the differences between the three varieties differenced 
between the three replicate blocks. Fig S1 shows graphical plots 
of variety effects in each replicate block averaged over management 
effects, and there is clear evidence that the effects of Variety 1 
in blocks 1 and 2 were different from the effects of Variety 1 in 
block 3.</p>
<p>The second analysis in Section 3 shows a complete partition of the 
blocks-by-treatments interaction effects into factorial mean square 
terms ignoring Variety 1. This analysis shows a reasonably good fit 
to the assumed additive block which supports the hypothesis that 
the non-additivity of the block-and-treatment effects in the full 
unrestricted analysis is mainly due to Variety 1.</p>
<p>The final analysis in Section 3 shows an analysis of variance of 
the treatment effects ignoring Variety 1. In this analysis, 
the management:variety interaction effect becomes significant at 
the 0.00992 probability level compared with a non-significant 
management:variety interaction effect in the analysis of the 
full data set.</p>
<p>Such anomalies are not uncommon in the analysis of real data sets 
and it is the task of the statistician to identify anomalies as 
and when they occur. Factorial designs can be very powerful for 
practical research but, as demonstrated with this data set, 
the analysis of such designs is complex and anomalies can be 
easily missed. Unless an anomaly is due to an easily identified 
cause such as an incorrectly recorded data point, it is likely 
that the anomaly will need to be investigated by further 
discussion with the research workers. It is a mistake to suppose 
that data from a designed experiment can be analysed statistically 
in isolation from the research workers who conducted the experiment.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <ol>
<li><p>Gomez, K. A., &amp; Gomez, A. A. (1984). <em>Statistical Procedures for Agricultural Research</em>.   John Wiley &amp; Sons.</p></li>
<li><p>Kenward, M. G., &amp; Roger, J. H. (1997). Small sample inference for fixed effects from restricted maximum likelihood. <em>Biometrics</em>,  <strong>53</strong>, 983–997.</p></li>
<li><p>Piepho, H., &amp; Edmondson, R. (2018). A tutorial on the Statistical Analysis of Factorial Experiments with Qualitative and Quantitative treatment factor levels. 
               <em>Journal of Agronomy and Crop Science.</em> (<a href='https://onlinelibrary.wiley.com/doi/full/10.1111/jac.12267'>https://onlinelibrary.wiley.com/doi/full/10.1111/jac.12267</a>).</p></li>
</ol>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>broom</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘broom’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:agriTutorial’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    tidyMCMC</span></div><div class='input'><span class='fu'>library</span>(<span class='no'>broom.mixed</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘broom.mixed’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:broom’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    tidyMCMC</span></div><div class='input'><span class='fu'>library</span>(<span class='no'>dplyr</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘dplyr’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:agriTutorial’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    collapse</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    filter, lag</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    intersect, setdiff, setequal, union</span></div><div class='input'><span class='fu'>library</span>(<span class='no'>emmeans</span>)</div><div class='output co'>#&gt; <span class='message'>NOTE: As of emmeans versions &gt; 1.2.3,</span>
#&gt; <span class='message'>      The 'cld' function will be deprecated in favor of 'CLD'.</span>
#&gt; <span class='message'>      You may use 'cld' only if you have package:multcomp attached.</span></div><div class='input'><span class='fu'>library</span>(<span class='no'>ggfortify</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: ggplot2</span></div><div class='input'><span class='fu'>library</span>(<span class='no'>ggplot2</span>)
<span class='fu'>library</span>(<span class='no'>lmerTest</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: lme4</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘lme4’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:agriTutorial’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    lmer, lmList</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘lmerTest’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:lme4’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    lmer</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    step</span></div><div class='input'><span class='fu'>library</span>(<span class='no'>magrittr</span>)
<span class='fu'>library</span>(<span class='no'>nlme</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘nlme’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:lme4’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    lmList</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:dplyr’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    collapse</span></div><div class='input'><span class='fu'>library</span>(<span class='no'>pbkrtest</span>)

<span class='fu'>options</span>(<span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>'contr.treatment'</span>, <span class='st'>'contr.poly'</span>))

<span class='co'>##----fm1.1----</span>
<span class='no'>fm1.1</span> <span class='kw'>&lt;-</span> <span class='fu'>aov</span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>nitrogen</span> * <span class='no'>management</span> * <span class='no'>variety</span> +
               <span class='fu'>Error</span>(<span class='no'>Replicate</span>/<span class='no'>nitrogen</span>/<span class='no'>management</span>), <span class='no'>rice</span>)

<span class='no'>fm1.1.Summary</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/tidy'>tidy</a></span>(<span class='no'>fm1.1</span>)
<span class='no'>fm1.1.Summary</span></div><div class='output co'>#&gt; # A tibble: 11 x 7
#&gt;    stratum            term               df   sumsq  meansq statistic   p.value
#&gt;    &lt;chr&gt;              &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
#&gt;  1 Replicate          Replicate           2   0.732   0.366    NA     NA       
#&gt;  2 Replicate:nitrogen nitrogen            4  61.6    15.4      27.7    9.73e- 5
#&gt;  3 Replicate:nitrogen Residuals           8   4.45    0.556    NA     NA       
#&gt;  4 Replicate:nitroge… management          2  42.9    21.5      82.0    2.30e-10
#&gt;  5 Replicate:nitroge… nitrogen:manag…     8   1.10    0.138     0.527  8.23e- 1
#&gt;  6 Replicate:nitroge… Residuals          20   5.24    0.262    NA     NA       
#&gt;  7 Within             variety             2 206.    103.      208.     1.06e-27
#&gt;  8 Within             nitrogen:varie…     8  14.1     1.77      3.57   1.92e- 3
#&gt;  9 Within             management:var…     4   3.85    0.963     1.94   1.15e- 1
#&gt; 10 Within             nitrogen:manag…    16   3.70    0.231     0.467  9.54e- 1
#&gt; 11 Within             Residuals          60  29.7     0.496    NA     NA       </div><div class='input'>
<span class='co'>##----fm1.2----</span>
<span class='no'>fm1.2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>nitrogen</span> * <span class='no'>management</span> * <span class='no'>variety</span> +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>:<span class='no'>Sub</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>rice</span>)
<span class='no'>fm1.2.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm1.2</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='no'>fm1.2.ANOVA</span></div><div class='output co'>#&gt; Type I Analysis of Variance Table with Kenward-Roger's method
#&gt;                              Sum Sq Mean Sq NumDF DenDF  F value    Pr(&gt;F)    
#&gt; Replicate                     0.575   0.288     2     8   0.6578 0.5439096    
#&gt; nitrogen                     48.424  12.106     4     8  27.6953 9.734e-05 ***
#&gt; management                   42.936  21.468     2    20  49.1136 1.919e-08 ***
#&gt; variety                     206.013 103.007     2    60 235.6535 &lt; 2.2e-16 ***
#&gt; nitrogen:management           1.103   0.138     8    20   0.3154 0.9508797    
#&gt; nitrogen:variety             14.145   1.768     8    60   4.0449 0.0006765 ***
#&gt; management:variety            3.852   0.963     4    60   2.2030 0.0793657 .  
#&gt; nitrogen:management:variety   3.699   0.231    16    60   0.5289 0.9210465    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>


<span class='co'>##----fm1.3----</span>
<span class='no'>fm1.3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>nitrogen</span> + <span class='no'>management</span> + <span class='no'>variety</span> + <span class='no'>nitrogen</span>:<span class='no'>variety</span> +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>:<span class='no'>Sub</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>rice</span>)
<span class='no'>fm1.3.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm1.3</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/emmeans/topics/emmeans'>emmeans</a></span>(<span class='no'>fm1.3</span>, ~ <span class='no'>nitrogen</span>)</div><div class='output co'>#&gt; <span class='message'>NOTE: Results may be misleading due to involvement in interactions</span></div><div class='output co'>#&gt;  nitrogen   emmean        SE df lower.CL upper.CL
#&gt;  0        5.384704 0.1435552  8 5.053665 5.715743
#&gt;  50       6.220333 0.1435552  8 5.889294 6.551372
#&gt;  80       6.995741 0.1435552  8 6.664702 7.326780
#&gt;  110      6.937370 0.1435552  8 6.606331 7.268409
#&gt;  140      7.233926 0.1435552  8 6.902887 7.564965
#&gt; 
#&gt; Results are averaged over the levels of: Replicate, management, variety 
#&gt; Degrees-of-freedom method: kenward-roger 
#&gt; Confidence level used: 0.95 </div><div class='input'><span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/emmeans/topics/emmeans'>emmeans</a></span>(<span class='no'>fm1.3</span>, ~ <span class='no'>variety</span>)</div><div class='output co'>#&gt; <span class='message'>NOTE: Results may be misleading due to involvement in interactions</span></div><div class='output co'>#&gt;  variety   emmean        SE    df lower.CL upper.CL
#&gt;  V1      5.126822 0.1005263 39.72 4.923606 5.330038
#&gt;  V2      6.396133 0.1005263 39.72 6.192917 6.599349
#&gt;  V3      8.140289 0.1005263 39.72 7.937073 8.343505
#&gt; 
#&gt; Results are averaged over the levels of: Replicate, nitrogen, management 
#&gt; Degrees-of-freedom method: kenward-roger 
#&gt; Confidence level used: 0.95 </div><div class='input'><span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/emmeans/topics/emmeans'>emmeans</a></span>(<span class='no'>fm1.3</span>, ~ <span class='no'>nitrogen</span> * <span class='no'>variety</span>)</div><div class='output co'>#&gt;  nitrogen variety   emmean        SE    df lower.CL upper.CL
#&gt;  0        V1      4.513111 0.2247837 39.72 4.058706 4.967516
#&gt;  50       V1      4.763667 0.2247837 39.72 4.309262 5.218071
#&gt;  80       V1      5.834889 0.2247837 39.72 5.380484 6.289294
#&gt;  110      V1      5.444667 0.2247837 39.72 4.990262 5.899071
#&gt;  140      V1      5.077778 0.2247837 39.72 4.623373 5.532182
#&gt;  0        V2      5.162889 0.2247837 39.72 4.708484 5.617294
#&gt;  50       V2      6.016222 0.2247837 39.72 5.561818 6.470627
#&gt;  80       V2      6.588556 0.2247837 39.72 6.134151 7.042960
#&gt;  110      V2      6.924556 0.2247837 39.72 6.470151 7.378960
#&gt;  140      V2      7.288444 0.2247837 39.72 6.834040 7.742849
#&gt;  0        V3      6.478111 0.2247837 39.72 6.023706 6.932516
#&gt;  50       V3      7.881111 0.2247837 39.72 7.426706 8.335516
#&gt;  80       V3      8.563778 0.2247837 39.72 8.109373 9.018182
#&gt;  110      V3      8.442889 0.2247837 39.72 7.988484 8.897294
#&gt;  140      V3      9.335556 0.2247837 39.72 8.881151 9.789960
#&gt; 
#&gt; Results are averaged over the levels of: Replicate, management 
#&gt; Degrees-of-freedom method: kenward-roger 
#&gt; Confidence level used: 0.95 </div><div class='input'><span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/emmeans/topics/contrast'>contrast</a></span>(
  <span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/emmeans/topics/emmeans'>emmeans</a></span>(<span class='no'>fm1.3</span>, ~ <span class='no'>nitrogen</span><span class='kw'>|</span><span class='no'>variety</span>)
  , <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>
  , <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"pairwise"</span>
)</div><div class='output co'>#&gt; variety = V1:
#&gt;  contrast    estimate        SE    df t.ratio p.value
#&gt;  0 - 50    -0.2505556 0.3178922 39.72  -0.788  0.9326
#&gt;  0 - 80    -1.3217778 0.3178922 39.72  -4.158  0.0015
#&gt;  0 - 110   -0.9315556 0.3178922 39.72  -2.930  0.0420
#&gt;  0 - 140   -0.5646667 0.3178922 39.72  -1.776  0.4012
#&gt;  50 - 80   -1.0712222 0.3178922 39.72  -3.370  0.0138
#&gt;  50 - 110  -0.6810000 0.3178922 39.72  -2.142  0.2230
#&gt;  50 - 140  -0.3141111 0.3178922 39.72  -0.988  0.8591
#&gt;  80 - 110   0.3902222 0.3178922 39.72   1.228  0.7356
#&gt;  80 - 140   0.7571111 0.3178922 39.72   2.382  0.1416
#&gt;  110 - 140  0.3668889 0.3178922 39.72   1.154  0.7768
#&gt; 
#&gt; variety = V2:
#&gt;  contrast    estimate        SE    df t.ratio p.value
#&gt;  0 - 50    -0.8533333 0.3178922 39.72  -2.684  0.0744
#&gt;  0 - 80    -1.4256667 0.3178922 39.72  -4.485  0.0006
#&gt;  0 - 110   -1.7616667 0.3178922 39.72  -5.542  &lt;.0001
#&gt;  0 - 140   -2.1255556 0.3178922 39.72  -6.686  &lt;.0001
#&gt;  50 - 80   -0.5723333 0.3178922 39.72  -1.800  0.3877
#&gt;  50 - 110  -0.9083333 0.3178922 39.72  -2.857  0.0500
#&gt;  50 - 140  -1.2722222 0.3178922 39.72  -4.002  0.0023
#&gt;  80 - 110  -0.3360000 0.3178922 39.72  -1.057  0.8270
#&gt;  80 - 140  -0.6998889 0.3178922 39.72  -2.202  0.2002
#&gt;  110 - 140 -0.3638889 0.3178922 39.72  -1.145  0.7819
#&gt; 
#&gt; variety = V3:
#&gt;  contrast    estimate        SE    df t.ratio p.value
#&gt;  0 - 50    -1.4030000 0.3178922 39.72  -4.413  0.0007
#&gt;  0 - 80    -2.0856667 0.3178922 39.72  -6.561  &lt;.0001
#&gt;  0 - 110   -1.9647778 0.3178922 39.72  -6.181  &lt;.0001
#&gt;  0 - 140   -2.8574444 0.3178922 39.72  -8.989  &lt;.0001
#&gt;  50 - 80   -0.6826667 0.3178922 39.72  -2.147  0.2209
#&gt;  50 - 110  -0.5617778 0.3178922 39.72  -1.767  0.4064
#&gt;  50 - 140  -1.4544444 0.3178922 39.72  -4.575  0.0004
#&gt;  80 - 110   0.1208889 0.3178922 39.72   0.380  0.9954
#&gt;  80 - 140  -0.7717778 0.3178922 39.72  -2.428  0.1290
#&gt;  110 - 140 -0.8926667 0.3178922 39.72  -2.808  0.0561
#&gt; 
#&gt; Results are averaged over the levels of: Replicate, management 
#&gt; P value adjustment: tukey method for comparing a family of 5 estimates </div><div class='input'>
<span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/emmeans/topics/contrast'>contrast</a></span>(
  <span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/emmeans/topics/emmeans'>emmeans</a></span>(<span class='no'>fm1.3</span>, ~ <span class='no'>variety</span><span class='kw'>|</span><span class='no'>nitrogen</span>)
  , <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>
  , <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"pairwise"</span>
)</div><div class='output co'>#&gt; nitrogen = 0:
#&gt;  contrast   estimate        SE df t.ratio p.value
#&gt;  V1 - V2  -0.6497778 0.2995978 80  -2.169  0.0828
#&gt;  V1 - V3  -1.9650000 0.2995978 80  -6.559  &lt;.0001
#&gt;  V2 - V3  -1.3152222 0.2995978 80  -4.390  0.0001
#&gt; 
#&gt; nitrogen = 50:
#&gt;  contrast   estimate        SE df t.ratio p.value
#&gt;  V1 - V2  -1.2525556 0.2995978 80  -4.181  0.0002
#&gt;  V1 - V3  -3.1174444 0.2995978 80 -10.405  &lt;.0001
#&gt;  V2 - V3  -1.8648889 0.2995978 80  -6.225  &lt;.0001
#&gt; 
#&gt; nitrogen = 80:
#&gt;  contrast   estimate        SE df t.ratio p.value
#&gt;  V1 - V2  -0.7536667 0.2995978 80  -2.516  0.0366
#&gt;  V1 - V3  -2.7288889 0.2995978 80  -9.109  &lt;.0001
#&gt;  V2 - V3  -1.9752222 0.2995978 80  -6.593  &lt;.0001
#&gt; 
#&gt; nitrogen = 110:
#&gt;  contrast   estimate        SE df t.ratio p.value
#&gt;  V1 - V2  -1.4798889 0.2995978 80  -4.940  &lt;.0001
#&gt;  V1 - V3  -2.9982222 0.2995978 80 -10.007  &lt;.0001
#&gt;  V2 - V3  -1.5183333 0.2995978 80  -5.068  &lt;.0001
#&gt; 
#&gt; nitrogen = 140:
#&gt;  contrast   estimate        SE df t.ratio p.value
#&gt;  V1 - V2  -2.2106667 0.2995978 80  -7.379  &lt;.0001
#&gt;  V1 - V3  -4.2577778 0.2995978 80 -14.212  &lt;.0001
#&gt;  V2 - V3  -2.0471111 0.2995978 80  -6.833  &lt;.0001
#&gt; 
#&gt; Results are averaged over the levels of: Replicate, management 
#&gt; P value adjustment: tukey method for comparing a family of 3 estimates </div><div class='input'>
<span class='co'>##----fm1.3.Plot----</span>
<span class='no'>fm1.3.Augment</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom.mixed</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom.mixed/topics/reexports'>augment</a></span>(<span class='no'>fm1.3</span>)

<span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggplot'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>fm1.3.Augment</span>, <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>.fitted</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>.resid</span>)) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_point'>geom_point</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_abline'>geom_hline</a></span>(<span class='kw'>yintercept</span> <span class='kw'>=</span> <span class='fl'>0</span>) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/labs'>labs</a></span>(
    <span class='kw'>x</span> <span class='kw'>=</span> <span class='st'>"Fitted"</span>
    , <span class='kw'>y</span> <span class='kw'>=</span> <span class='st'>"Residuals"</span>
    , <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>"Full analysis with full nitrogen effects"</span>) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme'>theme_bw</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/theme'>theme</a></span>(<span class='kw'>plot.title</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/element'>element_text</a></span>(<span class='kw'>hjust</span> <span class='kw'>=</span> <span class='fl'>0.5</span>))</div><div class='img'><img src='example1-1.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>##----fm1.4----</span>
<span class='no'>fm1.4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>nitrogen</span> * <span class='no'>management</span> * <span class='no'>variety</span> + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>) +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>:<span class='no'>Sub</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>rice</span>)
<span class='no'>fm1.4.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm1.4</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='no'>fm1.4.ANOVA</span></div><div class='output co'>#&gt; Type I Analysis of Variance Table with Kenward-Roger's method
#&gt;                              Sum Sq Mean Sq NumDF DenDF  F value    Pr(&gt;F)    
#&gt; Replicate                     0.575   0.288     2     8   0.6578 0.5439096    
#&gt; nitrogen                     48.424  12.106     4     8  27.6953 9.734e-05 ***
#&gt; management                   42.936  21.468     2    20  49.1136 1.919e-08 ***
#&gt; variety                     206.013 103.007     2    60 235.6535 &lt; 2.2e-16 ***
#&gt; nitrogen:management           1.103   0.138     8    20   0.3154 0.9508797    
#&gt; nitrogen:variety             14.145   1.768     8    60   4.0449 0.0006765 ***
#&gt; management:variety            3.852   0.963     4    60   2.2030 0.0793657 .  
#&gt; nitrogen:management:variety   3.699   0.231    16    60   0.5289 0.9210465    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>##----fm1.5----</span>
<span class='no'>fm1.5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>management</span> + <span class='no'>variety</span> * (<span class='no'>nrate</span> + <span class='fu'>I</span>(<span class='no'>nrate</span>^<span class='fl'>2</span>) +
                                                            <span class='fu'>I</span>(<span class='no'>nrate</span>^<span class='fl'>3</span>) + <span class='fu'>I</span>(<span class='no'>nrate</span>^<span class='fl'>4</span>)) +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>:<span class='no'>Sub</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>rice</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='input'><span class='no'>fm1.5.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm1.5</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='no'>fm1.5.ANOVA</span></div><div class='output co'>#&gt; Type I Analysis of Variance Table with Kenward-Roger's method
#&gt;                     Sum Sq Mean Sq NumDF DenDF  F value    Pr(&gt;F)    
#&gt; Replicate            0.531   0.266     2     8   0.6578   0.54391    
#&gt; management          42.936  21.468     2    28  53.1500 2.932e-10 ***
#&gt; variety            206.013 103.007     2    80 255.0206 &lt; 2.2e-16 ***
#&gt; nrate               40.624  40.624     1     8 100.5764 8.308e-06 ***
#&gt; I(nrate^2)           2.490   2.490     1     8   6.1642   0.03795 *  
#&gt; I(nrate^3)           0.038   0.038     1     8   0.0939   0.76713    
#&gt; I(nrate^4)           1.594   1.594     1     8   3.9469   0.08220 .  
#&gt; variety:nrate        9.861   4.930     2    80  12.2065 2.363e-05 ***
#&gt; variety:I(nrate^2)   0.804   0.402     2    80   0.9952   0.37417    
#&gt; variety:I(nrate^3)   2.783   1.392     2    80   3.4455   0.03669 *  
#&gt; variety:I(nrate^4)   0.696   0.348     2    80   0.8620   0.42618    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>##----fm1.6----</span>
<span class='no'>fm1.6</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>management</span> + <span class='no'>variety</span> * <span class='no'>nrate</span> + <span class='fu'>I</span>(<span class='no'>nrate</span>^<span class='fl'>2</span>) +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>:<span class='no'>Sub</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>rice</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='input'>
<span class='no'>fm1.6.Coef</span> <span class='kw'>&lt;-</span> <span class='fu'>summary</span>(<span class='no'>fm1.6</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>)$<span class='no'>coef</span>
<span class='no'>fm1.6.Coef</span></div><div class='output co'>#&gt;                          Estimate   Std. Error       df    t value     Pr(&gt;|t|)
#&gt; (Intercept)          3.838742e+00 2.478500e-01 31.46271 15.4881672 2.847136e-16
#&gt; ReplicateR2          1.179333e-01 1.725584e-01 10.00000  0.6834401 5.098535e-01
#&gt; ReplicateR3         -5.922222e-02 1.725584e-01 10.00000 -0.3432010 7.385530e-01
#&gt; managementOptimum    5.857778e-01 1.366639e-01 28.00000  4.2862662 1.941972e-04
#&gt; managementIntensive  1.376333e+00 1.366639e-01 28.00000 10.0709370 8.232324e-11
#&gt; varietyV2            5.374285e-01 2.543624e-01 86.00000  2.1128455 3.751250e-02
#&gt; varietyV3            2.008611e+00 2.543624e-01 86.00000  7.8966495 8.555669e-12
#&gt; nrate                1.612922e-02 5.108418e-03 12.37614  3.1573803 7.981951e-03
#&gt; I(nrate^2)          -7.528912e-05 3.327527e-05 10.00000 -2.2626148 4.715859e-02
#&gt; varietyV2:nrate      9.630034e-03 2.822766e-03 86.00000  3.4115590 9.862975e-04
#&gt; varietyV3:nrate      1.322179e-02 2.822766e-03 86.00000  4.6839816 1.043415e-05</div><div class='input'>
<span class='co'>##----fm1.6.Coefs----</span>
<span class='co'># fm1.6.Coef[ ,1, drop = FALSE]</span>

<span class='co'># Intercepts</span>
<span class='no'>fm1.6.Coef</span>[<span class='fl'>1</span>, <span class='fl'>1</span>] + <span class='fu'>sum</span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>2</span>:<span class='fl'>3</span>, <span class='fl'>1</span>])/<span class='fl'>3</span> + <span class='fu'>sum</span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>4</span>:<span class='fl'>5</span>, <span class='fl'>1</span>])/<span class='fl'>3</span></div><div class='output co'>#&gt; [1] 4.512349</div><div class='input'><span class='no'>fm1.6.Coef</span>[<span class='fl'>1</span>, <span class='fl'>1</span>] + <span class='fu'>sum</span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>2</span>:<span class='fl'>3</span>, <span class='fl'>1</span>])/<span class='fl'>3</span> + <span class='fu'>sum</span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>4</span>:<span class='fl'>5</span>, <span class='fl'>1</span>])/<span class='fl'>3</span> +
  <span class='no'>fm1.6.Coef</span>[<span class='fl'>6</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] 5.049778</div><div class='input'><span class='no'>fm1.6.Coef</span>[<span class='fl'>1</span>, <span class='fl'>1</span>] + <span class='fu'>sum</span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>2</span>:<span class='fl'>3</span>, <span class='fl'>1</span>])/<span class='fl'>3</span> + <span class='fu'>sum</span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>4</span>:<span class='fl'>5</span>, <span class='fl'>1</span>])/<span class='fl'>3</span> +
  <span class='no'>fm1.6.Coef</span>[<span class='fl'>7</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] 6.52096</div><div class='input'>
<span class='co'># Linear Slopes</span>
<span class='no'>fm1.6.Coef</span>[<span class='fl'>8</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] 0.01612922</div><div class='input'><span class='no'>fm1.6.Coef</span>[<span class='fl'>8</span>, <span class='fl'>1</span>] +  <span class='no'>fm1.6.Coef</span>[<span class='fl'>10</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] 0.02575925</div><div class='input'><span class='no'>fm1.6.Coef</span>[<span class='fl'>8</span>, <span class='fl'>1</span>] +  <span class='no'>fm1.6.Coef</span>[<span class='fl'>11</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] 0.02935101</div><div class='input'>
<span class='co'># Quadratic Slopes</span>
<span class='no'>fm1.6.Coef</span>[<span class='fl'>9</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] -7.528912e-05</div><div class='input'>
<span class='co'>##----fm1.7----</span>
<span class='no'>fm1.7</span> <span class='kw'>&lt;-</span> <span class='fu'>aov</span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span>*<span class='no'>management</span> * <span class='no'>variety</span> * <span class='no'>nitrogen</span>, <span class='no'>rice</span>)
<span class='no'>fm1.7.Summary</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/tidy'>tidy</a></span>(<span class='no'>fm1.7</span>)

<span class='no'>fm1.7.Summary</span></div><div class='output co'>#&gt; # A tibble: 15 x 4
#&gt;    term                                     df   sumsq  meansq
#&gt;    &lt;chr&gt;                                 &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
#&gt;  1 Replicate                                 2   0.732   0.366
#&gt;  2 management                                2  42.9    21.5  
#&gt;  3 variety                                   2 206.    103.   
#&gt;  4 nitrogen                                  4  61.6    15.4  
#&gt;  5 Replicate:management                      4   0.460   0.115
#&gt;  6 Replicate:variety                         4   6.15    1.54 
#&gt;  7 management:variety                        4   3.85    0.963
#&gt;  8 Replicate:nitrogen                        8   4.45    0.556
#&gt;  9 management:nitrogen                       8   1.10    0.138
#&gt; 10 variety:nitrogen                          8  14.1     1.77 
#&gt; 11 Replicate:management:variety              8   2.22    0.278
#&gt; 12 Replicate:management:nitrogen            16   4.78    0.299
#&gt; 13 Replicate:variety:nitrogen               16  13.1     0.820
#&gt; 14 management:variety:nitrogen              16   3.70    0.231
#&gt; 15 Replicate:management:variety:nitrogen    32   8.23    0.257</div><div class='input'>
<span class='co'>##----fm1.7.Rice----</span>
<span class='no'>Rice1</span> <span class='kw'>&lt;-</span>
  <span class='no'>rice</span> <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='http://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>Replicate</span>, <span class='no'>nitrogen</span>, <span class='no'>variety</span>) <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='http://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span>(<span class='kw'>Yield</span> <span class='kw'>=</span> <span class='fu'>mean</span>(<span class='no'>yield</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))

<span class='no'>Rice1</span></div><div class='output co'>#&gt; # A tibble: 45 x 4
#&gt; # Groups:   Replicate, nitrogen [?]
#&gt;    Replicate nitrogen variety Yield
#&gt;    &lt;fct&gt;     &lt;fct&gt;    &lt;fct&gt;   &lt;dbl&gt;
#&gt;  1 R1        0        V1       3.92
#&gt;  2 R1        0        V2       5.92
#&gt;  3 R1        0        V3       6.60
#&gt;  4 R1        50       V1       4.02
#&gt;  5 R1        50       V2       6.32
#&gt;  6 R1        50       V3       7.93
#&gt;  7 R1        80       V1       5.81
#&gt;  8 R1        80       V2       6.26
#&gt;  9 R1        80       V3       8.74
#&gt; 10 R1        110      V1       5.44
#&gt; # ... with 35 more rows</div><div class='input'>
<span class='no'>WideRice1</span> <span class='kw'>&lt;-</span>
  <span class='no'>Rice1</span> <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>tidyr</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/tidyr/topics/spread'>spread</a></span>(<span class='kw'>key</span> <span class='kw'>=</span> <span class='no'>nitrogen</span>, <span class='kw'>value</span> <span class='kw'>=</span> <span class='no'>Yield</span>) <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='http://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span>() <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='http://dplyr.tidyverse.org/reference/select.html'>select</a></span>(-<span class='no'>Replicate</span>, -<span class='no'>variety</span>)


<span class='co'>##----fm1.7.Plot1----</span>
<span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggplot'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>Rice1</span>, <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>nitrogen</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>Yield</span>,  <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>Replicate</span>)) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_path'>geom_line</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/facet_grid'>facet_grid</a></span>(<span class='no'>variety</span> ~ <span class='no'>Replicate</span>, <span class='kw'>labeller</span> <span class='kw'>=</span> <span class='no'>label_both</span>) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/labs'>labs</a></span>(
    <span class='kw'>x</span> <span class='kw'>=</span> <span class='st'>"Nitrogen"</span>
    , <span class='kw'>y</span> <span class='kw'>=</span> <span class='st'>"Yield"</span>
    , <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>"Fig S1. Variety response to nitrogen for individual replicate blocks"</span>
  ) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme'>theme_bw</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/theme'>theme</a></span>(<span class='kw'>plot.title</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/element'>element_text</a></span>(<span class='kw'>hjust</span> <span class='kw'>=</span> <span class='fl'>0.5</span>))</div><div class='img'><img src='example1-2.png' alt='' width='700' height='433' /></div><div class='input'>


<span class='co'>##----fm1.8----</span>
<span class='no'>riceV2V3</span> <span class='kw'>&lt;-</span>
  <span class='no'>rice</span> <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='http://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>variety</span> <span class='kw'>!=</span> <span class='st'>"V1"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'>droplevels</span>()

<span class='no'>fm1.8</span> <span class='kw'>&lt;-</span> <span class='fu'>aov</span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span>*<span class='no'>management</span> * <span class='no'>variety</span> * <span class='no'>nitrogen</span>, <span class='no'>riceV2V3</span>)
<span class='no'>fm1.8.ANOVA</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/tidy'>tidy</a></span>(<span class='no'>fm1.8</span>)

<span class='no'>fm1.8.ANOVA</span></div><div class='output co'>#&gt; # A tibble: 15 x 4
#&gt;    term                                     df  sumsq meansq
#&gt;    &lt;chr&gt;                                 &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
#&gt;  1 Replicate                                 2  3.00   1.50 
#&gt;  2 management                                2 26.1   13.1  
#&gt;  3 variety                                   1 68.4   68.4  
#&gt;  4 nitrogen                                  4 64.0   16.0  
#&gt;  5 Replicate:management                      4  0.868  0.217
#&gt;  6 Replicate:variety                         2  0.518  0.259
#&gt;  7 management:variety                        2  3.68   1.84 
#&gt;  8 Replicate:nitrogen                        8  6.98   0.872
#&gt;  9 management:nitrogen                       8  0.842  0.105
#&gt; 10 variety:nitrogen                          4  1.78   0.444
#&gt; 11 Replicate:management:variety              4  1.24   0.311
#&gt; 12 Replicate:management:nitrogen            16  5.29   0.331
#&gt; 13 Replicate:variety:nitrogen                8  4.43   0.554
#&gt; 14 management:variety:nitrogen               8  3.22   0.402
#&gt; 15 Replicate:management:variety:nitrogen    16  4.03   0.252</div><div class='input'>
<span class='co'>##----fm1.9----</span>
<span class='no'>fm1.9</span> <span class='kw'>&lt;-</span> <span class='fu'>aov</span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>management</span> * <span class='no'>variety</span> * <span class='no'>nitrogen</span> +
               <span class='fu'>Error</span>(<span class='no'>Replicate</span>/<span class='no'>Main</span>/<span class='no'>Sub</span>), <span class='no'>riceV2V3</span>)
<span class='no'>fm1.9.ANOVA</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/tidy'>tidy</a></span>(<span class='no'>fm1.9</span>)
<span class='no'>fm1.9.ANOVA</span></div><div class='output co'>#&gt; # A tibble: 11 x 7
#&gt;    stratum         term                    df  sumsq meansq statistic   p.value
#&gt;    &lt;chr&gt;           &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
#&gt;  1 Replicate       Replicate                2  3.00   1.50     NA     NA       
#&gt;  2 Replicate:Main  nitrogen                 4 64.0   16.0      18.3    4.30e- 4
#&gt;  3 Replicate:Main  Residuals                8  6.98   0.872    NA     NA       
#&gt;  4 Replicate:Main… management               2 26.1   13.1      42.5    6.34e- 8
#&gt;  5 Replicate:Main… management:nitrogen      8  0.842  0.105     0.342  9.39e- 1
#&gt;  6 Replicate:Main… Residuals               20  6.16   0.308    NA     NA       
#&gt;  7 Within          variety                  1 68.4   68.4     201.     7.87e-15
#&gt;  8 Within          management:variety       2  3.68   1.84      5.40   9.92e- 3
#&gt;  9 Within          variety:nitrogen         4  1.78   0.444     1.30   2.91e- 1
#&gt; 10 Within          management:variety:…     8  3.22   0.402     1.18   3.43e- 1
#&gt; 11 Within          Residuals               30 10.2    0.341    NA     NA       </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
<ol>
<li><p>Rodney N. Edmondson (<a href='mailto:rodney.edmondson@gmail.com'>rodney.edmondson@gmail.com</a>)</p></li>
<li><p>Hans-Peter Piepho (<a href='mailto:piepho@uni-hohenheim.de'>piepho@uni-hohenheim.de</a>)</p></li>
<li><p>Muhammad Yaseen (<a href='mailto:myaseen208@gmail.com'>myaseen208@gmail.com</a>)</p></li>
</ol>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Rodney Edmondson, Hans-Peter Piepho, Muhammad Yaseen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

