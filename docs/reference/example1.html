<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Example 1: Split-plot design with one qualitative and one quantitative level factor — example1 • agriTutorial</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Example 1: Split-plot design with one qualitative and one quantitative level factor — example1" />
<meta property="og:description" content="Gomez &amp;amp; Gomez (1984, p. 143) report a rice experiment with three 
             management practices (minimum, optimum, intensive), five different amounts of
             nitrogen (N) fertilizer (0, 50, 80, 110, 140 kg/ha), and three varieties (V1, V2, V3).
             The experiment involved variety and management as qualitative treatment factors and 
             nitrogen fertilizer as a quantitative treatment factor. Overall, 
             there were 45 treatments with three replicates in complete replicate blocks. 
             The fertilizer treatments were applied to main plots, the management practices to 
             split-plots and the varieties to split-split-plots." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agriTutorial</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-o"></span>
     
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/IntroagriTutorial.pdf">Introduction to agriTutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/myaseen208/agriTutorial">
    <span class="fa fa-github-alt"></span>
     
    Github
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Example 1: Split-plot design with one qualitative and one quantitative level factor</h1>
    <small class="dont-index">Source: <a href='https://github.com/myaseen208/agriTutorial/blob/master/R/example1.R'><code>R/example1.R</code></a></small>
    <div class="hidden name"><code>example1.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Gomez &amp; Gomez (1984, p. 143) report a rice experiment with three 
             management practices (minimum, optimum, intensive), five different amounts of
             nitrogen (N) fertilizer (0, 50, 80, 110, 140 kg/ha), and three varieties (V1, V2, V3).
             The experiment involved variety and management as qualitative treatment factors and 
             nitrogen fertilizer as a quantitative treatment factor. Overall, 
             there were 45 treatments with three replicates in complete replicate blocks. 
             The fertilizer treatments were applied to main plots, the management practices to 
             split-plots and the varieties to split-split-plots.</p>
    </div>



    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Section 1
Section 1 examines treatment effects by fitting qualitative factorial models and 
the first analysis calculates a full analysis of variance (Table 1) for 
main plots (nitrogen), split-plots (management) and split-split-plots (variety). 
Each type of experimental unit (or "stratum") requires a separate error term in 
the fitted analysis.</p>
<p>The second analysis (Table 2) uses a REML mixed model analysis to find treatment means 
and SE's for each marginal treatment classification averaged over all the 
other treatment factors, together with estimates of pairwise contrasts of 
treatment means and the SE's of the pairwise treatment comparisons. 
This analysis fits the full set of nitrogen-by-variety interaction effects 
assuming additive management effects and the fit of the model is tested by 
a graphical plot of the model residuals. Residual plots provide an important 
check on model assumptions but many more options for model testing are 
available and further methods for diagnostic testing are examined in the 
subsequent examples.</p>
<p>The third analysis (Table 3) shows a mixed model analysis of the full factorial model 
fitted by REML using the lmer function of the lme4 package. Generally with 
mixed models, determination of the denominator degrees of freedom for 
Wald-type F- and t-statistics becomes an issue, and here we use the 
method proposed by Kenward &amp; Roger (1997).</p>
<p>Section 2
Section 2 examines treatment effects by fitting polynomial models and 
the first step calculates a full set of four raw polynomials for the 
5-levels of N using the poly() function. The N rates are re-scaled by 
division by 100 to improve numerical stability.</p>
<p>The second step fits a mixed model polynomial analysis of nitrogen effects 
assuming additive management effects (Table 7). In this analysis, 
most of the nitrogen treatment effect can be explained by linear and 
quadratic trend effects. but it is important to note that there is a 
non-negligible Variety x Cubic N interaction effect. This suggests 
that not all the varieties responded in a similar way to the N treatments 
and that some further analysis of the data may be required 
(see also the N plots of individual varieties and replicates in Fig 1).</p>
<p>The third step fits the required model for the actual fitted model coefficients 
(Table 8). When estimating model effects, only effects that are significant for 
the fitted model or that are marginal to those effects (functional marginality) 
should be included in the model therefore only linear and quadratic nitrogen effects 
are included in this model. The fitted model for the nitrogen effects fits the actual 
actual nitrogen levels used in the experiment therefore this model provides the 
required coefficients for the actual applied nitrogen levels.</p>

<p>Section 3</p>
<p>Section 3 provides checks on some of the assumptions underlying 
the blocks-by-treatments model.</p>
<p>The first analysis in this section shows a complete partition of 
the blocks-by-treatments interaction effects into factorial mean 
square terms where all the terms that contain a replicate:variety 
interaction effect are estimates of the split-split-plot error 
variance. If the blocks-by-treatments assumptions are valid, 
all the estimates of the split-split-plot error variance are 
expected to have the same error mean square. However, 
the Replicate:variety effect has a mean square of 1.54 on 4 
degrees of freedom whereas the Replicate:management:variety:nitrogen 
effect has a mean square of 0.26 on 32 degrees of freedom. 
The ratio of these mean squares is 5.92 with an F-probability of 
0.00110 on 4 and 32 degrees of freedom, which means that the 
Replicate:variety interaction effect is significantly inflated 
relative to the Replicate:management:variety:nitrogen effect. 
This shows that the assumptions underlying the blocks-by-treatments 
analysis of the model are invalid with a high level of probability.</p>
<p>The 4 degrees of freedom in the Replicate:variety interaction 
effect are the differences between the three varieties differenced 
between the three replicate blocks. Fig S1 shows graphical plots 
of variety effects in each replicate block averaged over management 
effects, and there is clear evidence that the effects of Variety 1 
in blocks 1 and 2 were different from the effects of Variety 1 in 
block 3.</p>
<p>The second analysis in Section 3 shows a complete partition of the 
blocks-by-treatments interaction effects into factorial mean square 
terms ignoring Variety 1. This analysis shows a reasonably good fit 
to the assumed additive block which supports the hypothesis that 
the non-additivity of the block-and-treatment effects in the full 
unrestricted analysis is mainly due to Variety 1.</p>
<p>The final analysis in Section 3 shows an analysis of variance of 
the treatment effects ignoring Variety 1. In this analysis, 
the management:variety interaction effect becomes significant at 
the 0.00992 probability level compared with a non-significant 
management:variety interaction effect in the analysis of the 
full data set.</p>
<p>Such anomalies are not uncommon in the analysis of real data sets 
and it is the task of the statistician to identify anomalies as 
and when they occur. Factorial designs can be very powerful for 
practical research but, as demonstrated with this data set, 
the analysis of such designs is complex and anomalies can be 
easily missed. Unless an anomaly is due to an easily identified 
cause such as an incorrectly recorded data point, it is likely 
that the anomaly will need to be investigated by further 
discussion with the research workers. It is a mistake to suppose 
that data from a designed experiment can be analysed statistically 
in isolation from the research workers who conducted the experiment.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>Gomez, K. A., &amp; Gomez, A. A. (1984). <em>Statistical Procedures for Agricultural Research</em>.   John Wiley &amp; Sons.</p></li>
<li><p>Kenward, M. G., &amp; Roger, J. H. (1997). Small sample inference for fixed effects from restricted maximum likelihood. <em>Biometrics</em>,  <strong>53</strong>, 983–997.</p></li>
<li><p>Piepho, H., &amp; Edmondson, R. (2018). A tutorial on the Statistical Analysis of Factorial Experiments with Qualitative and Quantitative treatment factor levels. 
               <em>Journal of Agronomy and Crop Science.</em> (<a href='https://onlinelibrary.wiley.com/doi/full/10.1111/jac.12267'>https://onlinelibrary.wiley.com/doi/full/10.1111/jac.12267</a>).</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>broom</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>broom.mixed</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘broom.mixed’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:broom’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    tidyMCMC</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘dplyr’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    filter, lag</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    intersect, setdiff, setequal, union</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>emmeans</span>)</div><div class='output co'>#&gt; <span class='message'>Welcome to emmeans.</span>
#&gt; <span class='message'>NOTE -- Important change from versions &lt;= 1.41:</span>
#&gt; <span class='message'>    Indicator predictors are now treated as 2-level factors by default.</span>
#&gt; <span class='message'>    To revert to old behavior, use emm_options(cov.keep = character(0))</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggfortify</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: ggplot2</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggplot2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>lmerTest</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: lme4</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘lmerTest’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:lme4’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    lmer</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    step</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>magrittr</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>pbkrtest</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>tidyr</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘tidyr’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:magrittr’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    extract</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:Matrix’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    expand, pack, unpack</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'contr.treatment'</span>, <span class='st'>'contr.poly'</span>))

<span class='co'>##----fm1.1----</span>
<span class='no'>fm1.1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/aov.html'>aov</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>nitrogen</span> * <span class='no'>management</span> * <span class='no'>variety</span> +
               <span class='fu'><a href='https://rdrr.io/r/stats/aov.html'>Error</a></span>(<span class='no'>Replicate</span>/<span class='no'>nitrogen</span>/<span class='no'>management</span>), <span class='no'>rice</span>)

<span class='no'>fm1.1.Summary</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/broom/man/reexports.html'>tidy</a></span>(<span class='no'>fm1.1</span>)
<span class='no'>fm1.1.Summary</span></div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 11 x 7</span><span>
#&gt;    stratum            term                df   sumsq  meansq statistic   p.value
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>              </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>            </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> Replicate          Replicate            2   0.732   0.366    </span><span style='color: #BB0000;'>NA</span><span>     </span><span style='color: #BB0000;'>NA</span><span>   </span><span style='color: #555555;'> </span><span>   
#&gt; </span><span style='color: #555555;'> 2</span><span> Replicate:nitrogen nitrogen             4  61.6    15.4      27.7    9.73</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 5</span><span>
#&gt; </span><span style='color: #555555;'> 3</span><span> Replicate:nitrogen Residuals            8   4.45    0.556    </span><span style='color: #BB0000;'>NA</span><span>     </span><span style='color: #BB0000;'>NA</span><span>   </span><span style='color: #555555;'> </span><span>   
#&gt; </span><span style='color: #555555;'> 4</span><span> Replicate:nitroge… management           2  42.9    21.5      82.0    2.30</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>-10</span><span>
#&gt; </span><span style='color: #555555;'> 5</span><span> Replicate:nitroge… nitrogen:manage…     8   1.10    0.138     0.527  8.23</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 1</span><span>
#&gt; </span><span style='color: #555555;'> 6</span><span> Replicate:nitroge… Residuals           20   5.24    0.262    </span><span style='color: #BB0000;'>NA</span><span>     </span><span style='color: #BB0000;'>NA</span><span>   </span><span style='color: #555555;'> </span><span>   
#&gt; </span><span style='color: #555555;'> 7</span><span> Within             variety              2 206.    103.      208.     1.06</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>-27</span><span>
#&gt; </span><span style='color: #555555;'> 8</span><span> Within             nitrogen:variety     8  14.1     1.77      3.57   1.92</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 3</span><span>
#&gt; </span><span style='color: #555555;'> 9</span><span> Within             management:vari…     4   3.85    0.963     1.94   1.15</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 1</span><span>
#&gt; </span><span style='color: #555555;'>10</span><span> Within             nitrogen:manage…    16   3.70    0.231     0.467  9.54</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 1</span><span>
#&gt; </span><span style='color: #555555;'>11</span><span> Within             Residuals           60  29.7     0.496    </span><span style='color: #BB0000;'>NA</span><span>     </span><span style='color: #BB0000;'>NA</span><span>   </span><span style='color: #555555;'> </span><span>   </div><div class='input'>
<span class='co'>##----fm1.2----</span>
<span class='no'>fm1.2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lmerTest/man/lmer.html'>lmer</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>nitrogen</span> * <span class='no'>management</span> * <span class='no'>variety</span> +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>:<span class='no'>Sub</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>rice</span>)</div><div class='output co'>#&gt; <span class='message'>boundary (singular) fit: see ?isSingular</span></div><div class='input'><span class='no'>fm1.2.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span>(<span class='no'>fm1.2</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='no'>fm1.2.ANOVA</span></div><div class='output co'>#&gt; Type I Analysis of Variance Table with Kenward-Roger's method
#&gt;                              Sum Sq Mean Sq NumDF DenDF  F value    Pr(&gt;F)    
#&gt; Replicate                     0.575   0.288     2     8   0.6578 0.5439087    
#&gt; nitrogen                     48.424  12.106     4     8  27.6954 9.734e-05 ***
#&gt; management                   42.936  21.468     2    20  49.1136 1.919e-08 ***
#&gt; variety                     206.013 103.007     2    60 235.6534 &lt; 2.2e-16 ***
#&gt; nitrogen:management           1.103   0.138     8    20   0.3154 0.9508797    
#&gt; nitrogen:variety             14.145   1.768     8    60   4.0449 0.0006765 ***
#&gt; management:variety            3.852   0.963     4    60   2.2030 0.0793658 .  
#&gt; nitrogen:management:variety   3.699   0.231    16    60   0.5289 0.9210466    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>


<span class='co'>##----fm1.3----</span>
<span class='no'>fm1.3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lmerTest/man/lmer.html'>lmer</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>nitrogen</span> + <span class='no'>management</span> + <span class='no'>variety</span> + <span class='no'>nitrogen</span>:<span class='no'>variety</span> +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>:<span class='no'>Sub</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>rice</span>)</div><div class='output co'>#&gt; <span class='message'>boundary (singular) fit: see ?isSingular</span></div><div class='input'><span class='no'>fm1.3.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span>(<span class='no'>fm1.3</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span>(<span class='no'>fm1.3</span>, ~ <span class='no'>nitrogen</span>)</div><div class='output co'>#&gt; <span class='message'>NOTE: Results may be misleading due to involvement in interactions</span></div><div class='output co'>#&gt;  nitrogen emmean    SE df lower.CL upper.CL
#&gt;  0          5.38 0.144  8     5.05     5.72
#&gt;  50         6.22 0.144  8     5.89     6.55
#&gt;  80         7.00 0.144  8     6.66     7.33
#&gt;  110        6.94 0.144  8     6.61     7.27
#&gt;  140        7.23 0.144  8     6.90     7.56
#&gt; 
#&gt; Results are averaged over the levels of: Replicate, management, variety 
#&gt; Degrees-of-freedom method: kenward-roger 
#&gt; Confidence level used: 0.95 </div><div class='input'><span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span>(<span class='no'>fm1.3</span>, ~ <span class='no'>variety</span>)</div><div class='output co'>#&gt; <span class='message'>NOTE: Results may be misleading due to involvement in interactions</span></div><div class='output co'>#&gt;  variety emmean    SE   df lower.CL upper.CL
#&gt;  V1        5.13 0.101 39.7     4.92     5.33
#&gt;  V2        6.40 0.101 39.7     6.19     6.60
#&gt;  V3        8.14 0.101 39.7     7.94     8.34
#&gt; 
#&gt; Results are averaged over the levels of: Replicate, nitrogen, management 
#&gt; Degrees-of-freedom method: kenward-roger 
#&gt; Confidence level used: 0.95 </div><div class='input'><span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span>(<span class='no'>fm1.3</span>, ~ <span class='no'>nitrogen</span> * <span class='no'>variety</span>)</div><div class='output co'>#&gt;  nitrogen variety emmean    SE   df lower.CL upper.CL
#&gt;  0        V1        4.51 0.225 39.7     4.06     4.97
#&gt;  50       V1        4.76 0.225 39.7     4.31     5.22
#&gt;  80       V1        5.83 0.225 39.7     5.38     6.29
#&gt;  110      V1        5.44 0.225 39.7     4.99     5.90
#&gt;  140      V1        5.08 0.225 39.7     4.62     5.53
#&gt;  0        V2        5.16 0.225 39.7     4.71     5.62
#&gt;  50       V2        6.02 0.225 39.7     5.56     6.47
#&gt;  80       V2        6.59 0.225 39.7     6.13     7.04
#&gt;  110      V2        6.92 0.225 39.7     6.47     7.38
#&gt;  140      V2        7.29 0.225 39.7     6.83     7.74
#&gt;  0        V3        6.48 0.225 39.7     6.02     6.93
#&gt;  50       V3        7.88 0.225 39.7     7.43     8.34
#&gt;  80       V3        8.56 0.225 39.7     8.11     9.02
#&gt;  110      V3        8.44 0.225 39.7     7.99     8.90
#&gt;  140      V3        9.34 0.225 39.7     8.88     9.79
#&gt; 
#&gt; Results are averaged over the levels of: Replicate, management 
#&gt; Degrees-of-freedom method: kenward-roger 
#&gt; Confidence level used: 0.95 </div><div class='input'><span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/contrast.html'>contrast</a></span>(
  <span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span>(<span class='no'>fm1.3</span>, ~ <span class='no'>nitrogen</span><span class='kw'>|</span><span class='no'>variety</span>)
  , <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>
  , <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"pairwise"</span>
)</div><div class='output co'>#&gt; variety = V1:
#&gt;  contrast  estimate    SE   df t.ratio p.value
#&gt;  0 - 50      -0.251 0.318 39.7 -0.788  0.9326 
#&gt;  0 - 80      -1.322 0.318 39.7 -4.158  0.0015 
#&gt;  0 - 110     -0.932 0.318 39.7 -2.930  0.0420 
#&gt;  0 - 140     -0.565 0.318 39.7 -1.776  0.4012 
#&gt;  50 - 80     -1.071 0.318 39.7 -3.370  0.0138 
#&gt;  50 - 110    -0.681 0.318 39.7 -2.142  0.2230 
#&gt;  50 - 140    -0.314 0.318 39.7 -0.988  0.8591 
#&gt;  80 - 110     0.390 0.318 39.7  1.228  0.7356 
#&gt;  80 - 140     0.757 0.318 39.7  2.382  0.1416 
#&gt;  110 - 140    0.367 0.318 39.7  1.154  0.7768 
#&gt; 
#&gt; variety = V2:
#&gt;  contrast  estimate    SE   df t.ratio p.value
#&gt;  0 - 50      -0.853 0.318 39.7 -2.684  0.0744 
#&gt;  0 - 80      -1.426 0.318 39.7 -4.485  0.0006 
#&gt;  0 - 110     -1.762 0.318 39.7 -5.542  &lt;.0001 
#&gt;  0 - 140     -2.126 0.318 39.7 -6.686  &lt;.0001 
#&gt;  50 - 80     -0.572 0.318 39.7 -1.800  0.3877 
#&gt;  50 - 110    -0.908 0.318 39.7 -2.857  0.0500 
#&gt;  50 - 140    -1.272 0.318 39.7 -4.002  0.0023 
#&gt;  80 - 110    -0.336 0.318 39.7 -1.057  0.8270 
#&gt;  80 - 140    -0.700 0.318 39.7 -2.202  0.2002 
#&gt;  110 - 140   -0.364 0.318 39.7 -1.145  0.7819 
#&gt; 
#&gt; variety = V3:
#&gt;  contrast  estimate    SE   df t.ratio p.value
#&gt;  0 - 50      -1.403 0.318 39.7 -4.413  0.0007 
#&gt;  0 - 80      -2.086 0.318 39.7 -6.561  &lt;.0001 
#&gt;  0 - 110     -1.965 0.318 39.7 -6.181  &lt;.0001 
#&gt;  0 - 140     -2.857 0.318 39.7 -8.989  &lt;.0001 
#&gt;  50 - 80     -0.683 0.318 39.7 -2.147  0.2209 
#&gt;  50 - 110    -0.562 0.318 39.7 -1.767  0.4064 
#&gt;  50 - 140    -1.454 0.318 39.7 -4.575  0.0004 
#&gt;  80 - 110     0.121 0.318 39.7  0.380  0.9954 
#&gt;  80 - 140    -0.772 0.318 39.7 -2.428  0.1290 
#&gt;  110 - 140   -0.893 0.318 39.7 -2.808  0.0561 
#&gt; 
#&gt; Results are averaged over the levels of: Replicate, management 
#&gt; Degrees-of-freedom method: kenward-roger 
#&gt; P value adjustment: tukey method for comparing a family of 5 estimates </div><div class='input'>
<span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/contrast.html'>contrast</a></span>(
  <span class='kw pkg'>emmeans</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></span>(<span class='no'>fm1.3</span>, ~ <span class='no'>variety</span><span class='kw'>|</span><span class='no'>nitrogen</span>)
  , <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>
  , <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"pairwise"</span>
)</div><div class='output co'>#&gt; nitrogen = 0:
#&gt;  contrast estimate  SE df t.ratio p.value
#&gt;  V1 - V2    -0.650 0.3 80  -2.169 0.0828 
#&gt;  V1 - V3    -1.965 0.3 80  -6.559 &lt;.0001 
#&gt;  V2 - V3    -1.315 0.3 80  -4.390 0.0001 
#&gt; 
#&gt; nitrogen = 50:
#&gt;  contrast estimate  SE df t.ratio p.value
#&gt;  V1 - V2    -1.253 0.3 80  -4.181 0.0002 
#&gt;  V1 - V3    -3.117 0.3 80 -10.405 &lt;.0001 
#&gt;  V2 - V3    -1.865 0.3 80  -6.225 &lt;.0001 
#&gt; 
#&gt; nitrogen = 80:
#&gt;  contrast estimate  SE df t.ratio p.value
#&gt;  V1 - V2    -0.754 0.3 80  -2.516 0.0366 
#&gt;  V1 - V3    -2.729 0.3 80  -9.109 &lt;.0001 
#&gt;  V2 - V3    -1.975 0.3 80  -6.593 &lt;.0001 
#&gt; 
#&gt; nitrogen = 110:
#&gt;  contrast estimate  SE df t.ratio p.value
#&gt;  V1 - V2    -1.480 0.3 80  -4.940 &lt;.0001 
#&gt;  V1 - V3    -2.998 0.3 80 -10.007 &lt;.0001 
#&gt;  V2 - V3    -1.518 0.3 80  -5.068 &lt;.0001 
#&gt; 
#&gt; nitrogen = 140:
#&gt;  contrast estimate  SE df t.ratio p.value
#&gt;  V1 - V2    -2.211 0.3 80  -7.379 &lt;.0001 
#&gt;  V1 - V3    -4.258 0.3 80 -14.212 &lt;.0001 
#&gt;  V2 - V3    -2.047 0.3 80  -6.833 &lt;.0001 
#&gt; 
#&gt; Results are averaged over the levels of: Replicate, management 
#&gt; Degrees-of-freedom method: kenward-roger 
#&gt; P value adjustment: tukey method for comparing a family of 3 estimates </div><div class='input'>
<span class='co'>##----fm1.3.Plot----</span>
<span class='no'>fm1.3.Augment</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom.mixed</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/broom.mixed/man/reexports.html'>augment</a></span>(<span class='no'>fm1.3</span>)

<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>fm1.3.Augment</span>, <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>.fitted</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>.resid</span>)) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span>(<span class='kw'>yintercept</span> <span class='kw'>=</span> <span class='fl'>0</span>) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span>(
    <span class='kw'>x</span> <span class='kw'>=</span> <span class='st'>"Fitted"</span>
    , <span class='kw'>y</span> <span class='kw'>=</span> <span class='st'>"Residuals"</span>
    , <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>"Full analysis with full nitrogen effects"</span>) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span>(<span class='kw'>plot.title</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span>(<span class='kw'>hjust</span> <span class='kw'>=</span> <span class='fl'>0.5</span>))</div><div class='img'><img src='example1-1.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>##----fm1.4----</span>
<span class='no'>fm1.4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lmerTest/man/lmer.html'>lmer</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>nitrogen</span> * <span class='no'>management</span> * <span class='no'>variety</span> + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>) +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>:<span class='no'>Sub</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>rice</span>)</div><div class='output co'>#&gt; <span class='message'>boundary (singular) fit: see ?isSingular</span></div><div class='input'><span class='no'>fm1.4.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span>(<span class='no'>fm1.4</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='no'>fm1.4.ANOVA</span></div><div class='output co'>#&gt; Type I Analysis of Variance Table with Kenward-Roger's method
#&gt;                              Sum Sq Mean Sq NumDF DenDF  F value    Pr(&gt;F)    
#&gt; Replicate                     0.575   0.288     2     8   0.6578 0.5439087    
#&gt; nitrogen                     48.424  12.106     4     8  27.6954 9.734e-05 ***
#&gt; management                   42.936  21.468     2    20  49.1136 1.919e-08 ***
#&gt; variety                     206.013 103.007     2    60 235.6534 &lt; 2.2e-16 ***
#&gt; nitrogen:management           1.103   0.138     8    20   0.3154 0.9508797    
#&gt; nitrogen:variety             14.145   1.768     8    60   4.0449 0.0006765 ***
#&gt; management:variety            3.852   0.963     4    60   2.2030 0.0793658 .  
#&gt; nitrogen:management:variety   3.699   0.231    16    60   0.5289 0.9210466    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>##----fm1.5----</span>
<span class='no'>fm1.5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lmerTest/man/lmer.html'>lmer</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>management</span> + <span class='no'>variety</span> * (<span class='no'>nrate</span> + <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>nrate</span>^<span class='fl'>2</span>) +
                                                            <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>nrate</span>^<span class='fl'>3</span>) + <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>nrate</span>^<span class='fl'>4</span>)) +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>:<span class='no'>Sub</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>rice</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='output co'>#&gt; <span class='message'>boundary (singular) fit: see ?isSingular</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='input'><span class='no'>fm1.5.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span>(<span class='no'>fm1.5</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='no'>fm1.5.ANOVA</span></div><div class='output co'>#&gt; Type I Analysis of Variance Table with Kenward-Roger's method
#&gt;                     Sum Sq Mean Sq NumDF DenDF  F value    Pr(&gt;F)    
#&gt; Replicate            0.531   0.266     2     8   0.6578   0.54391    
#&gt; management          42.936  21.468     2    28  53.1500 2.932e-10 ***
#&gt; variety            206.013 103.007     2    80 255.0208 &lt; 2.2e-16 ***
#&gt; nrate               40.624  40.624     1     8 100.5754 8.308e-06 ***
#&gt; I(nrate^2)           2.490   2.490     1     8   6.1641   0.03795 *  
#&gt; I(nrate^3)           0.038   0.038     1     8   0.0939   0.76713    
#&gt; I(nrate^4)           1.594   1.594     1     8   3.9468   0.08220 .  
#&gt; variety:nrate        9.861   4.930     2    80  12.2065 2.363e-05 ***
#&gt; variety:I(nrate^2)   0.804   0.402     2    80   0.9952   0.37417    
#&gt; variety:I(nrate^3)   2.783   1.392     2    80   3.4455   0.03669 *  
#&gt; variety:I(nrate^4)   0.696   0.348     2    80   0.8620   0.42618    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>##----fm1.6----</span>
<span class='no'>fm1.6</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lmerTest/man/lmer.html'>lmer</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>management</span> + <span class='no'>variety</span> * <span class='no'>nrate</span> + <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>nrate</span>^<span class='fl'>2</span>) +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>:<span class='no'>Sub</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>rice</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='output co'>#&gt; <span class='message'>boundary (singular) fit: see ?isSingular</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='input'>
<span class='no'>fm1.6.Coef</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>fm1.6</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>)$<span class='no'>coef</span>
<span class='no'>fm1.6.Coef</span></div><div class='output co'>#&gt;                          Estimate   Std. Error       df    t value     Pr(&gt;|t|)
#&gt; (Intercept)          3.838742e+00 2.478500e-01 31.46271 15.4881675 2.847131e-16
#&gt; ReplicateR2          1.179333e-01 1.725584e-01 10.00000  0.6834401 5.098535e-01
#&gt; ReplicateR3         -5.922222e-02 1.725584e-01 10.00000 -0.3432010 7.385530e-01
#&gt; managementOptimum    5.857778e-01 1.366639e-01 28.00000  4.2862662 1.941972e-04
#&gt; managementIntensive  1.376333e+00 1.366639e-01 28.00000 10.0709370 8.232324e-11
#&gt; varietyV2            5.374285e-01 2.543624e-01 86.00000  2.1128455 3.751250e-02
#&gt; varietyV3            2.008611e+00 2.543624e-01 86.00000  7.8966494 8.555670e-12
#&gt; nrate                1.612922e-02 5.108418e-03 12.37614  3.1573804 7.981949e-03
#&gt; I(nrate^2)          -7.528912e-05 3.327527e-05 10.00000 -2.2626149 4.715858e-02
#&gt; varietyV2:nrate      9.630034e-03 2.822766e-03 86.00000  3.4115589 9.862976e-04
#&gt; varietyV3:nrate      1.322179e-02 2.822766e-03 86.00000  4.6839816 1.043415e-05</div><div class='input'>
<span class='co'>##----fm1.6.Coefs----</span>
<span class='co'># fm1.6.Coef[ ,1, drop = FALSE]</span>

<span class='co'># Intercepts</span>
<span class='no'>fm1.6.Coef</span>[<span class='fl'>1</span>, <span class='fl'>1</span>] + <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>2</span>:<span class='fl'>3</span>, <span class='fl'>1</span>])/<span class='fl'>3</span> + <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>4</span>:<span class='fl'>5</span>, <span class='fl'>1</span>])/<span class='fl'>3</span></div><div class='output co'>#&gt; [1] 4.512349</div><div class='input'><span class='no'>fm1.6.Coef</span>[<span class='fl'>1</span>, <span class='fl'>1</span>] + <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>2</span>:<span class='fl'>3</span>, <span class='fl'>1</span>])/<span class='fl'>3</span> + <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>4</span>:<span class='fl'>5</span>, <span class='fl'>1</span>])/<span class='fl'>3</span> +
  <span class='no'>fm1.6.Coef</span>[<span class='fl'>6</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] 5.049778</div><div class='input'><span class='no'>fm1.6.Coef</span>[<span class='fl'>1</span>, <span class='fl'>1</span>] + <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>2</span>:<span class='fl'>3</span>, <span class='fl'>1</span>])/<span class='fl'>3</span> + <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>fm1.6.Coef</span>[<span class='fl'>4</span>:<span class='fl'>5</span>, <span class='fl'>1</span>])/<span class='fl'>3</span> +
  <span class='no'>fm1.6.Coef</span>[<span class='fl'>7</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] 6.52096</div><div class='input'>
<span class='co'># Linear Slopes</span>
<span class='no'>fm1.6.Coef</span>[<span class='fl'>8</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] 0.01612922</div><div class='input'><span class='no'>fm1.6.Coef</span>[<span class='fl'>8</span>, <span class='fl'>1</span>] +  <span class='no'>fm1.6.Coef</span>[<span class='fl'>10</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] 0.02575925</div><div class='input'><span class='no'>fm1.6.Coef</span>[<span class='fl'>8</span>, <span class='fl'>1</span>] +  <span class='no'>fm1.6.Coef</span>[<span class='fl'>11</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] 0.02935101</div><div class='input'>
<span class='co'># Quadratic Slopes</span>
<span class='no'>fm1.6.Coef</span>[<span class='fl'>9</span>, <span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] -7.528912e-05</div><div class='input'>
<span class='co'>##----fm1.7----</span>
<span class='no'>fm1.7</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/aov.html'>aov</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span>*<span class='no'>management</span> * <span class='no'>variety</span> * <span class='no'>nitrogen</span>, <span class='no'>rice</span>)
<span class='no'>fm1.7.Summary</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/broom/man/reexports.html'>tidy</a></span>(<span class='no'>fm1.7</span>)

<span class='no'>fm1.7.Summary</span></div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 15 x 4</span><span>
#&gt;    term                                     df   sumsq  meansq
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>                                 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> Replicate                                 2   0.732   0.366
#&gt; </span><span style='color: #555555;'> 2</span><span> management                                2  42.9    21.5  
#&gt; </span><span style='color: #555555;'> 3</span><span> variety                                   2 206.    103.   
#&gt; </span><span style='color: #555555;'> 4</span><span> nitrogen                                  4  61.6    15.4  
#&gt; </span><span style='color: #555555;'> 5</span><span> Replicate:management                      4   0.460   0.115
#&gt; </span><span style='color: #555555;'> 6</span><span> Replicate:variety                         4   6.15    1.54 
#&gt; </span><span style='color: #555555;'> 7</span><span> management:variety                        4   3.85    0.963
#&gt; </span><span style='color: #555555;'> 8</span><span> Replicate:nitrogen                        8   4.45    0.556
#&gt; </span><span style='color: #555555;'> 9</span><span> management:nitrogen                       8   1.10    0.138
#&gt; </span><span style='color: #555555;'>10</span><span> variety:nitrogen                          8  14.1     1.77 
#&gt; </span><span style='color: #555555;'>11</span><span> Replicate:management:variety              8   2.22    0.278
#&gt; </span><span style='color: #555555;'>12</span><span> Replicate:management:nitrogen            16   4.78    0.299
#&gt; </span><span style='color: #555555;'>13</span><span> Replicate:variety:nitrogen               16  13.1     0.820
#&gt; </span><span style='color: #555555;'>14</span><span> management:variety:nitrogen              16   3.70    0.231
#&gt; </span><span style='color: #555555;'>15</span><span> Replicate:management:variety:nitrogen    32   8.23    0.257</div><div class='input'>
<span class='co'>##----fm1.7.Rice----</span>
<span class='no'>Rice1</span> <span class='kw'>&lt;-</span>
  <span class='no'>rice</span> <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>Replicate</span>, <span class='no'>nitrogen</span>, <span class='no'>variety</span>) <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span>(<span class='kw'>Yield</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>yield</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))

<span class='no'>Rice1</span></div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 45 x 4</span><span>
#&gt; </span><span style='color: #555555;'># Groups:   Replicate, nitrogen [15]</span><span>
#&gt;    Replicate nitrogen variety Yield
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;fct&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;fct&gt;</span><span>    </span><span style='color: #555555;font-style: italic;'>&lt;fct&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> R1        0        V1       3.92
#&gt; </span><span style='color: #555555;'> 2</span><span> R1        0        V2       5.92
#&gt; </span><span style='color: #555555;'> 3</span><span> R1        0        V3       6.60
#&gt; </span><span style='color: #555555;'> 4</span><span> R1        50       V1       4.02
#&gt; </span><span style='color: #555555;'> 5</span><span> R1        50       V2       6.32
#&gt; </span><span style='color: #555555;'> 6</span><span> R1        50       V3       7.93
#&gt; </span><span style='color: #555555;'> 7</span><span> R1        80       V1       5.81
#&gt; </span><span style='color: #555555;'> 8</span><span> R1        80       V2       6.26
#&gt; </span><span style='color: #555555;'> 9</span><span> R1        80       V3       8.74
#&gt; </span><span style='color: #555555;'>10</span><span> R1        110      V1       5.44
#&gt; </span><span style='color: #555555;'># … with 35 more rows</span><span></div><div class='input'>
<span class='no'>WideRice1</span> <span class='kw'>&lt;-</span>
  <span class='no'>Rice1</span> <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>tidyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/spread.html'>spread</a></span>(<span class='kw'>key</span> <span class='kw'>=</span> <span class='no'>nitrogen</span>, <span class='kw'>value</span> <span class='kw'>=</span> <span class='no'>Yield</span>) <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span>() <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span>(-<span class='no'>Replicate</span>, -<span class='no'>variety</span>)


<span class='co'>##----fm1.7.Plot1----</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>Rice1</span>, <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>nitrogen</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>Yield</span>,  <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>Replicate</span>)) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span>(<span class='no'>variety</span> ~ <span class='no'>Replicate</span>, <span class='kw'>labeller</span> <span class='kw'>=</span> <span class='no'>label_both</span>) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span>(
    <span class='kw'>x</span> <span class='kw'>=</span> <span class='st'>"Nitrogen"</span>
    , <span class='kw'>y</span> <span class='kw'>=</span> <span class='st'>"Yield"</span>
    , <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>"Fig S1. Variety response to nitrogen for individual replicate blocks"</span>
  ) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span>(<span class='kw'>plot.title</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span>(<span class='kw'>hjust</span> <span class='kw'>=</span> <span class='fl'>0.5</span>))</div><div class='img'><img src='example1-2.png' alt='' width='700' height='433' /></div><div class='input'>


<span class='co'>##----fm1.8----</span>
<span class='no'>riceV2V3</span> <span class='kw'>&lt;-</span>
  <span class='no'>rice</span> <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>variety</span> <span class='kw'>!=</span> <span class='st'>"V1"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/droplevels.html'>droplevels</a></span>()

<span class='no'>fm1.8</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/aov.html'>aov</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span>*<span class='no'>management</span> * <span class='no'>variety</span> * <span class='no'>nitrogen</span>, <span class='no'>riceV2V3</span>)
<span class='no'>fm1.8.ANOVA</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/broom/man/reexports.html'>tidy</a></span>(<span class='no'>fm1.8</span>)

<span class='no'>fm1.8.ANOVA</span></div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 15 x 4</span><span>
#&gt;    term                                     df  sumsq meansq
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>                                 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> Replicate                                 2  3.00   1.50 
#&gt; </span><span style='color: #555555;'> 2</span><span> management                                2 26.1   13.1  
#&gt; </span><span style='color: #555555;'> 3</span><span> variety                                   1 68.4   68.4  
#&gt; </span><span style='color: #555555;'> 4</span><span> nitrogen                                  4 64.0   16.0  
#&gt; </span><span style='color: #555555;'> 5</span><span> Replicate:management                      4  0.868  0.217
#&gt; </span><span style='color: #555555;'> 6</span><span> Replicate:variety                         2  0.518  0.259
#&gt; </span><span style='color: #555555;'> 7</span><span> management:variety                        2  3.68   1.84 
#&gt; </span><span style='color: #555555;'> 8</span><span> Replicate:nitrogen                        8  6.98   0.872
#&gt; </span><span style='color: #555555;'> 9</span><span> management:nitrogen                       8  0.842  0.105
#&gt; </span><span style='color: #555555;'>10</span><span> variety:nitrogen                          4  1.78   0.444
#&gt; </span><span style='color: #555555;'>11</span><span> Replicate:management:variety              4  1.24   0.311
#&gt; </span><span style='color: #555555;'>12</span><span> Replicate:management:nitrogen            16  5.29   0.331
#&gt; </span><span style='color: #555555;'>13</span><span> Replicate:variety:nitrogen                8  4.43   0.554
#&gt; </span><span style='color: #555555;'>14</span><span> management:variety:nitrogen               8  3.22   0.402
#&gt; </span><span style='color: #555555;'>15</span><span> Replicate:management:variety:nitrogen    16  4.03   0.252</div><div class='input'>
<span class='co'>##----fm1.9----</span>
<span class='no'>fm1.9</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/aov.html'>aov</a></span>(<span class='no'>yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>management</span> * <span class='no'>variety</span> * <span class='no'>nitrogen</span> +
               <span class='fu'><a href='https://rdrr.io/r/stats/aov.html'>Error</a></span>(<span class='no'>Replicate</span>/<span class='no'>Main</span>/<span class='no'>Sub</span>), <span class='no'>riceV2V3</span>)
<span class='no'>fm1.9.ANOVA</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/broom/man/reexports.html'>tidy</a></span>(<span class='no'>fm1.9</span>)
<span class='no'>fm1.9.ANOVA</span></div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 11 x 7</span><span>
#&gt;    stratum         term                     df  sumsq meansq statistic   p.value
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>           </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>                 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> Replicate       Replicate                 2  3.00   1.50     </span><span style='color: #BB0000;'>NA</span><span>     </span><span style='color: #BB0000;'>NA</span><span>   </span><span style='color: #555555;'> </span><span>   
#&gt; </span><span style='color: #555555;'> 2</span><span> Replicate:Main  nitrogen                  4 64.0   16.0      18.3    4.30</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 4</span><span>
#&gt; </span><span style='color: #555555;'> 3</span><span> Replicate:Main  Residuals                 8  6.98   0.872    </span><span style='color: #BB0000;'>NA</span><span>     </span><span style='color: #BB0000;'>NA</span><span>   </span><span style='color: #555555;'> </span><span>   
#&gt; </span><span style='color: #555555;'> 4</span><span> Replicate:Main… management                2 26.1   13.1      42.5    6.34</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 8</span><span>
#&gt; </span><span style='color: #555555;'> 5</span><span> Replicate:Main… management:nitrogen       8  0.842  0.105     0.342  9.39</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 1</span><span>
#&gt; </span><span style='color: #555555;'> 6</span><span> Replicate:Main… Residuals                20  6.16   0.308    </span><span style='color: #BB0000;'>NA</span><span>     </span><span style='color: #BB0000;'>NA</span><span>   </span><span style='color: #555555;'> </span><span>   
#&gt; </span><span style='color: #555555;'> 7</span><span> Within          variety                   1 68.4   68.4     201.     7.87</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>-15</span><span>
#&gt; </span><span style='color: #555555;'> 8</span><span> Within          management:variety        2  3.68   1.84      5.40   9.92</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 3</span><span>
#&gt; </span><span style='color: #555555;'> 9</span><span> Within          variety:nitrogen          4  1.78   0.444     1.30   2.91</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 1</span><span>
#&gt; </span><span style='color: #555555;'>10</span><span> Within          management:variety:n…     8  3.22   0.402     1.18   3.43</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 1</span><span>
#&gt; </span><span style='color: #555555;'>11</span><span> Within          Residuals                30 10.2    0.341    </span><span style='color: #BB0000;'>NA</span><span>     </span><span style='color: #BB0000;'>NA</span><span>   </span><span style='color: #555555;'> </span><span>   </div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
<ol>
<li><p>Rodney N. Edmondson (<a href='mailto:rodney.edmondson@gmail.com'>rodney.edmondson@gmail.com</a>)</p></li>
<li><p>Hans-Peter Piepho (<a href='mailto:piepho@uni-hohenheim.de'>piepho@uni-hohenheim.de</a>)</p></li>
<li><p>Muhammad Yaseen (<a href='mailto:myaseen208@gmail.com'>myaseen208@gmail.com</a>)</p></li>
</ol>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rodney Edmondson, Hans-Peter Piepho, Muhammad Yaseen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: 'bdafb7ea4490644e670f470ee3ef537f',
    indexName: 'agriTutorial',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


