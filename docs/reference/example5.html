<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Example 5: Transformation of treatment levels to improve model fit — example5 • agriTutorial</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Example 5: Transformation of treatment levels to improve model fit — example5" />

<meta property="og:description" content="Mead (1988, p. 323) describes an experiment on spacing effects with turnips,
which was laid out in three complete blocks. Five different seed rates
(0.5, 2, 8, 20, 32 lb/acre) were tested in combination with four different row widths
(4, 8, 16, 32 inches), giving rise to a total of 20 treatments." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agriTutorial</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Example 5: Transformation of treatment levels to improve model fit</h1>
    
    <div class="hidden name"><code>example5.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Mead (1988, p. 323) describes an experiment on spacing effects with turnips,
which was laid out in three complete blocks. Five different seed rates
(0.5, 2, 8, 20, 32 lb/acre) were tested in combination with four different row widths
(4, 8, 16, 32 inches), giving rise to a total of 20 treatments.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Transformation of the dependent variable will often stabilize the variance of the observations
whereas transformation of the regressor variables will often simplify the fitted model. In this
example, the fit of a regression model based on the original seed rate and row width variables is compared
with the fit of a regression model based on the log transformed seed rates and log transformed row widths.
In each case, the model lack-of-fit is examined by assessing the extra variability explained when the
Density and Spacing treatment factors and their interactions are added to the quadratic regression models.
All yields are logarithmically transformed to stabilize the variance.</p>
<p>The first analysis fits a quadratic regression model of log yields on the untransformed seed rates and row
widths (Table 16) while the second analysis fits a quadratic regression model of log yields on the log
transformed seed rates and log transformed row widths (Table 17). The analysis of variance of the first model
shows that significant extra variability is explained by the Density and
Spacing factors and this shows that a quadratic regression model is inadequate for the untransformed regressor
variables. The analysis of variance of the second model, however, shows no significant extra variability
explained by the Density and Spacing factors and this shows that the quadratic regression model with the log
transformed regressor variables gives a good fit to the data and therefore is the preferred model for the
observed data.</p>
<p>The superiority of the model with the log transformed regressor variables is confirmed by comparing the fit of the
quadratic regression model for the untransformed regressor variables (Figs 8 and 9) versus the fit of the
quadratic regression model for the log transformed regressor variables (Figs 10 and 11).</p>
<p>Fig 12a shows diagnostic plots for the fit of a quadratic model with untransformed regressor variables
while Fig 12b shows corresponding diagnostic plots for the fit of a quadratic model with
loge transformed regressor variables. Each of the four types of diagnostic plots in the two figures
shows an improvement in fit for the transformed versus the untransformed regressor variables.</p>
<p><code><a href='agriTutorial.html'>agriTutorial</a></code>: return to home page if you want to select a different example <br /></p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Mead, R. (1988). The design of experiments. Statistical principles for practical application.
Cambridge: Cambridge University Press.</p>
<p>Piepho, H. P, and Edmondson. R. N. (2018). A tutorial on the statistical analysis of factorial experiments with qualitative and quantitative
treatment factor levels. Journal of Agronomy and Crop Science. DOI: 10.1111/jac.12267.
<a href='http://onlinelibrary.wiley.com/doi/10.1111/jac.12267/full'>Early View</a></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## *************************************************************************************</span>
<span class='co'>##                       How to run the code</span>
<span class='co'>## *************************************************************************************</span>

<span class='co'>## Either type example("example5") to run ALL the examples succesively</span>
<span class='co'>## or copy and paste examples sucessively, as required</span>

<span class='co'>## *************************************************************************************</span>
<span class='co'>##                        Options and required packages</span>
<span class='co'>## *************************************************************************************</span>

<span class='fu'>options</span>(<span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>'contr.treatment'</span>, <span class='st'>'contr.poly'</span>))
<span class='fu'>require</span>(<span class='no'>lattice</span>)

<span class='co'>## *************************************************************************************</span>
<span class='co'>##   Quadratic regression models with and without transformation of regressor variables</span>
<span class='co'>## *************************************************************************************</span>

<span class='no'>RowSpacing</span> <span class='kw'>=</span> <span class='fu'>poly</span>(<span class='no'>turnip</span>$<span class='no'>rowspacing</span>, <span class='fl'>3</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>colnames</span>(<span class='no'>RowSpacing</span>) <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"linSpacing"</span>, <span class='st'>"quadSpacing"</span>, <span class='st'>"cubSpacing"</span>)
<span class='no'>Density</span> <span class='kw'>=</span> <span class='fu'>poly</span>(<span class='no'>turnip</span>$<span class='no'>density</span>, <span class='fl'>4</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>colnames</span>(<span class='no'>Density</span>) <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"linDensity"</span>, <span class='st'>"quadDensity"</span>, <span class='st'>"cubDensity"</span>, <span class='st'>"quartDensity"</span>)
<span class='no'>turnip</span> <span class='kw'>=</span> <span class='fu'>cbind</span>(<span class='no'>turnip</span>, <span class='no'>Density</span>, <span class='no'>RowSpacing</span>)

<span class='co'>## Log transformed row spacing and density polynomials</span>
<span class='no'>logRowSpacing</span> <span class='kw'>=</span> <span class='fu'>poly</span>(<span class='fu'>log</span>(<span class='no'>turnip</span>$<span class='no'>rowspacing</span>), <span class='fl'>3</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>colnames</span>(<span class='no'>logRowSpacing</span>) <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"linlogSpacing"</span>, <span class='st'>"quadlogSpacing"</span>, <span class='st'>"cublogSpacing"</span>)
<span class='no'>logDensity</span> <span class='kw'>=</span> <span class='fu'>poly</span>(<span class='fu'>log</span>(<span class='no'>turnip</span>$<span class='no'>density</span>), <span class='fl'>4</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>colnames</span>(<span class='no'>logDensity</span>) <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"linlogDensity"</span>, <span class='st'>"quadlogDensity"</span>, <span class='st'>"cublogDensity"</span>, <span class='st'>"quartlogDensity"</span>)
<span class='no'>turnip</span> <span class='kw'>=</span> <span class='fu'>cbind</span>(<span class='no'>turnip</span>, <span class='no'>logDensity</span>, <span class='no'>logRowSpacing</span>)

<span class='co'>## Table 16 Quadratic response surface for untransformed planting density by row spacing model</span>
<span class='no'>quad.mod</span> <span class='kw'>=</span> <span class='fu'>lm</span>(<span class='no'>log_yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>linDensity</span> * <span class='no'>linSpacing</span> + <span class='no'>quadDensity</span> + <span class='no'>quadSpacing</span> +
 <span class='no'>Density</span> * <span class='no'>Spacing</span>, <span class='no'>turnip</span>)
<span class='fu'>anova</span>(<span class='no'>quad.mod</span>)</div><div class='output co'>#&gt; Analysis of Variance Table
#&gt; 
#&gt; Response: log_yield
#&gt;                       Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
#&gt; Replicate              2  3.4168  1.7084  43.6173 1.443e-10 ***
#&gt; linDensity             1 14.1195 14.1195 360.4862 &lt; 2.2e-16 ***
#&gt; linSpacing             1  0.5177  0.5177  13.2186 0.0008184 ***
#&gt; quadDensity            1  6.1783  6.1783 157.7372 4.242e-15 ***
#&gt; quadSpacing            1  0.2237  0.2237   5.7124 0.0219091 *  
#&gt; Density                2  5.3498  2.6749  68.2929 2.617e-13 ***
#&gt; Spacing                1  0.1752  0.1752   4.4722 0.0410661 *  
#&gt; linDensity:linSpacing  1  0.4470  0.4470  11.4136 0.0016958 ** 
#&gt; Density:Spacing       11  0.5505  0.0500   1.2777 0.2740490    
#&gt; Residuals             38  1.4884  0.0392                       
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>## Table 17 Quadratic response surface for transformed log planting density by log row spacing</span>
<span class='no'>log.quad.mod</span> <span class='kw'>=</span> <span class='fu'>lm</span>(<span class='no'>log_yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>linlogDensity</span> * <span class='no'>linlogSpacing</span> +
 <span class='no'>quadlogDensity</span> + <span class='no'>quadlogSpacing</span> + <span class='no'>Density</span> * <span class='no'>Spacing</span>, <span class='no'>turnip</span>)
<span class='fu'>anova</span>(<span class='no'>log.quad.mod</span>)</div><div class='output co'>#&gt; Analysis of Variance Table
#&gt; 
#&gt; Response: log_yield
#&gt;                             Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
#&gt; Replicate                    2  3.4168  1.7084  43.6173 1.443e-10 ***
#&gt; linlogDensity                1 23.4772 23.4772 599.3960 &lt; 2.2e-16 ***
#&gt; linlogSpacing                1  0.2803  0.2803   7.1562 0.0109578 *  
#&gt; quadlogDensity               1  2.1001  2.1001  53.6189 9.043e-09 ***
#&gt; quadlogSpacing               1  0.6100  0.6100  15.5750 0.0003308 ***
#&gt; Density                      2  0.0703  0.0351   0.8971 0.4161980    
#&gt; Spacing                      1  0.0263  0.0263   0.6720 0.4174728    
#&gt; linlogDensity:linlogSpacing  1  0.7503  0.7503  19.1572 9.092e-05 ***
#&gt; Density:Spacing             11  0.2472  0.0225   0.5738 0.8377327    
#&gt; Residuals                   38  1.4884  0.0392                       
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>## *************************************************************************************</span>
<span class='co'>##   Quadratic regression model plots with and without transformations</span>
<span class='co'>##   Averaged over replicate blocks to give mean of block effects</span>
<span class='co'>## *************************************************************************************</span>

<span class='co'>## Quadratic response surface for untransformed planting density by row spacing model</span>
<span class='no'>quad.mod</span> <span class='kw'>=</span> <span class='fu'>lm</span>(<span class='no'>log_yield</span> ~ <span class='no'>linDensity</span> * <span class='no'>linSpacing</span> + <span class='no'>quadDensity</span> + <span class='no'>quadSpacing</span> , <span class='no'>turnip</span>)
<span class='no'>quad.mod</span>$<span class='no'>coefficients</span></div><div class='output co'>#&gt;           (Intercept)            linDensity            linSpacing 
#&gt;          1.1146900855          0.1564753713          0.0284788787 
#&gt;           quadDensity           quadSpacing linDensity:linSpacing 
#&gt;         -0.0033192569         -0.0007748656         -0.0006749985 </div><div class='input'>
<span class='co'>##  Fig 8 Plot of loge yield (lb/plot) versus row width</span>
<span class='no'>panel.plot</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>y</span>) {
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.xyplot'>panel.xyplot</a></span>(<span class='no'>x</span>, <span class='no'>y</span>) <span class='co'># lattice plot shows observed points</span>
<span class='no'>SeedDensity</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0.5</span>,<span class='fl'>2</span>,<span class='fl'>8</span>,<span class='fl'>20</span>,<span class='fl'>32</span>)[<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.number'>panel.number</a></span>()]
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.functions'>panel.curve</a></span>(<span class='fl'>1.1146900855</span> + <span class='fl'>0.0284788787</span> * <span class='no'>x</span> -<span class='fl'>0.0007748656</span>  * <span class='no'>x</span> * <span class='no'>x</span> + <span class='fl'>0.1564753713</span>  *<span class='no'>SeedDensity</span> -
  <span class='fl'>0.0033192569</span> * <span class='no'>SeedDensity</span>* <span class='no'>SeedDensity</span>  -<span class='fl'>0.0006749985</span>  * <span class='no'>x</span> * <span class='no'>SeedDensity</span>,
<span class='kw'>from</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>to</span> <span class='kw'>=</span> <span class='fl'>32.0</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>)
}
<span class='no'>Seed_Rate</span><span class='kw'>=</span><span class='fu'>factor</span>(<span class='no'>turnip</span>$<span class='no'>linDensity</span>)
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/xyplot'>xyplot</a></span>(<span class='no'>log_yield</span>  ~ <span class='no'>linSpacing</span><span class='kw'>|</span><span class='no'>Seed_Rate</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip</span>,
 <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>at</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>10</span>,<span class='fl'>20</span>,<span class='fl'>30</span>), <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>10</span>,<span class='fl'>20</span>,<span class='fl'>30</span>))),
 <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Fig 8: loge yield versus row width"</span>,
 <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>" Row Width "</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Loge yield "</span>,
 <span class='kw'>strip</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/strip.default'>strip.custom</a></span>(<span class='kw'>strip.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
 <span class='kw'>factor.levels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"0.5"</span>, <span class='st'>"2"</span>, <span class='st'>"8"</span>, <span class='st'>"20"</span>, <span class='st'>"32"</span>)),
<span class='kw'>panel</span> <span class='kw'>=</span> <span class='no'>panel.plot</span>)</div><div class='img'><img src='example5-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##  Fig 9 Plot of loge yield (lb/plot) versus seed rate</span>
<span class='no'>panel.plot</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>y</span>) {
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.xyplot'>panel.xyplot</a></span>(<span class='no'>x</span>, <span class='no'>y</span>) <span class='co'># lattice plot shows observed points</span>
<span class='no'>RowWidth</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>4</span>, <span class='fl'>8</span>, <span class='fl'>16</span>, <span class='fl'>32</span>)[<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.number'>panel.number</a></span>()]
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.functions'>panel.curve</a></span>(<span class='fl'>1.1146900855</span> + <span class='fl'>0.1564753713</span> * <span class='no'>x</span> - <span class='fl'>0.0033192569</span>  * <span class='no'>x</span> * <span class='no'>x</span> + <span class='fl'>0.0284788787</span> * <span class='no'>RowWidth</span> -
 <span class='fl'>0.0007748656</span>* <span class='no'>RowWidth</span> * <span class='no'>RowWidth</span>  -<span class='fl'>0.0006749985</span>  * <span class='no'>x</span> * <span class='no'>RowWidth</span>,
<span class='kw'>from</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>to</span> <span class='kw'>=</span> <span class='fl'>32.0</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>)
}
<span class='no'>Row_Width</span><span class='kw'>=</span><span class='fu'>factor</span>(<span class='no'>turnip</span>$<span class='no'>linSpacing</span>)
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/xyplot'>xyplot</a></span>(<span class='no'>log_yield</span>  ~ <span class='no'>linDensity</span><span class='kw'>|</span><span class='no'>Row_Width</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip</span>,
 <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>at</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>10</span>,<span class='fl'>20</span>,<span class='fl'>30</span>), <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>10</span>,<span class='fl'>20</span>,<span class='fl'>30</span>))),
 <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Fig 9: loge yield versus seed rate"</span>,
 <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>" Seed Rate"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Loge yield "</span>,
 <span class='kw'>strip</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/strip.default'>strip.custom</a></span>(<span class='kw'>strip.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
 <span class='kw'>factor.levels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"4"</span>, <span class='st'>"8"</span>, <span class='st'>"16"</span>, <span class='st'>"32"</span>)),
<span class='kw'>panel</span> <span class='kw'>=</span> <span class='no'>panel.plot</span>)</div><div class='img'><img src='example5-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Quadratic response surface for log transformed planting density by log row spacing model</span>
<span class='no'>log.quad.mod</span> <span class='kw'>=</span> <span class='fu'>lm</span>(<span class='no'>log_yield</span> ~ <span class='no'>linlogDensity</span> * <span class='no'>linlogSpacing</span> + <span class='no'>quadlogDensity</span> + <span class='no'>quadlogSpacing</span>,
<span class='no'>turnip</span>)
<span class='no'>log.quad.mod</span>$<span class='no'>coefficients</span></div><div class='output co'>#&gt;                 (Intercept)               linlogDensity 
#&gt;                  0.18414803                  0.94207543 
#&gt;               linlogSpacing              quadlogDensity 
#&gt;                  1.09137389                 -0.10875560 
#&gt;              quadlogSpacing linlogDensity:linlogSpacing 
#&gt;                 -0.20987137                 -0.09440938 </div><div class='input'><span class='co'>##  Fig 10 Plot of loge yield (lb/plot) versus log row width</span>
<span class='no'>panel.plot</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>y</span>) {
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.xyplot'>panel.xyplot</a></span>(<span class='no'>x</span>, <span class='no'>y</span>) <span class='co'># lattice plot shows observed points</span>
<span class='no'>LogSeedDensity</span> <span class='kw'>=</span> <span class='fu'>c</span>(-<span class='fl'>0.6931472</span>,<span class='fl'>0.6931472</span>,<span class='fl'>2.0794415</span>,<span class='fl'>2.9957323</span>,<span class='fl'>3.4657359</span>)[<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.number'>panel.number</a></span>()]
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.functions'>panel.curve</a></span>( <span class='fl'>0.18414803</span>  + <span class='fl'>1.09137389</span> * <span class='no'>x</span> - <span class='fl'>0.20987137</span> * <span class='no'>x</span> * <span class='no'>x</span> +  <span class='fl'>0.94207543</span> *<span class='no'>LogSeedDensity</span> -
  <span class='fl'>0.10875560</span> * <span class='no'>LogSeedDensity</span>* <span class='no'>LogSeedDensity</span>  -<span class='fl'>0.09440938</span>   * <span class='no'>x</span> * <span class='no'>LogSeedDensity</span>,
<span class='kw'>from</span> <span class='kw'>=</span> <span class='fl'>1.35</span>, <span class='kw'>to</span> <span class='kw'>=</span><span class='fl'>3.50</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>)
}
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/xyplot'>xyplot</a></span>(<span class='no'>log_yield</span>  ~ <span class='no'>linlogSpacing</span><span class='kw'>|</span><span class='no'>Seed_Rate</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip</span>,
 <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>at</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1.5</span>,<span class='fl'>2.0</span>,<span class='fl'>2.5</span>,<span class='fl'>3.0</span>,<span class='fl'>3.5</span>), <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1.5</span>,<span class='fl'>2.0</span>,<span class='fl'>2.5</span>,<span class='fl'>3.0</span>,<span class='fl'>3.5</span>))),
 <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Fig 10: loge yield versus loge row width"</span>,
 <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>" Loge Row Width "</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Loge yield "</span>,
 <span class='kw'>strip</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/strip.default'>strip.custom</a></span>(<span class='kw'>strip.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
<span class='kw'>factor.levels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"0.5"</span>, <span class='st'>"2"</span>, <span class='st'>"8"</span>, <span class='st'>"20"</span>, <span class='st'>"32"</span>)),
<span class='kw'>panel</span> <span class='kw'>=</span> <span class='no'>panel.plot</span>)</div><div class='img'><img src='example5-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##  Fig 11 Plot of loge yield (lb/plot) versus log seed rate</span>
<span class='no'>panel.plot</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>y</span>) {
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.xyplot'>panel.xyplot</a></span>(<span class='no'>x</span>, <span class='no'>y</span>) <span class='co'># lattice plot shows observed points</span>
<span class='no'>LogRowWidth</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1.386294</span>, <span class='fl'>2.079442</span>, <span class='fl'>2.772589</span>,<span class='fl'>3.465736</span>)[<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.number'>panel.number</a></span>()]
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.functions'>panel.curve</a></span>(<span class='fl'>0.18414803</span>  + <span class='fl'>0.94207543</span> * <span class='no'>x</span> -<span class='fl'>0.10875560</span> * <span class='no'>x</span> * <span class='no'>x</span> + <span class='fl'>1.09137389</span>* <span class='no'>LogRowWidth</span> -
 <span class='fl'>0.20987137</span>* <span class='no'>LogRowWidth</span> * <span class='no'>LogRowWidth</span>  -<span class='fl'>0.09440938</span> * <span class='no'>x</span> * <span class='no'>LogRowWidth</span>,
<span class='kw'>from</span> <span class='kw'>=</span> -<span class='fl'>0.7</span> , <span class='kw'>to</span> <span class='kw'>=</span> <span class='fl'>3.5</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>)
}
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/xyplot'>xyplot</a></span>(<span class='no'>log_yield</span>  ~ <span class='no'>linlogDensity</span><span class='kw'>|</span><span class='no'>Row_Width</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip</span>,
 <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>at</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>),<span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>))),
 <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Fig 11: loge yield versus loge seed rate"</span>,
 <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>" Loge Seed Rate"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Loge yield "</span>,
 <span class='kw'>strip</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/strip.default'>strip.custom</a></span>(<span class='kw'>strip.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
 <span class='kw'>factor.levels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"4"</span>, <span class='st'>"8"</span>, <span class='st'>"16"</span>, <span class='st'>"32"</span>)),
<span class='kw'>panel</span> <span class='kw'>=</span> <span class='no'>panel.plot</span>)</div><div class='img'><img src='example5-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## *************************************************************************************</span>
<span class='co'>##   Quadratic regression model diagnostic plots with and without transformations</span>
<span class='co'>## *************************************************************************************</span>

<span class='co'>## graphical plots of untransformed data</span>
<span class='fu'>par</span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>2</span>, <span class='fl'>2</span>), <span class='kw'>oma</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>0</span>))
<span class='no'>fit.quad.mod</span> <span class='kw'>=</span> <span class='fu'>lm</span>(<span class='no'>log_yield</span> ~ <span class='no'>linDensity</span> * <span class='no'>linSpacing</span> + <span class='no'>quadDensity</span> + <span class='no'>quadSpacing</span>,
 <span class='no'>turnip</span>)
<span class='fu'>plot</span>(<span class='no'>fit.quad.mod</span>, <span class='kw'>sub.caption</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</div><div class='input'><span class='fu'>title</span>(<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Fig 12a Diagnostics for untransformed sowing density and row spacing"</span>, <span class='kw'>outer</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='example5-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## graphical plots of log transformed data</span>
<span class='fu'>par</span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>2</span>, <span class='fl'>2</span>), <span class='kw'>oma</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>0</span>))
<span class='no'>fit.log.quad.mod</span> <span class='kw'>=</span> <span class='fu'>lm</span>(<span class='no'>log_yield</span> ~ <span class='no'>linlogDensity</span> * <span class='no'>linlogSpacing</span> + <span class='no'>quadlogDensity</span> +
 <span class='no'>quadlogSpacing</span>, <span class='no'>turnip</span>)
<span class='fu'>plot</span>(<span class='no'>fit.log.quad.mod</span>, <span class='kw'>sub.caption</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</div><div class='input'><span class='fu'>title</span>(<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Fig 12b Diagnostics for log transformed sowing density and row spacing"</span>, <span class='kw'>outer</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='example5-6.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Rodney Edmondson, Hans-Peter Piepho, Muhammad Yaseen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

