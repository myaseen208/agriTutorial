<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Example 5: Transformation of treatment levels to improve model fit — example5 • agriTutorial</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Example 5: Transformation of treatment levels to improve model fit — example5" />
<meta property="og:description" content="Mead (1988, p. 323) describes an experiment on spacing effects with turnips,
which was laid out in three complete blocks. Five different seed rates
(0.5, 2, 8, 20, 32 lb/acre) were tested in combination with four different row widths
(4, 8, 16, 32 inches), giving rise to a total of 20 treatments." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agriTutorial</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-o"></span>
     
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/IntroagriTutorial.pdf">Introduction to agriTutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/myaseen208/agriTutorial">
    <span class="fa fa-github-alt"></span>
     
    Github
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Example 5: Transformation of treatment levels to improve model fit</h1>
    <small class="dont-index">Source: <a href='https://github.com/myaseen208/agriTutorial/blob/master/R/example5.R'><code>R/example5.R</code></a></small>
    <div class="hidden name"><code>example5.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Mead (1988, p. 323) describes an experiment on spacing effects with turnips,
which was laid out in three complete blocks. Five different seed rates
(0.5, 2, 8, 20, 32 lb/acre) were tested in combination with four different row widths
(4, 8, 16, 32 inches), giving rise to a total of 20 treatments.</p>
    </div>



    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Transformation of the dependent variable will often stabilize the variance of the observations
whereas transformation of the regressor variables will often simplify the fitted model. In this
example, the fit of a regression model based on the original seed rate and row width variables is compared
with the fit of a regression model based on the log transformed seed rates and log transformed row widths.
In each case, the model lack-of-fit is examined by assessing the extra variability explained when the
Density and Spacing treatment factors and their interactions are added to the quadratic regression models.
All yields are logarithmically transformed to stabilize the variance.</p>
<p>The first analysis fits a quadratic regression model of log yields on the untransformed seed rates and row
widths (Table 16) while the second analysis fits a quadratic regression model of log yields on the log
transformed seed rates and log transformed row widths (Table 17). The analysis of variance of the first model
shows that significant extra variability is explained by the Density and
Spacing factors and this shows that a quadratic regression model is inadequate for the untransformed regressor
variables. The analysis of variance of the second model, however, shows no significant extra variability
explained by the Density and Spacing factors and this shows that the quadratic regression model with the log
transformed regressor variables gives a good fit to the data and therefore is the preferred model for the
observed data.</p>
<p>The superiority of the model with the log transformed regressor variables is confirmed by comparing the fit of the
quadratic regression model for the untransformed regressor variables (Figs 8 and 9) versus the fit of the
quadratic regression model for the log transformed regressor variables (Figs 10 and 11).</p>
<p>Fig 12a shows diagnostic plots for the fit of a quadratic model with untransformed regressor variables
while Fig 12b shows corresponding diagnostic plots for the fit of a quadratic model with
loge transformed regressor variables. Each of the four types of diagnostic plots in the two figures
shows an improvement in fit for the transformed versus the untransformed regressor variables.</p>
<p><code><a href='agriTutorial.html'>agriTutorial</a></code>: return to home page if you want to select a different example <br /></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>Mead, R. (1990). <em>The Design of Experiments: Statistical Principles for Practical Applications</em>. Cambridge University Press.</p></li>
<li><p>Kenward, M. G., &amp; Roger, J. H. (1997). Small sample inference for fixed effects from restricted maximum likelihood. <em>Biometrics</em>,  <strong>53</strong>, 983–997.</p></li>
<li><p>Piepho, H., &amp; Edmondson, R. (2018). A tutorial on the Statistical Analysis of Factorial Experiments with Qualitative and Quantitative treatment factor levels. 
               <em>Journal of Agronomy and Crop Science.</em> (<a href='https://onlinelibrary.wiley.com/doi/full/10.1111/jac.12267'>https://onlinelibrary.wiley.com/doi/full/10.1111/jac.12267</a>).</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>broom</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>broom.mixed</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>emmeans</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggfortify</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggplot2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>lmerTest</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>magrittr</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>tidyr</span>)

<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'contr.treatment'</span>, <span class='st'>'contr.poly'</span>))

<span class='co'>##----fm5.1----</span>
<span class='no'>fm5.1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>(<span class='no'>log_yield</span> ~ <span class='no'>Replicate</span> + <span class='no'>density</span> * <span class='no'>rowspacing</span> +
              <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>density</span>^<span class='fl'>2</span>) + <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>rowspacing</span>^<span class='fl'>2</span>) + <span class='no'>Density</span> * <span class='no'>Spacing</span>
            , <span class='no'>turnip</span>)
<span class='no'>fm5.1.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span>(<span class='no'>fm5.1</span>)


<span class='co'>##----fm5.1.ANOVA----</span>
<span class='no'>fm5.1.ANOVA</span></div><div class='output co'>#&gt; Analysis of Variance Table
#&gt; 
#&gt; Response: log_yield
#&gt;                    Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
#&gt; Replicate           2  3.4168  1.7084  43.6173 1.443e-10 ***
#&gt; density             1 14.1195 14.1195 360.4862 &lt; 2.2e-16 ***
#&gt; rowspacing          1  0.5177  0.5177  13.2186 0.0008184 ***
#&gt; I(density^2)        1  6.1783  6.1783 157.7372 4.242e-15 ***
#&gt; I(rowspacing^2)     1  0.2237  0.2237   5.7124 0.0219091 *  
#&gt; Density             2  5.3498  2.6749  68.2929 2.617e-13 ***
#&gt; Spacing             1  0.1752  0.1752   4.4722 0.0410661 *  
#&gt; density:rowspacing  1  0.4470  0.4470  11.4136 0.0016958 ** 
#&gt; Density:Spacing    11  0.5505  0.0500   1.2777 0.2740490    
#&gt; Residuals          38  1.4884  0.0392                       
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>##----fm5.2----</span>
<span class='no'>fm5.2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>(<span class='no'>log_yield</span> ~ <span class='no'>Replicate</span> + <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>density</span>) * <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>rowspacing</span>) +
              <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>density</span>)^<span class='fl'>2</span>) + <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>rowspacing</span>)^<span class='fl'>2</span>) +
              <span class='no'>Density</span> * <span class='no'>Spacing</span>, <span class='no'>turnip</span>)
<span class='no'>fm5.2.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span>(<span class='no'>fm5.2</span>)


<span class='co'>##----fm5.2.ANOVA----</span>
<span class='no'>fm5.2.ANOVA</span></div><div class='output co'>#&gt; Analysis of Variance Table
#&gt; 
#&gt; Response: log_yield
#&gt;                              Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
#&gt; Replicate                     2  3.4168  1.7084  43.6173 1.443e-10 ***
#&gt; log(density)                  1 23.4772 23.4772 599.3960 &lt; 2.2e-16 ***
#&gt; log(rowspacing)               1  0.2803  0.2803   7.1562 0.0109578 *  
#&gt; I(log(density)^2)             1  2.1001  2.1001  53.6189 9.043e-09 ***
#&gt; I(log(rowspacing)^2)          1  0.6100  0.6100  15.5750 0.0003308 ***
#&gt; Density                       2  0.0703  0.0351   0.8971 0.4161980    
#&gt; Spacing                       1  0.0263  0.0263   0.6720 0.4174728    
#&gt; log(density):log(rowspacing)  1  0.7503  0.7503  19.1572 9.092e-05 ***
#&gt; Density:Spacing              11  0.2472  0.0225   0.5738 0.8377327    
#&gt; Residuals                    38  1.4884  0.0392                       
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>##----fm5.3----</span>
<span class='no'>fm5.3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>(<span class='no'>log_yield</span> ~ <span class='no'>density</span> * <span class='no'>rowspacing</span> + <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>density</span>^<span class='fl'>2</span>) +
              <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>rowspacing</span>^<span class='fl'>2</span>) , <span class='no'>turnip</span>)
<span class='no'>fm5.3.Coef</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/broom/man/reexports.html'>tidy</a></span>(<span class='no'>fm5.3</span>)
<span class='no'>turnip1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/broom/man/reexports.html'>augment</a></span>(<span class='no'>fm5.3</span>, <span class='no'>turnip</span>)

<span class='co'>##----fm5.3.Coef----</span>
<span class='no'>fm5.3.Coef</span></div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 6 x 5</span><span>
#&gt;   term                estimate std.error statistic  p.value
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>                  </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>    </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span> (Intercept)         1.11      0.224         4.99 6.75</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 6</span><span>
#&gt; </span><span style='color: #555555;'>2</span><span> density             0.156     0.020</span><span style='text-decoration: underline;'>9</span><span>        7.48 6.93</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>-10</span><span>
#&gt; </span><span style='color: #555555;'>3</span><span> rowspacing          0.028</span><span style='text-decoration: underline;'>5</span><span>    0.028</span><span style='text-decoration: underline;'>5</span><span>        1.00 3.22</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 1</span><span>
#&gt; </span><span style='color: #555555;'>4</span><span> I(density^2)       -</span><span style='color: #BB0000;'>0.003</span><span style='color: #BB0000;text-decoration: underline;'>32</span><span>   0.000</span><span style='text-decoration: underline;'>602</span><span>     -</span><span style='color: #BB0000;'>5.51</span><span> 1.02</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 6</span><span>
#&gt; </span><span style='color: #555555;'>5</span><span> I(rowspacing^2)    -</span><span style='color: #BB0000;'>0.000</span><span style='color: #BB0000;text-decoration: underline;'>775</span><span>  0.000</span><span style='text-decoration: underline;'>739</span><span>     -</span><span style='color: #BB0000;'>1.05</span><span> 2.99</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 1</span><span>
#&gt; </span><span style='color: #555555;'>6</span><span> density:rowspacing -</span><span style='color: #BB0000;'>0.000</span><span style='color: #BB0000;text-decoration: underline;'>675</span><span>  0.000</span><span style='text-decoration: underline;'>455</span><span>     -</span><span style='color: #BB0000;'>1.48</span><span> 1.44</span><span style='color: #555555;'>e</span><span style='color: #BB0000;'>- 1</span><span></div><div class='input'>
<span class='co'>##----fm5.3.Plot1----</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip1</span>,
       <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>rowspacing</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>log_yield</span>,
                     <span class='kw'>color</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>density</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>density</span>))) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span><span class='no'>.fitted</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='img'><img src='example5-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm5.3.Plot2----</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip1</span>,
       <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>rowspacing</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>log_yield</span>),
                     <span class='kw'>color</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>density</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>density</span>))) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>.fitted</span>)), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 3.86</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 12.14</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  4.7763e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 582.74</span></div><div class='img'><img src='example5-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm5.3.Plot3----</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip1</span>,
       <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>density</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>log_yield</span>,
                     <span class='kw'>color</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>rowspacing</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>rowspacing</span>))) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span><span class='no'>.fitted</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='img'><img src='example5-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm5.3.Plot4----</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip1</span>,
       <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>density</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>log_yield</span>),
                     <span class='kw'>color</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>rowspacing</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>rowspacing</span>))) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>.fitted</span>)), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='img'><img src='example5-4.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>##----fm5.4----</span>
<span class='no'>fm5.4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>(<span class='no'>log_yield</span> ~ <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>density</span>) * <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>rowspacing</span>) +
              <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>density</span>)^<span class='fl'>2</span>) + <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>rowspacing</span>)^<span class='fl'>2</span>),
            <span class='no'>turnip</span>)
<span class='no'>fm5.4.Coef</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/broom/man/reexports.html'>tidy</a></span>(<span class='no'>fm5.4</span>)
<span class='no'>turnip2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/broom/man/reexports.html'>augment</a></span>(<span class='no'>fm5.4</span>, <span class='no'>turnip</span>)

<span class='co'>##----fm5.4.Plot1----</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip2</span>,
       <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>rowspacing</span>), <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>log_yield</span>,
                     <span class='kw'>color</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>density</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>density</span>))) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span><span class='no'>.fitted</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='img'><img src='example5-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm5.4.Plot2----</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip2</span>,
       <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>rowspacing</span>), <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>log_yield</span>),
                     <span class='kw'>color</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>density</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>density</span>))) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>.fitted</span>)), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 1.3759</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3967</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.9507</span></div><div class='img'><img src='example5-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm5.4.Plot3----</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip2</span>,
       <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>density</span>), <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>log_yield</span>,
                     <span class='kw'>color</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>rowspacing</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>rowspacing</span>))) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span><span class='no'>.fitted</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='img'><img src='example5-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm5.4.Plot4----</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>turnip2</span>,
       <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>density</span>), <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>log_yield</span>),
                     <span class='kw'>color</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>rowspacing</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>rowspacing</span>))) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span>() +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>.fitted</span>)), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 2.0794</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.3863</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  3.5962e-17</span></div><div class='img'><img src='example5-8.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>##----fm5.5----</span>
<span class='no'>fm5.5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>(<span class='no'>log_yield</span> ~ <span class='no'>density</span> * <span class='no'>rowspacing</span> +
              <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>density</span>^<span class='fl'>2</span>) + <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>rowspacing</span>^<span class='fl'>2</span>),
            <span class='no'>turnip</span>)

<span class='co'>##----fm5.5.Plot1----</span>
<span class='kw pkg'>ggplot2</span><span class='kw ns'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/autoplot.html'>autoplot</a></span>(<span class='no'>fm5.5</span>)</div><div class='img'><img src='example5-9.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm5.6----</span>
<span class='no'>fm5.6</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>(<span class='no'>log_yield</span> ~ <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>density</span>) * <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>rowspacing</span>) +
              <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>density</span>)^<span class='fl'>2</span>) + <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>rowspacing</span>)^<span class='fl'>2</span>),
            <span class='no'>turnip</span>)

<span class='co'>##----fm5.6.Plot1----</span>
<span class='kw pkg'>ggplot2</span><span class='kw ns'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/autoplot.html'>autoplot</a></span>(<span class='no'>fm5.6</span>)</div><div class='img'><img src='example5-10.png' alt='' width='700' height='433' /></div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
<ol>
<li><p>Rodney N. Edmondson (<a href='mailto:rodney.edmondson@gmail.com'>rodney.edmondson@gmail.com</a>)</p></li>
<li><p>Hans-Peter Piepho (<a href='mailto:piepho@uni-hohenheim.de'>piepho@uni-hohenheim.de</a>)</p></li>
<li><p>Muhammad Yaseen (<a href='mailto:myaseen208@gmail.com'>myaseen208@gmail.com</a>)</p></li>
</ol>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rodney Edmondson, Hans-Peter Piepho, Muhammad Yaseen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: 'bdafb7ea4490644e670f470ee3ef537f',
    indexName: 'agriTutorial',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


