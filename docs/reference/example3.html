<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Example 3: Polynomial regression model with two quantitative level treatment factors — example3 • agriTutorial</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Example 3: Polynomial regression model with two quantitative level treatment factors — example3" />

<meta property="og:description" content="Gomez &amp;amp; Gomez (1984, p. 401) report a two-factor nitrogen uptake greenhouse experiment on rice
involving duration of water stress (W) and level of nitrogen application (N) with four complete replicates of each treatment.
The experiment had four water-stress levels (0, 10, 20 and 40 days) applied as main-plot treatments and
four nitrogen rates (0, 90, 180 and 270 kg/ha) applied as sub-plot treatments. The four sub-plot treatments were randomized
 within main plots and the four main plot treatments were randomized within complete replicate blocks." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agriTutorial</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Example 3: Polynomial regression model with two quantitative level treatment factors</h1>
    
    <div class="hidden name"><code>example3.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Gomez &amp; Gomez (1984, p. 401) report a two-factor nitrogen uptake greenhouse experiment on rice
involving duration of water stress (W) and level of nitrogen application (N) with four complete replicates of each treatment.
The experiment had four water-stress levels (0, 10, 20 and 40 days) applied as main-plot treatments and
four nitrogen rates (0, 90, 180 and 270 kg/ha) applied as sub-plot treatments. The four sub-plot treatments were randomized
 within main plots and the four main plot treatments were randomized within complete replicate blocks.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The first stage of the analysis is the calculation of polynomial powers of N and W using the poly() function.
The N rates are re-scaled by division by 100 while the W rates are re-scaled by division by 10.</p>
<p>The second stage shows a Pearson residual plot of the untransformed N uptake data versus a Pearson residual plot of
the log transformed N uptake data. Comparison of the two plots shows that the untransformed residuals
increase as the fitted values increase whereas the log transformed N uptake residuals are approximately constant
over the full range of the fitted values. This shows that a log transformation of the N uptake data gives a
dependent variate with constant variance over the full range of fitted values which shows that a simple
unweighted analysis of variance is valid for the effects of the treatment factors.</p>
<p>Sometimes the original scale of measurement is the proper scale of measurement for an analysis,
e.g. an analysis of actual measured crop yields, and then it might be appropriate to fit a weighted
analysis of variance in the original scale of measurement of the dependent variable (see Faraway 2002 Chapter 5).
However, the log transformation model assumes a proportional rather than an additive model
for treatment effects and, in this example, a proportional model for nitrogen uptake may well be a more natural
physiological model than a simple additive model.</p>
<p>The next stage compares the fit of a first-order linear model (Table 9) versus a second-order quadratic
model (Table 10). The first-order model shows significant lack-of-fit and is not adequate for the
data. The second-order model is also not fully adequate for the data as there is a significant N lack of
fit term indicating a significant cubic effect. However, the magnitude of the cubic effect is
relatively small and it will be assumed here that a quadratic model is adequate for the data.</p>
<p>The final stage fits regression coefficients for the quadratic response surface model on the
re-scaled water stress and re-scaled nitrogen rate treatments. The fitted coefficients are then used to
plot the fitted quadratic log uptake curves versus the nitrogen rate treatments and the
water stress treatments, as shown in Fig 4.</p>
<p>Note that in this analysis all the polynomial models are built by adding individual polynomial effects in accordance with the requirements of
functional marginality.</p>
<p><code><a href='agriTutorial.html'>agriTutorial</a></code>: return to home page if you want to select a different example <br /></p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <ol>
<li><p>Gomez, K. A., &amp; Gomez, A. A. (1984). <em>Statistical Procedures for Agricultural Research</em>.   John Wiley &amp; Sons.</p></li>
<li><p>Kenward, M. G., &amp; Roger, J. H. (1997). Small sample inference for fixed effects from restricted maximum likelihood. <em>Biometrics</em>,  <strong>53</strong>, 983–997.</p></li>
<li><p>Piepho, H., &amp; Edmondson, R. (2018). A tutorial on the Statistical Analysis of Factorial Experiments with Qualitative and Quantitative treatment factor levels. 
               <em>Journal of Agronomy and Crop Science.</em> (<a href='https://onlinelibrary.wiley.com/doi/full/10.1111/jac.12267'>https://onlinelibrary.wiley.com/doi/full/10.1111/jac.12267</a>).</p></li>
</ol>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>broom</span>)
<span class='fu'>library</span>(<span class='no'>broom.mixed</span>)
<span class='fu'>library</span>(<span class='no'>dplyr</span>)
<span class='fu'>library</span>(<span class='no'>emmeans</span>)
<span class='fu'>library</span>(<span class='no'>ggfortify</span>)
<span class='fu'>library</span>(<span class='no'>ggplot2</span>)
<span class='fu'>library</span>(<span class='no'>lmerTest</span>)
<span class='fu'>library</span>(<span class='no'>magrittr</span>)
<span class='fu'>library</span>(<span class='no'>pbkrtest</span>)
<span class='fu'>library</span>(<span class='no'>tidyr</span>)

<span class='fu'>options</span>(<span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>'contr.treatment'</span>, <span class='st'>'contr.poly'</span>))

<span class='co'>##----greenrice----</span>
<span class='no'>greenrice</span> <span class='kw'>&lt;-</span>
  <span class='no'>greenrice</span> <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(
    <span class='kw'>loguptake</span>   <span class='kw'>=</span> <span class='fu'>log</span>(<span class='no'>uptake</span>)
    , <span class='kw'>Nitrogen</span>    <span class='kw'>=</span> <span class='fu'>factor</span>(<span class='no'>N</span>)
    , <span class='kw'>Water</span>       <span class='kw'>=</span> <span class='fu'>factor</span>(<span class='no'>W</span>)
  )


<span class='co'>##----fm3.1----</span>
<span class='no'>fm3.1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>uptake</span> ~ <span class='no'>Replicate</span> + <span class='no'>Nitrogen</span> * <span class='no'>Water</span> +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>)

<span class='co'>##----fm3.1.Plot1----</span>
<span class='no'>fm3.1.Augment</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom.mixed</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom.mixed/topics/reexports'>augment</a></span>(<span class='no'>fm3.1</span>)

<span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggplot'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>fm3.1.Augment</span>, <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>.fitted</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>.resid</span>)) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_point'>geom_point</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_abline'>geom_hline</a></span>(<span class='kw'>yintercept</span> <span class='kw'>=</span> <span class='fl'>0</span>) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/labs'>labs</a></span>(
    <span class='kw'>x</span> <span class='kw'>=</span> <span class='st'>"Fitted"</span>
    , <span class='kw'>y</span> <span class='kw'>=</span> <span class='st'>"Residuals N uptake"</span>
    , <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>"Pearson residual plot for untransformed N uptake"</span>) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme'>theme_bw</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/theme'>theme</a></span>(<span class='kw'>plot.title</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/element'>element_text</a></span>(<span class='kw'>hjust</span> <span class='kw'>=</span> <span class='fl'>0.5</span>))</div><div class='img'><img src='example3-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm3.2----</span>
<span class='no'>fm3.2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>loguptake</span> ~ <span class='no'>Replicate</span> + <span class='no'>Nitrogen</span> * <span class='no'>Water</span> +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>)

<span class='co'>##----fm3.2.Plot1----</span>
<span class='no'>fm3.2.Augment</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom.mixed</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom.mixed/topics/reexports'>augment</a></span>(<span class='no'>fm3.2</span>)

<span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggplot'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>fm3.2.Augment</span>, <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>.fitted</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>.resid</span>)) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_point'>geom_point</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_abline'>geom_hline</a></span>(<span class='kw'>yintercept</span> <span class='kw'>=</span> <span class='fl'>0</span>) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/labs'>labs</a></span>(
    <span class='kw'>x</span> <span class='kw'>=</span> <span class='st'>"Fitted"</span>
    , <span class='kw'>y</span> <span class='kw'>=</span> <span class='st'>"Residuals log N uptake"</span>
    , <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>"Pearson residual plot for log transformed N uptake"</span>) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme'>theme_bw</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/theme'>theme</a></span>(<span class='kw'>plot.title</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/element'>element_text</a></span>(<span class='kw'>hjust</span> <span class='kw'>=</span> <span class='fl'>0.5</span>))</div><div class='img'><img src='example3-2.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>##----fm3.3----</span>
<span class='no'>fm3.3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>loguptake</span> ~ <span class='no'>N</span> + <span class='no'>W</span> + <span class='no'>Nitrogen</span> * <span class='no'>Water</span> +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>)</div><div class='output co'>#&gt; <span class='message'>fixed-effect model matrix is rank deficient so dropping 2 columns / coefficients</span></div><div class='input'><span class='no'>fm3.3.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm3.3</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='no'>fm3.3.Summary</span> <span class='kw'>&lt;-</span> <span class='fu'>summary</span>(<span class='no'>fm3.3</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)$<span class='no'>coef</span></div><div class='output co'>#&gt; <span class='warning'>Warning: additional arguments ignored</span></div><div class='input'>
<span class='co'>##----fm3.3.ANOVA----</span>
<span class='no'>fm3.3.ANOVA</span></div><div class='output co'>#&gt; Type I Analysis of Variance Table with Kenward-Roger's method
#&gt;                 Sum Sq Mean Sq NumDF DenDF   F value    Pr(&gt;F)    
#&gt; N               4.6529  4.6529     1    36  183.8071 1.033e-15 ***
#&gt; W              25.5240 25.5240     1     9 1008.2989 1.496e-10 ***
#&gt; Nitrogen        0.6297  0.3148     2    36   12.4375 7.826e-05 ***
#&gt; Water           2.7392  1.3696     2     9   54.1047 9.633e-06 ***
#&gt; Nitrogen:Water  1.3181  0.1465     9    36    5.7856 5.878e-05 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>##----fm3.3.Summary----</span>
<span class='no'>fm3.3.Summary</span></div><div class='output co'>#&gt;                         Estimate   Std. Error       df     t value     Pr(&gt;|t|)
#&gt; (Intercept)         -1.156645121 0.0800308146 47.89766 -14.4524972 4.345837e-19
#&gt; N                    0.004248876 0.0004166787 36.00000  10.1970084 3.679346e-12
#&gt; W                   -0.030069847 0.0028125809 44.30769 -10.6911934 7.480406e-14
#&gt; Nitrogen90           0.113364341 0.0992185298 36.00000   1.1425723 2.607584e-01
#&gt; Nitrogen180          0.135067013 0.0992185298 36.00000   1.3613083 1.818766e-01
#&gt; Water10              0.354424925 0.1014090483 44.30769   3.4950030 1.089068e-03
#&gt; Water20              0.419364354 0.0974306621 44.30769   4.3042339 9.123952e-05
#&gt; Nitrogen90:Water10   0.064245275 0.1591036050 36.00000   0.4037952 6.887520e-01
#&gt; Nitrogen180:Water10 -0.194517509 0.1591036050 36.00000  -1.2225839 2.294309e-01
#&gt; Nitrogen270:Water10 -0.143681681 0.1591036050 36.00000  -0.9030699 3.724920e-01
#&gt; Nitrogen90:Water20   0.089807632 0.1591036050 36.00000   0.5644601 5.759414e-01
#&gt; Nitrogen180:Water20 -0.383553658 0.1591036050 36.00000  -2.4107163 2.115270e-02
#&gt; Nitrogen270:Water20 -0.457590823 0.1591036050 36.00000  -2.8760557 6.725501e-03
#&gt; Nitrogen90:Water40  -0.108344146 0.1591036050 36.00000  -0.6809660 5.002500e-01
#&gt; Nitrogen180:Water40 -0.712343182 0.1591036050 36.00000  -4.4772284 7.330223e-05
#&gt; Nitrogen270:Water40 -0.865393492 0.1591036050 36.00000  -5.4391822 3.905305e-06</div><div class='input'>
<span class='co'>##----fm3.4----</span>
<span class='no'>fm3.4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>loguptake</span> ~ <span class='no'>N</span> * <span class='no'>W</span> + <span class='fu'>I</span>(<span class='no'>N</span>^<span class='fl'>2</span>) + <span class='fu'>I</span>(<span class='no'>W</span>^<span class='fl'>2</span>) +
                <span class='no'>Nitrogen</span> * <span class='no'>Water</span> + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>)</div><div class='output co'>#&gt; <span class='message'>fixed-effect model matrix is rank deficient so dropping 5 columns / coefficients</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='input'><span class='no'>fm3.4.Coef</span> <span class='kw'>&lt;-</span><span class='fu'>summary</span>(<span class='no'>fm3.4</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)$<span class='no'>coef</span></div><div class='output co'>#&gt; <span class='warning'>Warning: additional arguments ignored</span></div><div class='input'><span class='no'>greenrice2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom.mixed</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom.mixed/topics/reexports'>augment</a></span>(<span class='no'>fm3.4</span>)


<span class='co'>##----fm3.4.Coef----</span>
<span class='no'>fm3.4.Coef</span></div><div class='output co'>#&gt;                          Estimate   Std. Error       df     t value
#&gt; (Intercept)         -1.156645e+00 8.003081e-02 47.89766 -14.4524972
#&gt; N                    6.499993e-03 1.627182e-03 36.00000   3.9946312
#&gt; W                    1.186659e-02 1.014090e-02 44.30769   1.1701706
#&gt; I(N^2)              -8.337470e-06 6.124601e-06 36.00000  -1.3613083
#&gt; I(W^2)              -1.048411e-03 2.435767e-04 44.30769  -4.3042338
#&gt; Nitrogen90          -2.170267e-02 1.185888e-01 36.00000  -0.1830077
#&gt; Water10              3.990166e-02 1.042933e-01 44.30769   0.3825909
#&gt; N:W                 -8.012903e-05 1.473182e-05 36.00000  -5.4391822
#&gt; Nitrogen90:Water10   1.363614e-01 1.563170e-01 36.00000   0.8723390
#&gt; Nitrogen180:Water10 -5.028526e-02 1.546209e-01 36.00000  -0.3252164
#&gt; Nitrogen270:Water10  7.266669e-02 1.434141e-01 36.00000   0.5066916
#&gt; Nitrogen90:Water20   2.340399e-01 1.546209e-01 36.00000   1.5136367
#&gt; Nitrogen180:Water20 -9.508916e-02 1.546209e-01 36.00000  -0.6149825
#&gt; Nitrogen270:Water20 -2.489408e-02 1.377878e-01 36.00000  -0.1806697
#&gt; Nitrogen90:Water40   1.801204e-01 1.403162e-01 36.00000   1.2836748
#&gt; Nitrogen180:Water40 -1.354142e-01 1.403162e-01 36.00000  -0.9650646
#&gt;                         Pr(&gt;|t|)
#&gt; (Intercept)         4.345837e-19
#&gt; N                   3.062454e-04
#&gt; W                   2.481882e-01
#&gt; I(N^2)              1.818766e-01
#&gt; I(W^2)              9.123952e-05
#&gt; Nitrogen90          8.558188e-01
#&gt; Water10             7.038524e-01
#&gt; N:W                 3.905305e-06
#&gt; Nitrogen90:Water10  3.888047e-01
#&gt; Nitrogen180:Water10 7.468999e-01
#&gt; Nitrogen270:Water10 6.154608e-01
#&gt; Nitrogen90:Water20  1.388488e-01
#&gt; Nitrogen180:Water20 5.424343e-01
#&gt; Nitrogen270:Water20 8.576401e-01
#&gt; Nitrogen90:Water40  2.074571e-01
#&gt; Nitrogen180:Water40 3.409510e-01</div><div class='input'>
<span class='co'>##----fm3.4.Plot1----</span>
<span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggplot'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice2</span>, <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>Water</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>loguptake</span>, <span class='kw'>color</span> <span class='kw'>=</span> <span class='no'>Nitrogen</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>Nitrogen</span>)) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_point'>geom_point</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_smooth'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span><span class='no'>.fitted</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='img'><img src='example3-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm3.4.Plot2----</span>
<span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggplot'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice2</span>, <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>Water</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'>exp</span>(<span class='no'>loguptake</span>), <span class='kw'>color</span> <span class='kw'>=</span> <span class='no'>Nitrogen</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>Nitrogen</span>)) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_point'>geom_point</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_smooth'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span><span class='no'>.fitted</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='img'><img src='example3-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm3.4.Plot3----</span>
<span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggplot'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice2</span>, <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>Nitrogen</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>loguptake</span>, <span class='kw'>color</span> <span class='kw'>=</span> <span class='no'>Water</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>Water</span>)) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_point'>geom_point</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_smooth'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span><span class='no'>.fitted</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  2.2269e-16</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  2.2269e-16</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  6.3601e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  6.3601e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  5.193e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  5.193e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='img'><img src='example3-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm3.4.Plot4----</span>
<span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggplot'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice2</span>, <span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>Nitrogen</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'>exp</span>(<span class='no'>loguptake</span>), <span class='kw'>color</span> <span class='kw'>=</span> <span class='no'>Water</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>Water</span>)) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_point'>geom_point</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_smooth'>geom_smooth</a></span>(<span class='kw'>mapping</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>y</span> <span class='kw'>=</span><span class='no'>.fitted</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"loess"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  2.2269e-16</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  2.2269e-16</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  6.3601e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  6.3601e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  5.193e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 0.985</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  5.193e-17</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 4.0602</span></div><div class='img'><img src='example3-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm3.5----</span>
<span class='no'>fm3.5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>loguptake</span> ~ <span class='no'>N</span> * <span class='no'>W</span> + <span class='fu'>I</span>(<span class='no'>N</span>^<span class='fl'>2</span>) + <span class='fu'>I</span>(<span class='no'>W</span>^<span class='fl'>2</span>) +
                (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some predictor variables are on very different scales: consider rescaling</span></div><div class='input'><span class='no'>fm3.5.Coef</span> <span class='kw'>&lt;-</span> <span class='fu'>summary</span>(<span class='no'>fm3.5</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)$<span class='no'>coef</span></div><div class='output co'>#&gt; <span class='warning'>Warning: additional arguments ignored</span></div><div class='input'>
<span class='co'>##----fm3.5.Coef----</span>
<span class='no'>fm3.5.Coef</span></div><div class='output co'>#&gt;                  Estimate   Std. Error       df    t value     Pr(&gt;|t|)
#&gt; (Intercept) -1.160003e+00 6.378222e-02 47.80633 -18.186927 4.047012e-23
#&gt; N            6.799986e-03 7.788309e-04 45.00000   8.731018 3.050437e-11
#&gt; W            1.760281e-02 5.507288e-03 12.91860   3.196276 7.067219e-03
#&gt; I(N^2)      -9.380292e-06 2.618722e-06 45.00000  -3.582012 8.328506e-04
#&gt; I(W^2)      -1.159906e-03 1.196498e-04 10.00000  -9.694176 2.111488e-06
#&gt; N:W         -9.072484e-05 1.425289e-05 45.00000  -6.365367 8.941001e-08</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
<ol>
<li><p>Rodney N. Edmondson (<a href='mailto:rodney.edmondson@gmail.com'>rodney.edmondson@gmail.com</a>)</p></li>
<li><p>Hans-Peter Piepho (<a href='mailto:piepho@uni-hohenheim.de'>piepho@uni-hohenheim.de</a>)</p></li>
<li><p>Muhammad Yaseen (<a href='mailto:myaseen208@gmail.com'>myaseen208@gmail.com</a>)</p></li>
</ol>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Rodney Edmondson, Hans-Peter Piepho, Muhammad Yaseen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

