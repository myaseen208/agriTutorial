<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Example 3: Polynomial regression model with two quantitative level treatment factors — example3 • agriTutorial</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Example 3: Polynomial regression model with two quantitative level treatment factors — example3" />

<meta property="og:description" content="(Gomez &amp;amp; Gomez, 1984, p. 401) report a two-factor nitrogen uptake greenhouse experiment on rice
involving duration of water stress (W) and level of nitrogen application (N) with four complete replicates of each treatment.
The experiment had four water-stress levels (0, 10, 20 and 40 days) applied as main-plot treatments and
four nitrogen rates (0, 90, 180 and 270 kg/ha) applied as sub-plot treatments. The four sub-plot treatments were randomized
 within main plots and the four main plot treatments were randomized within complete replicate blocks." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agriTutorial</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Example 3: Polynomial regression model with two quantitative level treatment factors</h1>
    
    <div class="hidden name"><code>example3.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>(Gomez &amp; Gomez, 1984, p. 401) report a two-factor nitrogen uptake greenhouse experiment on rice
involving duration of water stress (W) and level of nitrogen application (N) with four complete replicates of each treatment.
The experiment had four water-stress levels (0, 10, 20 and 40 days) applied as main-plot treatments and
four nitrogen rates (0, 90, 180 and 270 kg/ha) applied as sub-plot treatments. The four sub-plot treatments were randomized
 within main plots and the four main plot treatments were randomized within complete replicate blocks.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The first stage of the analysis is the calculation of polynomial powers of N and W using the poly() function.
The N rates are re-scaled by division by 100 while the W rates are re-scaled by division by 10.</p>
<p>The second stage shows a Pearson residual plot of the untransformed N uptake data versus a Pearson residual plot of
the log transformed N uptake data. Comparison of the two plots shows that the untransformed residuals
increase as the fitted values increase whereas the log transformed N uptake residuals are approximately constant
over the full range of the fitted values. This shows that a log transformation of the N uptake data gives a
dependent variate with constant variance over the full range of fitted values which shows that a simple
unweighted analysis of variance is valid for the effects of the treatment factors.</p>
<p>Sometimes the original scale of measurement is the proper scale of measurement for an analysis,
e.g. an analysis of actual measured crop yields, and then it might be appropriate to fit a weighted
analysis of variance in the original scale of measurement of the dependent variable (see Faraway 2002 Chapter 5).
However, the log transformation model assumes a proportional rather than an additive model
for treatment effects and, in this example, a proportional model for nitrogen uptake may well be a more natural
physiological model than a simple additive model.</p>
<p>The next stage compares the fit of a first-order linear model (Table 9) versus a second-order quadratic
model (Table 10). The first-order model shows significant lack-of-fit and is not adequate for the
data. The second-order model is also not fully adequate for the data as there is a significant N lack of
fit term indicating a significant cubic effect. However, the magnitude of the cubic effect is
relatively small and it will be assumed here that a quadratic model is adequate for the data.</p>
<p>The final stage fits regression coefficients for the quadratic response surface model on the
re-scaled water stress and re-scaled nitrogen rate treatments. The fitted coefficients are then used to
plot the fitted quadratic log uptake curves versus the nitrogen rate treatments and the
water stress treatments, as shown in Fig 4.</p>
<p>Note that in this analysis all the polynomial models are built by adding individual polynomial effects in accordance with the requirements of
functional marginality.</p>
<p><code><a href='agriTutorial.html'>agriTutorial</a></code>: return to home page if you want to select a different example <br /></p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Faraway J (2002) Practical Regression and Anova using R. https://cran.r-project.org/doc/contrib/Faraway-PRA.pdf</p>
<p>Gomez, K.A., &amp; Gomez, A.A. (1984). Statistical procedures for agricultural research, 2nd edn. New York: Wiley.</p>
<p>Piepho, H. P, and Edmondson. R. N. (2018). A tutorial on the statistical analysis of factorial experiments with qualitative and quantitative
treatment factor levels. Journal of Agronomy and Crop Science. DOI: 10.1111/jac.12267.
<a href='http://onlinelibrary.wiley.com/doi/10.1111/jac.12267/full'>Early View</a></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## *************************************************************************************</span>
<span class='co'>##                       How to run the code</span>
<span class='co'>## *************************************************************************************</span>

<span class='co'>## Either type example("example3") to run ALL the examples succesively</span>
<span class='co'>## or copy and paste examples sucessively, as required</span>

<span class='co'>## *************************************************************************************</span>
<span class='co'>##                  Options and required packages</span>
<span class='co'>## *************************************************************************************</span>

<span class='fu'>require</span>(<span class='no'>lmerTest</span>)
<span class='fu'>require</span>(<span class='no'>lattice</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: lattice</span></div><div class='input'><span class='fu'>require</span>(<span class='no'>pbkrtest</span>)
<span class='fu'>options</span>(<span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>'contr.treatment'</span>, <span class='st'>'contr.poly'</span>))

<span class='co'>## *************************************************************************************</span>
<span class='co'>##            Section 1: Polynomial powers of N and W</span>
<span class='co'>## *************************************************************************************</span>

<span class='no'>greenrice</span>$<span class='no'>loguptake</span> <span class='kw'>=</span> <span class='fu'>log</span>(<span class='no'>greenrice</span>$<span class='no'>uptake</span>)
<span class='no'>greenrice</span>$<span class='no'>Nitrogen</span> <span class='kw'>=</span> <span class='fu'>factor</span>(<span class='no'>greenrice</span>$<span class='no'>N</span>)
<span class='no'>greenrice</span>$<span class='no'>Water</span> <span class='kw'>=</span> <span class='fu'>factor</span>(<span class='no'>greenrice</span>$<span class='no'>W</span>)
<span class='no'>PolW</span> <span class='kw'>=</span> <span class='fu'>poly</span>((<span class='no'>greenrice</span>$<span class='no'>W</span>/<span class='fl'>10</span>), <span class='kw'>degree</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>colnames</span>(<span class='no'>PolW</span>) <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Linear_W"</span>, <span class='st'>"Quadratic_W"</span>)
<span class='no'>PolN</span> <span class='kw'>=</span> <span class='fu'>poly</span>((<span class='no'>greenrice</span>$<span class='no'>N</span>/<span class='fl'>100</span>), <span class='kw'>degree</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>colnames</span>(<span class='no'>PolN</span>) <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Linear_N"</span>, <span class='st'>"Quadratic_N"</span>)
<span class='no'>greenrice</span> <span class='kw'>=</span> <span class='fu'>cbind</span>(<span class='no'>greenrice</span>, <span class='no'>PolW</span>, <span class='no'>PolN</span>)

<span class='co'>## residual plot of untransformed N uptake data</span>
<span class='no'>greenrice.uptake</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>uptake</span> ~ <span class='no'>Replicate</span> + <span class='fu'>factor</span>(<span class='no'>N</span>) * <span class='fu'>factor</span>(<span class='no'>W</span>) +
 (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>)
<span class='fu'>plot</span>(<span class='no'>greenrice.uptake</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Pearson residual plot for untransformed N uptake"</span>,
 <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Residuals N uptake"</span>)</div><div class='img'><img src='example3-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## residual plot of log transformed N uptake data</span>
<span class='no'>greenrice.loguptake</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>loguptake</span> ~ <span class='no'>Replicate</span> + <span class='fu'>factor</span>(<span class='no'>N</span>) * <span class='fu'>factor</span>(<span class='no'>W</span>) +
 (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>)
<span class='fu'>plot</span>(<span class='no'>greenrice.loguptake</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Pearson residual plot for log transformed N uptake"</span>,
 <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Residuals log N uptake"</span>)</div><div class='img'><img src='example3-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Table 9: first-order model of log uptake with Wald tests</span>
<span class='no'>greenrice.lmer1</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>loguptake</span> ~ <span class='no'>Linear_N</span> + <span class='no'>Linear_W</span> + <span class='no'>Nitrogen</span> * <span class='no'>Water</span> +
 (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>)</div><div class='output co'>#&gt; <span class='message'>fixed-effect model matrix is rank deficient so dropping 2 columns / coefficients</span></div><div class='input'><span class='fu'>anova</span>(<span class='no'>greenrice.lmer1</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt; Type I Analysis of Variance Table with Kenward-Roger's method
#&gt;                 Sum Sq Mean Sq NumDF DenDF   F value    Pr(&gt;F)    
#&gt; Linear_N        4.6529  4.6529     1    36  183.8071 1.033e-15 ***
#&gt; Linear_W       25.5240 25.5240     1     9 1008.2989 1.496e-10 ***
#&gt; Nitrogen        0.6297  0.3148     2    36   12.4375 7.826e-05 ***
#&gt; Water           2.7392  1.3696     2     9   54.1047 9.633e-06 ***
#&gt; Nitrogen:Water  1.3181  0.1465     9    36    5.7856 5.878e-05 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>## Table 10: second-order model of log uptake with Wald tests</span>
<span class='no'>greenrice.lmer2</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>loguptake</span> ~ <span class='no'>Linear_N</span> * <span class='no'>Linear_W</span> + <span class='no'>Quadratic_N</span> + <span class='no'>Quadratic_W</span> +
 <span class='no'>Nitrogen</span> * <span class='no'>Water</span> + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>)</div><div class='output co'>#&gt; <span class='message'>fixed-effect model matrix is rank deficient so dropping 5 columns / coefficients</span></div><div class='input'><span class='fu'>anova</span>(<span class='no'>greenrice.lmer2</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt; Type I Analysis of Variance Table with Kenward-Roger's method
#&gt;                    Sum Sq Mean Sq NumDF DenDF   F value    Pr(&gt;F)    
#&gt; Linear_N           4.6529  4.6529     1    36  183.8071 1.033e-15 ***
#&gt; Linear_W          25.5240 25.5240     1     9 1008.2989 1.496e-10 ***
#&gt; Quadratic_N        0.3695  0.3695     1    36   14.5956 0.0005074 ***
#&gt; Quadratic_W        2.7061  2.7061     1     9  106.9031 2.708e-06 ***
#&gt; Nitrogen           0.2602  0.2602     1    36   10.2793 0.0028202 ** 
#&gt; Water              0.0331  0.0331     1     9    1.3062 0.2825677    
#&gt; Linear_N:Linear_W  1.1667  1.1667     1    36   46.0909 6.219e-08 ***
#&gt; Nitrogen:Water     0.1514  0.0189     8    36    0.7474 0.6498072    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>## *************************************************************************************
##         Section 2 : Fitted regression models and quadratic log uptake curves
## *************************************************************************************
</div><div class='input'><span class='co'>## Regression coefficients of quadratic response model of W and N</span>
<span class='no'>greenrice.lmer0</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lmerTest/topics/lmer'>lmer</a></span>(<span class='no'>loguptake</span> ~ <span class='no'>Linear_N</span> * <span class='no'>Linear_W</span> + <span class='no'>Quadratic_N</span> +
 <span class='no'>Quadratic_W</span> + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>) + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>Replicate</span>:<span class='no'>Main</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>)
<span class='fu'>summary</span>(<span class='no'>greenrice.lmer0</span>, <span class='kw'>ddf</span> <span class='kw'>=</span> <span class='st'>"Kenward-Roger"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: additional arguments ignored</span></div><div class='output co'>#&gt; Linear mixed model fit by REML. t-tests use Kenward-Roger's method [
#&gt; lmerModLmerTest]
#&gt; Formula: loguptake ~ Linear_N * Linear_W + Quadratic_N + Quadratic_W +  
#&gt;     (1 | Replicate) + (1 | Replicate:Main)
#&gt;    Data: greenrice
#&gt; 
#&gt; REML criterion at convergence: -13.7
#&gt; 
#&gt; Scaled residuals: 
#&gt;      Min       1Q   Median       3Q      Max 
#&gt; -2.26402 -0.54435  0.02556  0.69423  2.14818 
#&gt; 
#&gt; Random effects:
#&gt;  Groups         Name        Variance  Std.Dev.
#&gt;  Replicate:Main (Intercept) 0.000e+00 0.000000
#&gt;  Replicate      (Intercept) 8.815e-05 0.009389
#&gt;  Residual                   2.880e-02 0.169693
#&gt; Number of obs: 64, groups:  Replicate:Main, 16; Replicate, 4
#&gt; 
#&gt; Fixed effects:
#&gt;                   Estimate Std. Error       df t value Pr(&gt;|t|)    
#&gt; (Intercept)       -1.16000    0.06378 47.80633 -18.187  &lt; 2e-16 ***
#&gt; Linear_N           0.68000    0.07788 45.00000   8.731 3.05e-11 ***
#&gt; Linear_W           0.17603    0.05507 12.91860   3.196 0.007067 ** 
#&gt; Quadratic_N       -0.09380    0.02619 45.00000  -3.582 0.000833 ***
#&gt; Quadratic_W       -0.11599    0.01196 10.00000  -9.694 2.11e-06 ***
#&gt; Linear_N:Linear_W -0.09072    0.01425 45.00000  -6.365 8.94e-08 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Correlation of Fixed Effects:
#&gt;             (Intr) Linr_N Linr_W Qdrt_N Qdrt_W
#&gt; Linear_N    -0.592                            
#&gt; Linear_W    -0.625  0.112                     
#&gt; Quadratic_N  0.333 -0.908  0.000              
#&gt; Quadratic_W  0.375  0.000 -0.900  0.000       
#&gt; Lnr_N:Lnr_W  0.528 -0.320 -0.349  0.000  0.000</div><div class='input'>
<span class='co'>## Fig 4a fitted quadratic loguptake curve versus water stress treatments</span>
<span class='no'>panel.plot</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>y</span>) {
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.xyplot'>panel.xyplot</a></span>(<span class='no'>x</span>, <span class='no'>y</span>) <span class='co'># shows observed points</span>
<span class='no'>Nitrogen</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>.90</span>, <span class='fl'>1.80</span>, <span class='fl'>2.70</span>)[<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.number'>panel.number</a></span>()]
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.functions'>panel.curve</a></span>(-<span class='fl'>1.16</span> + <span class='fl'>0.17603</span> * <span class='no'>x</span> - <span class='fl'>0.11599</span> * <span class='no'>x</span> * <span class='no'>x</span> + <span class='fl'>0.68</span> * <span class='no'>Nitrogen</span> -
 <span class='fl'>0.0938</span> * <span class='no'>Nitrogen</span> * <span class='no'>Nitrogen</span> - <span class='fl'>0.09072</span> * <span class='no'>x</span> * <span class='no'>Nitrogen</span>,
<span class='kw'>from</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>to</span> <span class='kw'>=</span> <span class='fl'>4.0</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>)
}
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/xyplot'>xyplot</a></span>(<span class='no'>loguptake</span> ~ <span class='no'>Linear_W</span><span class='kw'>|</span><span class='fu'>factor</span>(<span class='no'>Linear_N</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>,
 <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>at</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>4</span>), <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>40</span>))),
 <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Fig 4a: logN uptake versus water stress"</span>,
 <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>" Water stress (days)"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Log nitrogen uptake (g/pot)"</span>,
 <span class='kw'>strip</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/strip.default'>strip.custom</a></span>(<span class='kw'>strip.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
 <span class='kw'>factor.levels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"0"</span>, <span class='st'>"90"</span>, <span class='st'>"180"</span>, <span class='st'>"270"</span>)),
<span class='kw'>panel</span> <span class='kw'>=</span> <span class='no'>panel.plot</span>)</div><div class='img'><img src='example3-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Fig 4b fitted quadratic quadratic loguptake curve versus nitrogen rate treatments</span>
<span class='no'>panel.plot</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>y</span>) {
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.xyplot'>panel.xyplot</a></span>(<span class='no'>x</span>, <span class='no'>y</span>) <span class='co'># shows observed points</span>
<span class='no'>Water</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1.0</span>, <span class='fl'>2.0</span>, <span class='fl'>4.0</span>)[<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.number'>panel.number</a></span>()]
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.functions'>panel.curve</a></span>( -<span class='fl'>1.16</span> + <span class='fl'>0.17603</span> * <span class='no'>Water</span> - <span class='fl'>0.11599</span> * <span class='no'>Water</span> * <span class='no'>Water</span> +
 <span class='fl'>0.68</span> * <span class='no'>x</span> - <span class='fl'>0.0938</span> * <span class='no'>x</span> * <span class='no'>x</span> - <span class='fl'>0.09072</span> * <span class='no'>Water</span> * <span class='no'>x</span> ,
<span class='kw'>from</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>to</span> <span class='kw'>=</span> <span class='fl'>2.70</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>)
}
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/xyplot'>xyplot</a></span>(<span class='no'>loguptake</span> ~ <span class='no'>Linear_N</span><span class='kw'>|</span><span class='fu'>factor</span>(<span class='no'>Linear_W</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>,
 <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>at</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>.9</span>, <span class='fl'>1.8</span>, <span class='fl'>2.7</span>), <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>90</span>, <span class='fl'>180</span>, <span class='fl'>270</span>))),
 <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Fig 4b: logN uptake versus nitrogen rate"</span>,
 <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Nitrogen (kg/ha)"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Log nitrogen uptake (g/pot)"</span>,
 <span class='kw'>strip</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/strip.default'>strip.custom</a></span>(<span class='kw'>strip.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
 <span class='kw'>factor.levels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"0"</span>, <span class='st'>"10"</span>, <span class='st'>"20"</span>, <span class='st'>"40"</span>)),
<span class='kw'>panel</span> <span class='kw'>=</span> <span class='no'>panel.plot</span>)</div><div class='img'><img src='example3-4.png' alt='' width='700' height='433' /></div><div class='input'>


<span class='co'>## Fig 4a backtransformed quadratic loguptake curve versus water stress treatments</span>
<span class='no'>panel.plot</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>y</span>) {
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.xyplot'>panel.xyplot</a></span>(<span class='no'>x</span>, <span class='no'>y</span>) <span class='co'># shows observed points</span>
<span class='no'>Nitrogen</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>.90</span>, <span class='fl'>1.80</span>, <span class='fl'>2.70</span>)[<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.number'>panel.number</a></span>()]
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.functions'>panel.curve</a></span>( <span class='fu'>exp</span>(-<span class='fl'>1.16</span> + <span class='fl'>0.17603</span> * <span class='no'>x</span> - <span class='fl'>0.11599</span> * <span class='no'>x</span> * <span class='no'>x</span> + <span class='fl'>0.68</span> * <span class='no'>Nitrogen</span> -
 <span class='fl'>0.0938</span> * <span class='no'>Nitrogen</span> * <span class='no'>Nitrogen</span> - <span class='fl'>0.09072</span> * <span class='no'>x</span> * <span class='no'>Nitrogen</span>),
<span class='kw'>from</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>to</span> <span class='kw'>=</span> <span class='fl'>4.0</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>)
}

<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/xyplot'>xyplot</a></span>(<span class='no'>uptake</span> ~ <span class='no'>Linear_W</span><span class='kw'>|</span><span class='fu'>factor</span>(<span class='no'>Linear_N</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>,
 <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>at</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>4</span>), <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>40</span>))),
 <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Fig 4a: Back transformed N uptake versus water stress"</span>,
 <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>" Water stress (days)"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Nitrogen uptake (g/pot)"</span>,
 <span class='kw'>strip</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/strip.default'>strip.custom</a></span>(<span class='kw'>strip.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
 <span class='kw'>factor.levels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"0"</span>, <span class='st'>"90"</span>, <span class='st'>"180"</span>, <span class='st'>"270"</span>)),
<span class='kw'>panel</span> <span class='kw'>=</span> <span class='no'>panel.plot</span>)</div><div class='img'><img src='example3-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Fig 4b back transformed quadratic loguptake curve versus nitrogen rate treatments</span>
<span class='no'>panel.plot</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>y</span>) {
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.xyplot'>panel.xyplot</a></span>(<span class='no'>x</span>, <span class='no'>y</span>) <span class='co'># shows observed points</span>
<span class='no'>Water</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1.0</span>, <span class='fl'>2.0</span>, <span class='fl'>4.0</span>)[<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.number'>panel.number</a></span>()]
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/panel.functions'>panel.curve</a></span>(<span class='fu'>exp</span>(-<span class='fl'>1.16</span> + <span class='fl'>0.17603</span> * <span class='no'>Water</span> - <span class='fl'>0.11599</span> * <span class='no'>Water</span> * <span class='no'>Water</span> +
 <span class='fl'>0.68</span> * <span class='no'>x</span> - <span class='fl'>0.0938</span> * <span class='no'>x</span> * <span class='no'>x</span> - <span class='fl'>0.09072</span> * <span class='no'>Water</span> * <span class='no'>x</span>),
<span class='kw'>from</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>to</span> <span class='kw'>=</span> <span class='fl'>2.70</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>)
}
<span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/xyplot'>xyplot</a></span>(<span class='no'>uptake</span> ~ <span class='no'>Linear_N</span><span class='kw'>|</span><span class='fu'>factor</span>(<span class='no'>Linear_W</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>greenrice</span>,
 <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>at</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>.9</span>, <span class='fl'>1.8</span>, <span class='fl'>2.7</span>), <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>90</span>, <span class='fl'>180</span>, <span class='fl'>270</span>))),
 <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Fig 4b: Back transformed N uptake versus nitrogen rate"</span>,
 <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Nitrogen (kg/ha)"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Nitrogen uptake (g/pot)"</span>,
 <span class='kw'>strip</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lattice/topics/strip.default'>strip.custom</a></span>(<span class='kw'>strip.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
 <span class='kw'>factor.levels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"0"</span>, <span class='st'>"10"</span>, <span class='st'>"20"</span>, <span class='st'>"40"</span>)),
<span class='kw'>panel</span> <span class='kw'>=</span> <span class='no'>panel.plot</span>)</div><div class='img'><img src='example3-6.png' alt='' width='700' height='433' /></div><div class='input'>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Rodney Edmondson, Hans-Peter Piepho, Muhammad Yaseen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

