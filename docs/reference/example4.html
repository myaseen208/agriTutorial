<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Example 4: One qualitative treatment factor with repeated measurements over time. — example4 • agriTutorial</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Example 4: One qualitative treatment factor with repeated measurements over time. — example4" />

<meta property="og:description" content="Milliken &amp;amp; Johnson (1992, p. 429) discuss data which they describe as repeated leaf index measurements
on sorghum. Their data set comprises five replicate blocks of four sorghum varieties and they assume equally spaced
repeated measurements on each plot in each block on five consecutive occasions starting two weeks after emergence.
No further information is given but it appears that the data is simulated or made-up rather than real.
Although real data is more authentic, it can sometimes be useful to discuss the analysis of an example data set
from the literature, even when the data is simulated. Milliken &amp;amp; Johnson discuss multivariate analysis
of variance of the data but this method take no account of the ordered relationship between repeated
observations or the likely correlation structure of the data and we will discuss alternative correlation models
that are specifically intended to account for the underlying structure of repeated measures data. The interested
reader can, if desired, refer to Milliken &amp;amp; Johnson (1992) Chapter 31 for comparison of the
different approaches." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agriTutorial</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Example 4: One qualitative treatment factor with repeated measurements over time.</h1>
    
    <div class="hidden name"><code>example4.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Milliken &amp; Johnson (1992, p. 429) discuss data which they describe as repeated leaf index measurements
on sorghum. Their data set comprises five replicate blocks of four sorghum varieties and they assume equally spaced
repeated measurements on each plot in each block on five consecutive occasions starting two weeks after emergence.
No further information is given but it appears that the data is simulated or made-up rather than real.
Although real data is more authentic, it can sometimes be useful to discuss the analysis of an example data set
from the literature, even when the data is simulated. Milliken &amp; Johnson discuss multivariate analysis
of variance of the data but this method take no account of the ordered relationship between repeated
observations or the likely correlation structure of the data and we will discuss alternative correlation models
that are specifically intended to account for the underlying structure of repeated measures data. The interested
reader can, if desired, refer to Milliken &amp; Johnson (1992) Chapter 31 for comparison of the
different approaches.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>Section 1</strong> calculates polynomials for weeks and blocks using the <code>poly()</code> function.
Two sets of polynomials for weeks, raw and orthogonal, are calculated and saved as <code>sorghum$rawWeeks</code>
and <code>sorghum$polWeeks</code> respectively. Orthogonal polynomials for blocks are calculated and saved as
<code>sorghum$polBlocks</code>. It is important to note that the <code>poly()</code> function calculates all polynomial
contrasts up to the required degree but does NOT include the zero-degree polynomial.
Additionally, the block variable <code>varblock</code> is saved as a factor <code>factblock</code>.</p>
<p><strong>Section 2</strong> compares five different correlation structures for the repeated measures analysis
using the gls() function of the nlme package. Each analysis fits a full factorial model for the variety-by-weeks and
blocks-by-weeks effects assuming block and treatment additivity. The goodness of fit of the five models is
compared by AIC statistics where the smaller the AIC the better the fit. Here, the AR(1)+nugget model fitted
by the <code><a href='http://www.rdocumentation.org/packages/nlme/topics/corExp'>corExp()</a></code> function gave the best fitting model. See <code>help(corExp)</code>for further information about
the corExp() function. Note that <code>corSymm</code> represents a general correlation structure and will, presumably, give
an analysis similar to a multivariate analysis of variance. Although this structure appears to give the best fit according to the
negative log likelihood statistic, this
criterion takes no account of the number of estimated variance parameters p in the variance model which, in the case of the
<code>corSymm</code> model, is p = 15, compared to only p = 2 for the AR(1) model. When assessed by the AIC statistic, the
<code>corSymm</code> model gave the least good fit of any of the non-null correlation structures which is strong evidence that the
multivariate analysis of variance method discussed by Milliken &amp; Johnson (1992) will lack power.</p>
<p><strong>Section 3</strong> fits a full regression model over the five weeks of repeated measures and tests for possible
variety and variety-by-weeks interactions effects. The weeks factor is decomposed into individual
polynomial contrasts (see Table A2 and Table 14) to test the significance of each individual variety-by-weeks polynomial
 effect.
The analysis of polynomial contrasts shows that the variety-by-weeks interaction is due mainly to the
degree-1 = <code>variety:rawWeeks[,1]</code> and the
degree-2 = <code>variety:rawWeeks[,2]</code> effects, although there is also some evidence
of higher-degree variety-by-weeks interaction effects. The analysis also shows the <code><a href='http://www.rdocumentation.org/packages/nlme/topics/corExp'>corExp()</a></code> range and
nugget statistics for the full fitted model and these are used to calculate the correlation coefficient
usingthe formula <code>rho=(1-nugget)*exp(-1/range)</code>. Note that this formula is different from the the formula used in
Tables A1 and A2 and will give a different value of <code>rho</code>: see <code>help(corExp)</code>.</p>
<p><strong>Section 4</strong> fits a quadratic regression model for weeks assuming the degree-3 and degree-4 polynomial week effects are zero.
The average effects of blocks are fitted by <code>polBlocks</code> and the interactions between the blocks and the weeks are fitted
by <code>polBlocks:(rawWeeks[,1] + rawWeeks[,2] + polWeeks[,3]+ polWeeks[,4])</code>. The <code><a href='http://www.rdocumentation.org/packages/nlme/topics/gls'>gls()</a></code> algorithm requires the same
polynomial weeks contrasts in both the blocks and the varieties models which is why raw degree-1 and degree-2 weeks contrasts have been
used for the blocks-by-weeks interaction model. However, orthogonal polynomials have better numerical stability than raw polynomials so
 orthogonal polynomial contrasts have been used for the degree-3 and degree-4 weeks contrasts.
The summary analysis shows all variety effects as differences from
the intercept which, in this analysis, is variety 1 therefore all model effects in Table 15 can be derived by
adding appropriate effects to the intercept. If SED's are required, these must be calculated from the
variance/covariance matrix which can be extracted by the code <code>vcov()</code>. Using this matrix, the SED for variety differences was
calculated to be 0.172, the SED for the variety-by-linear weeks slope parameters was calculated to be 0.117 and the SED
for the variety-by-quadratic weeks slope parameters was calculated to be 0.0192. These estimates are approximately 2-3 percent
larger than those shown in Table 15 but it is not clear if the discrepancies are due to the model specification or to a
difference between the R and the SAS software. Possibly the implementation of the Kenward-Roger method of adjusting
the denominator d.f. and the estimated variance-covariance matrix of the estimated fixed effects might be different for the two
algorithms. The range, nugget and correlation coefficient are extracted and displayed and a
graphical plot of the studentized residuals from the quadratic regression model is also shown.</p>
<p><strong>Section 5</strong> fits a quadratic regression model for variety-by-week interaction effects assuming
a full degree-4 polynomial model for weeks and blocks-by-weeks effects.
The quadratic regression model in Section 4 corresponds to the regression model used for Tables 14 and 15 of Piepho and Edmondson (2018)
but the range = 3397131013 and nugget = 0.4605535 of this model are very different from the range = 10.35774 and nugget = 0.1720444 of the
full factorial model. As there is  evidence from Table A2 that the degree-3 and degree-4 polynomial
weeks effects are non-negligible, the quadratic model for weeks effects in Section 4 may be inadequate for the data and the model
may be underfitted. In this section, the assumption that the degree-3 and degree-4 polynomial weeks effects are zero is relaxed and
a full degree-4 model for weeks and block-by-weeks interaction effects is fitted. The fitted model for treatment effects needs to be
 as parsimonious as possible to ensure that estimates
of treatment effects are robust against model assumptions and a degree-2 regression model for variety-by-weeks effects
appears to be the most appropriate treatment model for this data. With this model, the values of the auto-correlation parameters
 are: range = 42.75763, nugget = 0.3586337 and
correlation = 0.6265403 which are much closer to the autocorrelation parameters from the full factorial model than are those from
Section 4. As the model fits the full polynomial weeks model, it is not necessary to use polynomial blocks contrasts which gives a substantial
simplification in coding.</p>
<p><strong>Comment</strong> The model fitted in Section 5 appears to be the best model available based on the generalized least squares method but
 it is clear from the graphical plots of studentized residuals that the fitted data contains outliers that are not
well accommodated by the fitted model. If the data was from a real experiment, further information about the data might be available but as the data
seems to be artificial this option is not available. In this situation, various robust methods of model fitting or regression analysis
that can accommodate non-standard distributions or model outliers are available. However, these methods are beyond the scope of
this tutorial and will not be discussed further here.</p>
<p><code><a href='agriTutorial.html'>agriTutorial</a></code>: return to home page if you want to select a different example <br /></p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <ol>
<li><p>Milliken, G., &amp; Johnson, D. (1992). <em>Analysis of Messy Data. Volume I: Designed Experiments</em>. CRC Press.</p></li>
<li><p>Kenward, M. G., &amp; Roger, J. H. (1997). Small sample inference for fixed effects from restricted maximum likelihood. <em>Biometrics</em>,  <strong>53</strong>, 983–997.</p></li>
<li><p>Piepho, H., &amp; Edmondson, R. (2018). A tutorial on the Statistical Analysis of Factorial Experiments with Qualitative and Quantitative treatment factor levels. 
               <em>Journal of Agronomy and Crop Science.</em> (<a href='https://onlinelibrary.wiley.com/doi/full/10.1111/jac.12267'>https://onlinelibrary.wiley.com/doi/full/10.1111/jac.12267</a>).</p></li>
</ol>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>broom</span>)
<span class='fu'>library</span>(<span class='no'>broom.mixed</span>)
<span class='fu'>library</span>(<span class='no'>dplyr</span>)
<span class='fu'>library</span>(<span class='no'>emmeans</span>)
<span class='fu'>library</span>(<span class='no'>ggfortify</span>)
<span class='fu'>library</span>(<span class='no'>ggplot2</span>)
<span class='fu'>library</span>(<span class='no'>lmerTest</span>)
<span class='fu'>library</span>(<span class='no'>magrittr</span>)
<span class='fu'>library</span>(<span class='no'>nlme</span>)
<span class='fu'>library</span>(<span class='no'>pbkrtest</span>)

<span class='fu'>options</span>(<span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>'contr.treatment'</span>, <span class='st'>'contr.poly'</span>))

<span class='co'>##---------sorghumData-------</span>
<span class='no'>sorghum</span>$<span class='no'>factblock</span> <span class='kw'>&lt;-</span> <span class='fu'>factor</span>(<span class='no'>sorghum</span>$<span class='no'>varblock</span>)
<span class='no'>sorghum</span>$<span class='no'>rawWeeks</span>  <span class='kw'>&lt;-</span> <span class='fu'>poly</span>(<span class='no'>sorghum</span>$<span class='no'>varweek</span>, <span class='kw'>degree</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>sorghum</span>$<span class='no'>polWeeks</span>  <span class='kw'>&lt;-</span> <span class='fu'>poly</span>(<span class='no'>sorghum</span>$<span class='no'>varweek</span>, <span class='kw'>degree</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='no'>sorghum</span>$<span class='no'>polBlocks</span> <span class='kw'>&lt;-</span> <span class='fu'>poly</span>(<span class='no'>sorghum</span>$<span class='no'>varblock</span>, <span class='kw'>degree</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>raw</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'>##-------fm4.1-------</span>
<span class='co'>## independent uncorrelated random plots</span>
<span class='no'>fm4.1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/gls'>gls</a></span>(<span class='no'>y</span> ~ <span class='no'>factweek</span> * (<span class='no'>Replicate</span> + <span class='no'>variety</span>), <span class='no'>sorghum</span>)
<span class='no'>fm4.1.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm4.1</span>)
<span class='no'>fm4.1.glance</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/glance'>glance</a></span>(<span class='no'>fm4.1</span>)
<span class='no'>fm4.1.Variogram</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/Variogram'>Variogram</a></span>(<span class='no'>fm4.1</span>)

<span class='co'>##----fm4.1.ANOVA----</span>
 <span class='no'>fm4.1.ANOVA</span></div><div class='output co'>#&gt; Denom. DF: 60 
#&gt;                    numDF  F-value p-value
#&gt; (Intercept)            1 80947.08  &lt;.0001
#&gt; factweek               4   220.90  &lt;.0001
#&gt; Replicate              4   358.86  &lt;.0001
#&gt; variety                3   334.87  &lt;.0001
#&gt; factweek:Replicate    16     1.82  0.0495
#&gt; factweek:variety      12     4.48  &lt;.0001</div><div class='input'>
<span class='co'>##----fm4.1.glance----</span>
 <span class='no'>fm4.1.glance</span></div><div class='output co'>#&gt; # A tibble: 1 x 6
#&gt;   sigma    df logLik   AIC   BIC df.residual
#&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;int&gt;
#&gt; 1 0.152    40   1.87  78.3  164.          60</div><div class='input'>
<span class='co'>##----fm4.1.Variogram----</span>
<span class='no'>fm4.1.Variogram</span></div><div class='output co'>#&gt;       variog dist n.pairs
#&gt; 1  0.4844580    2     195
#&gt; 2  0.6952706    5     285
#&gt; 3  0.5949027    7     185
#&gt; 4  0.6395966   10     270
#&gt; 5  0.6253573   13     261
#&gt; 6  0.7140342   16     252
#&gt; 7  0.6430040   19     243
#&gt; 8  0.5396552   22     234
#&gt; 9  0.5933554   25     225
#&gt; 10 0.5017639   28     286
#&gt; 11 0.5515372   32     204
#&gt; 12 0.5603973   35     258
#&gt; 13 0.4864744   39     242
#&gt; 14 0.5010566   43     226
#&gt; 15 0.6216947   48     260
#&gt; 16 0.7288533   53     235
#&gt; 17 0.5576019   58     249
#&gt; 18 0.7579793   65     276
#&gt; 19 1.0266935   74     234
#&gt; 20 0.3877214   85     231</div><div class='input'>
<span class='co'>##-------fm4.2-------</span>
<span class='co'>## corCompSymm compound symmetry</span>
<span class='no'>fm4.2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/gls'>gls</a></span>(<span class='no'>y</span> ~ <span class='no'>factweek</span> * (<span class='no'>Replicate</span> + <span class='no'>variety</span>),
                   <span class='kw'>corr</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/corCompSymm'>corCompSymm</a></span>(<span class='kw'>form</span> <span class='kw'>=</span> ~ <span class='no'>varweek</span><span class='kw'>|</span><span class='no'>factplot</span>), <span class='no'>sorghum</span>)
<span class='no'>fm4.2.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm4.2</span>)
<span class='no'>fm4.2.glance</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/glance'>glance</a></span>(<span class='no'>fm4.2</span>)
<span class='no'>fm4.2.Variogram</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/Variogram'>Variogram</a></span>(<span class='no'>fm4.2</span>)

<span class='co'>##----fm4.2.ANOVA----</span>
 <span class='no'>fm4.2.ANOVA</span></div><div class='output co'>#&gt; Denom. DF: 60 
#&gt;                    numDF   F-value p-value
#&gt; (Intercept)            1 21284.930  &lt;.0001
#&gt; factweek               4   738.198  &lt;.0001
#&gt; Replicate              4    94.361  &lt;.0001
#&gt; variety                3    88.053  &lt;.0001
#&gt; factweek:Replicate    16     6.077  &lt;.0001
#&gt; factweek:variety      12    14.975  &lt;.0001</div><div class='input'>
<span class='co'>##----fm4.2.glance----</span>
 <span class='no'>fm4.2.glance</span></div><div class='output co'>#&gt; # A tibble: 1 x 6
#&gt;   sigma    df logLik   AIC   BIC df.residual
#&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;int&gt;
#&gt; 1 0.152    40   22.8  38.4  126.          60</div><div class='input'>
<span class='co'>##----fm4.2.Variogram----</span>
 <span class='no'>fm4.2.Variogram</span></div><div class='output co'>#&gt;      variog dist n.pairs
#&gt; 1 0.1458280    1      80
#&gt; 2 0.1805148    2      60
#&gt; 3 0.2136222    3      40
#&gt; 4 0.2433676    4      20</div><div class='input'>
<span class='co'>##-------fm4.3-------</span>
<span class='co'>## corExp without nugget</span>
<span class='no'>fm4.3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/gls'>gls</a></span>(<span class='no'>y</span> ~ <span class='no'>factweek</span> * (<span class='no'>Replicate</span> + <span class='no'>variety</span>),
                   <span class='kw'>corr</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/corExp'>corExp</a></span>(<span class='kw'>form</span> <span class='kw'>=</span> ~ <span class='no'>varweek</span><span class='kw'>|</span><span class='no'>factplot</span>), <span class='no'>sorghum</span>)
<span class='no'>fm4.3.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm4.3</span>)
<span class='no'>fm4.3.glance</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/glance'>glance</a></span>(<span class='no'>fm4.3</span>)
<span class='no'>fm4.3.Variogram</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/Variogram'>Variogram</a></span>(<span class='no'>fm4.3</span>)

<span class='co'>##----fm4.3.ANOVA----</span>
 <span class='no'>fm4.3.ANOVA</span></div><div class='output co'>#&gt; Denom. DF: 60 
#&gt;                    numDF   F-value p-value
#&gt; (Intercept)            1 26108.428  &lt;.0001
#&gt; factweek               4   272.514  &lt;.0001
#&gt; Replicate              4   112.786  &lt;.0001
#&gt; variety                3   102.241  &lt;.0001
#&gt; factweek:Replicate    16     3.206   5e-04
#&gt; factweek:variety      12    10.297  &lt;.0001</div><div class='input'>
<span class='co'>##----fm4.3.glance----</span>
 <span class='no'>fm4.3.glance</span></div><div class='output co'>#&gt; # A tibble: 1 x 6
#&gt;   sigma    df logLik   AIC   BIC df.residual
#&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;int&gt;
#&gt; 1 0.149    40   23.0  38.0  126.          60</div><div class='input'>
<span class='co'>##----fm4.3.Variogram----</span>
 <span class='no'>fm4.3.Variogram</span></div><div class='output co'>#&gt;      variog dist n.pairs
#&gt; 1 0.1525443    1      80
#&gt; 2 0.1888286    2      60
#&gt; 3 0.2234608    3      40
#&gt; 4 0.2545762    4      20</div><div class='input'>
<span class='co'>##-------fm4.4-------</span>
<span class='co'>##  corExp with nugget</span>
<span class='no'>fm4.4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/gls'>gls</a></span>(<span class='no'>y</span> ~ <span class='no'>factweek</span> * (<span class='no'>Replicate</span> + <span class='no'>variety</span>),
                   <span class='kw'>corr</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/corExp'>corExp</a></span>(<span class='kw'>form</span> <span class='kw'>=</span> ~ <span class='no'>varweek</span><span class='kw'>|</span><span class='no'>factplot</span>, <span class='kw'>nugget</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='no'>sorghum</span>)
<span class='no'>fm4.4.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm4.4</span>)
<span class='no'>fm4.4.glance</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/glance'>glance</a></span>(<span class='no'>fm4.4</span>)
<span class='no'>fm4.4.Variogram</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/Variogram'>Variogram</a></span>(<span class='no'>fm4.4</span>)

<span class='co'>##----fm4.4.ANOVA----</span>
 <span class='no'>fm4.4.ANOVA</span></div><div class='output co'>#&gt; Denom. DF: 60 
#&gt;                    numDF   F-value p-value
#&gt; (Intercept)            1 22278.120  &lt;.0001
#&gt; factweek               4   447.078  &lt;.0001
#&gt; Replicate              4    97.680  &lt;.0001
#&gt; variety                3    88.735  &lt;.0001
#&gt; factweek:Replicate    16     4.220  &lt;.0001
#&gt; factweek:variety      12    12.578  &lt;.0001</div><div class='input'>

<span class='co'>##----fm4.4.glance----</span>
 <span class='no'>fm4.4.glance</span></div><div class='output co'>#&gt; # A tibble: 1 x 6
#&gt;   sigma    df logLik   AIC   BIC df.residual
#&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;int&gt;
#&gt; 1 0.150    40   24.3  37.5  128.          60</div><div class='input'>
<span class='co'>##----fm4.4.Variogram----</span>
 <span class='no'>fm4.4.Variogram</span></div><div class='output co'>#&gt;      variog dist n.pairs
#&gt; 1 0.1502717    1      80
#&gt; 2 0.1860155    2      60
#&gt; 3 0.2201317    3      40
#&gt; 4 0.2507836    4      20</div><div class='input'>

<span class='co'>##-------fm4.5-------</span>
<span class='co'>##  corSymm unstructured</span>
<span class='no'>fm4.5</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/gls'>gls</a></span>(<span class='no'>y</span> ~ <span class='no'>factweek</span> * (<span class='no'>Replicate</span> + <span class='no'>variety</span>),
                   <span class='kw'>corr</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/corSymm'>corSymm</a></span>(<span class='kw'>form</span> <span class='kw'>=</span> ~ <span class='fl'>1</span><span class='kw'>|</span><span class='no'>factplot</span>),
                   <span class='kw'>weights</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/varIdent'>varIdent</a></span>(<span class='kw'>form</span> <span class='kw'>=</span> ~ <span class='fl'>1</span><span class='kw'>|</span><span class='no'>varweek</span>), <span class='no'>sorghum</span>)
<span class='no'>fm4.5.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm4.5</span>)
<span class='no'>fm4.5.glance</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/glance'>glance</a></span>(<span class='no'>fm4.5</span>)
<span class='no'>fm4.5.Variogram</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/Variogram'>Variogram</a></span>(<span class='no'>fm4.5</span>)

<span class='co'>##----fm4.5.ANOVA----</span>
 <span class='no'>fm4.5.ANOVA</span></div><div class='output co'>#&gt; Denom. DF: 60 
#&gt;                    numDF  F-value p-value
#&gt; (Intercept)            1 57534.14  &lt;.0001
#&gt; factweek               4   594.16  &lt;.0001
#&gt; Replicate              4   217.57  &lt;.0001
#&gt; variety                3   144.72  &lt;.0001
#&gt; factweek:Replicate    16     4.04  &lt;.0001
#&gt; factweek:variety      12    12.18  &lt;.0001</div><div class='input'>
<span class='co'>##----fm4.5.glance----</span>
 <span class='no'>fm4.5.glance</span></div><div class='output co'>#&gt; # A tibble: 1 x 6
#&gt;   sigma    df logLik   AIC   BIC df.residual
#&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;int&gt;
#&gt; 1 0.141    40   31.5  47.1  162.          60</div><div class='input'>
<span class='co'>##----fm4.5.Variogram----</span>
 <span class='no'>fm4.5.Variogram</span></div><div class='output co'>#&gt;      variog dist n.pairs
#&gt; 1 0.1421985    1      80
#&gt; 2 0.1789136    2      60
#&gt; 3 0.2110624    3      40
#&gt; 4 0.2797197    4      20</div><div class='input'>
<span class='co'>##----Models.Summary----</span>
<span class='no'>Model</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"ID"</span>, <span class='st'>"CS"</span>, <span class='st'>"AR(1)"</span>, <span class='st'>"AR(1) + nugget"</span>, <span class='st'>"UN"</span>)
<span class='no'>Models.Summary</span> <span class='kw'>&lt;-</span>
  <span class='fu'>cbind</span>(<span class='no'>Model</span>,
        <span class='fu'>rbind</span>(
          <span class='no'>fm4.1.glance</span>
          , <span class='no'>fm4.2.glance</span>
          , <span class='no'>fm4.3.glance</span>
          , <span class='no'>fm4.3.glance</span>
          , <span class='no'>fm4.5.glance</span>
        ))


 <span class='no'>Models.Summary</span></div><div class='output co'>#&gt;            Model     sigma df    logLik      AIC      BIC df.residual
#&gt; 1             ID 0.1522361 40  1.869316 78.26137 164.1295          60
#&gt; 2             CS 0.1522361 40 22.810374 38.37925 126.3417          60
#&gt; 3          AR(1) 0.1488471 40 22.977679 38.04464 126.0071          60
#&gt; 4 AR(1) + nugget 0.1488471 40 22.977679 38.04464 126.0071          60
#&gt; 5             UN 0.1405318 40 31.451417 47.09717 162.2861          60</div><div class='input'>

<span class='co'>##----fm4.6----</span>
<span class='no'>fm4.6</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/gls'>gls</a></span>(
  <span class='no'>y</span> ~ (<span class='no'>factblock</span>+<span class='no'>variety</span>) * (<span class='no'>varweek</span> + <span class='fu'>I</span>(<span class='no'>varweek</span>^<span class='fl'>2</span>) + <span class='fu'>I</span>(<span class='no'>varweek</span>^<span class='fl'>3</span>) + <span class='fu'>I</span>(<span class='no'>varweek</span>^<span class='fl'>4</span>))
  , <span class='kw'>corr</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/corExp'>corExp</a></span>(<span class='kw'>form</span> <span class='kw'>=</span> ~ <span class='no'>varweek</span> <span class='kw'>|</span> <span class='no'>factplot</span>, <span class='kw'>nugget</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
  , <span class='no'>sorghum</span>)

<span class='no'>fm4.6.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm4.6</span>)
<span class='no'>fm4.6.Coef</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/tidy'>tidy</a></span>(<span class='no'>fm4.6</span>)
<span class='no'>fm4.6.vcov</span> <span class='kw'>&lt;-</span> <span class='fu'>vcov</span>(<span class='no'>fm4.6</span>)


<span class='no'>fm4.6.Par</span> <span class='kw'>&lt;-</span>
  <span class='kw pkg'>tibble</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/tibble/topics/tibble'>tibble</a></span>(
    <span class='st'>"Parameter"</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Range"</span>, <span class='st'>"Nugget"</span>, <span class='st'>"rho"</span>)
    , <span class='st'>"Value"</span>     <span class='kw'>=</span> <span class='fu'>c</span>(
      <span class='fu'>coef</span>(<span class='no'>fm4.6</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>1</span>]
      , <span class='fu'>coef</span>(<span class='no'>fm4.6</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>2</span>]
      , (<span class='fl'>1</span>-<span class='fu'>coef</span>(<span class='no'>fm4.6</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>2</span>])*
        <span class='fu'>exp</span>(-<span class='fl'>1</span>/<span class='fu'>coef</span>(<span class='no'>fm4.6</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>1</span>])
    )
  )

<span class='no'>fm4.6.ACF</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/ACF'>ACF</a></span>(<span class='no'>fm4.6</span>)

<span class='co'>##----fm4.6.ANOVA----</span>
 <span class='no'>fm4.6.ANOVA</span></div><div class='output co'>#&gt; Denom. DF: 60 
#&gt;                        numDF   F-value p-value
#&gt; (Intercept)                1 22278.120  &lt;.0001
#&gt; factblock                  4    97.680  &lt;.0001
#&gt; variety                    3    88.735  &lt;.0001
#&gt; varweek                    1  1687.507  &lt;.0001
#&gt; I(varweek^2)               1    62.675  &lt;.0001
#&gt; I(varweek^3)               1    18.088  0.0001
#&gt; I(varweek^4)               1    20.042  &lt;.0001
#&gt; factblock:varweek          4    12.449  &lt;.0001
#&gt; factblock:I(varweek^2)     4     1.694  0.1632
#&gt; factblock:I(varweek^3)     4     0.081  0.9878
#&gt; factblock:I(varweek^4)     4     2.654  0.0416
#&gt; variety:varweek            3    21.194  &lt;.0001
#&gt; variety:I(varweek^2)       3    16.621  &lt;.0001
#&gt; variety:I(varweek^3)       3     7.699  0.0002
#&gt; variety:I(varweek^4)       3     4.797  0.0046</div><div class='input'>
<span class='co'>##----fm4.6.Coef----</span>
 <span class='no'>fm4.6.Coef</span></div><div class='output co'>#&gt; # A tibble: 40 x 5
#&gt;    term         estimate std.error statistic    p.value
#&gt;    &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
#&gt;  1 (Intercept)     1.53      0.705     2.17  0.0339    
#&gt;  2 factblock2      0.652     0.788     0.828 0.411     
#&gt;  3 factblock3      0.950     0.788     1.21  0.233     
#&gt;  4 factblock4      0.725     0.788     0.920 0.361     
#&gt;  5 factblock5      0.423     0.788     0.536 0.594     
#&gt;  6 variety2        2.71      0.705     3.84  0.000296  
#&gt;  7 variety3        0.398     0.705     0.565 0.574     
#&gt;  8 variety4        3.20      0.705     4.55  0.0000269 
#&gt;  9 varweek         6.70      1.29      5.20  0.00000249
#&gt; 10 I(varweek^2)   -4.15      0.772    -5.37  0.00000134
#&gt; # ... with 30 more rows</div><div class='input'>
<span class='co'>##----fm4.6.Par----</span>
 <span class='no'>fm4.6.Par</span></div><div class='output co'>#&gt; # A tibble: 3 x 2
#&gt;   Parameter  Value
#&gt;   &lt;chr&gt;      &lt;dbl&gt;
#&gt; 1 Range     10.4  
#&gt; 2 Nugget     0.172
#&gt; 3 rho        0.752</div><div class='input'>
<span class='co'>##----fm4.6.Plot1----</span>
<span class='fu'>plot</span>(<span class='no'>fm4.6.ACF</span>)</div><div class='img'><img src='example4-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm4.6.Plot2----</span>
<span class='fu'>plot</span>(<span class='no'>fm4.6</span>, <span class='kw'>sub.caption</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Residuals from full polynomial weeks model"</span>)</div><div class='output co'>#&gt; <span class='error'>Error in (function (x, form = resid(., type = "pearson") ~ fitted(.),     abline, id = NULL, idLabels = NULL, idResType = c("pearson",         "normalized"), grid, ...) {    object &lt;- x    if (!inherits(form, "formula")) {        stop("'form' must be a formula")    }    allV &lt;- all.vars(asOneFormula(form, id, idLabels))    allV &lt;- allV[is.na(match(allV, c("T", "F", "TRUE", "FALSE")))]    if (length(allV) &gt; 0) {        data &lt;- getData(object)        if (is.null(data)) {            alist &lt;- lapply(as.list(allV), as.name)            names(alist) &lt;- allV            alist &lt;- c(list(quote(data.frame)), alist)            mode(alist) &lt;- "call"            data &lt;- eval(alist, sys.parent(1))        }        else {            if (any(naV &lt;- is.na(match(allV, names(data))))) {                stop(sprintf(ngettext(sum(naV), "%s not found in data",                   "%s not found in data"), allV[naV]), domain = NA)            }        }    }    else data &lt;- NULL    if (inherits(data, "groupedData")) {        ff &lt;- formula(data)        rF &lt;- deparse(getResponseFormula(ff)[[2]])        cF &lt;- c_deparse(getCovariateFormula(ff)[[2]])        lbs &lt;- attr(data, "labels")        unts &lt;- attr(data, "units")        if (!is.null(lbs$x))             cL &lt;- paste(lbs$x, unts$x)        else cF &lt;- NULL        if (!is.null(lbs$y))             rL &lt;- paste(lbs$y, unts$y)        else rF &lt;- NULL    }    else {        rF &lt;- cF &lt;- NULL    }    dots &lt;- list(...)    if (length(dots) &gt; 0)         args &lt;- dots    else args &lt;- list()    data &lt;- as.list(c(as.list(data), . = list(object)))    covF &lt;- getCovariateFormula(form)    .x &lt;- eval(covF[[2]], data)    if (!is.numeric(.x)) {        stop("covariate must be numeric")    }    argForm &lt;- ~.x    argData &lt;- data.frame(.x = .x, check.names = FALSE)    if (is.null(xlab &lt;- attr(.x, "label"))) {        xlab &lt;- deparse(covF[[2]])        if (!is.null(cF) &amp;&amp; (xlab == cF))             xlab &lt;- cL        else if (!is.null(rF) &amp;&amp; (xlab == rF))             xlab &lt;- rL    }    if (is.null(args$xlab))         args$xlab &lt;- xlab    respF &lt;- getResponseFormula(form)    if (!is.null(respF)) {        .y &lt;- eval(respF[[2]], data)        if (is.null(ylab &lt;- attr(.y, "label"))) {            ylab &lt;- deparse(respF[[2]])            if (!is.null(cF) &amp;&amp; (ylab == cF))                 ylab &lt;- cL            else if (!is.null(rF) &amp;&amp; (ylab == rF))                 ylab &lt;- rL        }        argForm &lt;- .y ~ .x        argData[, ".y"] &lt;- .y        if (is.null(args$ylab))             args$ylab &lt;- ylab    }    grpsF &lt;- getGroupsFormula(form)    if (!is.null(grpsF)) {        gr &lt;- splitFormula(grpsF, sep = "*")        for (i in seq_along(gr)) {            auxGr &lt;- all.vars(gr[[i]])            for (j in auxGr) {                argData[[j]] &lt;- eval(as.name(j), data)            }        }        if (length(argForm) == 2)             argForm &lt;- eval(parse(text = paste("~ .x |", deparse(grpsF[[2]]))))        else argForm &lt;- eval(parse(text = paste(".y ~ .x |",             deparse(grpsF[[2]]))))    }    args &lt;- c(list(argForm, data = argData), args)    if (is.null(args$cex))         args$cex &lt;- par("cex")    if (is.null(args$adj))         args$adj &lt;- par("adj")    if (!is.null(id)) {        idResType &lt;- match.arg(idResType)        id &lt;- switch(mode(id), numeric = {            if ((id &lt;= 0) || (id &gt;= 1)) {                stop("'id' must be between 0 and 1")            }            as.logical(abs(resid(object, type = idResType)) &gt;                 -qnorm(id/2))        }, call = eval(asOneSidedFormula(id)[[2]], data), stop("'id' can only be a formula or numeric"))        if (is.null(idLabels)) {            idLabels &lt;- getGroups(object)            if (length(idLabels) == 0)                 idLabels &lt;- 1:object$dims$N            idLabels &lt;- as.character(idLabels)        }        else {            if (mode(idLabels) == "call") {                idLabels &lt;- as.character(eval(asOneSidedFormula(idLabels)[[2]],                   data))            }            else if (is.vector(idLabels)) {                if (length(idLabels &lt;- unlist(idLabels)) != length(id)) {                  stop("'idLabels' of incorrect length")                }                idLabels &lt;- as.character(idLabels)            }            else {                stop("'idLabels' can only be a formula or a vector")            }        }    }    if (missing(abline)) {        if (missing(form)) {            abline &lt;- c(0, 0)        }        else {            abline &lt;- NULL        }    }    assign("abl", abline)    if (length(argForm) == 3) {        if (is.numeric(.y)) {            plotFun &lt;- "xyplot"            if (is.null(args$panel)) {                args &lt;- c(args, panel = list(function(x, y, subscripts,                   ...) {                  x &lt;- as.numeric(x)                  y &lt;- as.numeric(y)                  dots &lt;- list(...)                  if (grid) panel.grid()                  panel.xyplot(x, y, ...)                  if (any(ids &lt;- id[subscripts])) {                    ltext(x[ids], y[ids], idLabels[subscripts][ids],                       cex = dots$cex, adj = dots$adj)                  }                  if (!is.null(abl)) {                    if (length(abl) == 2) panel.abline(a = abl,                       ...) else panel.abline(h = abl, ...)                  }                }))            }        }        else {            plotFun &lt;- "bwplot"            if (is.null(args$panel)) {                args &lt;- c(args, panel = list(function(x, y, ...) {                  if (grid) panel.grid()                  panel.bwplot(x, y, ...)                  if (!is.null(abl)) {                    panel.abline(v = abl[1], ...)                  }                }))            }        }    }    else {        plotFun &lt;- "histogram"        if (is.null(args$panel)) {            args &lt;- c(args, panel = list(function(x, ...) {                if (grid) panel.grid()                panel.histogram(x, ...)                if (!is.null(abl)) {                  panel.abline(v = abl[1], ...)                }            }))        }    }    if (missing(grid)) {        if (plotFun == "xyplot")             grid &lt;- TRUE        else grid &lt;- FALSE    }    do.call(plotFun, as.list(args))})(x = fm4.6, sub.caption = NA, main = "Residuals from full polynomial weeks model"): object 'fm4.6' not found</span></div><div class='input'>

<span class='co'>##----fm4.7----</span>
<span class='no'>fm4.7</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/gls'>gls</a></span>(
  <span class='no'>y</span> ~  <span class='no'>polBlocks</span> + <span class='no'>variety</span> + <span class='no'>rawWeeks</span>[,<span class='fl'>1</span>] + <span class='no'>rawWeeks</span>[,<span class='fl'>2</span>] +
    <span class='no'>polBlocks</span>:(<span class='no'>rawWeeks</span>[,<span class='fl'>1</span>] + <span class='no'>rawWeeks</span>[,<span class='fl'>2</span>]+ <span class='no'>polWeeks</span>[,<span class='fl'>3</span>] + <span class='no'>polWeeks</span>[,<span class='fl'>4</span>]) +
    <span class='no'>variety</span>:(<span class='no'>rawWeeks</span>[,<span class='fl'>1</span>] + <span class='no'>rawWeeks</span>[,<span class='fl'>2</span>])
  , <span class='kw'>corr</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/corExp'>corExp</a></span>(<span class='kw'>form</span> <span class='kw'>=</span> ~ <span class='no'>varweek</span> <span class='kw'>|</span> <span class='no'>factplot</span>, <span class='kw'>nugget</span><span class='kw'>=</span><span class='fl'>TRUE</span>), <span class='no'>sorghum</span>)
<span class='no'>fm4.7.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm4.7</span>)
<span class='no'>fm4.7.Coef</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/tidy'>tidy</a></span>(<span class='no'>fm4.7</span>)
<span class='no'>fm4.7.vcov</span> <span class='kw'>&lt;-</span> <span class='fu'>vcov</span>(<span class='no'>fm4.7</span>)

<span class='no'>fm4.7.Par</span> <span class='kw'>&lt;-</span>
  <span class='kw pkg'>tibble</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/tibble/topics/tibble'>tibble</a></span>(
    <span class='st'>"Parameter"</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Range"</span>, <span class='st'>"Nugget"</span>, <span class='st'>"rho"</span>)
    , <span class='st'>"Value"</span>     <span class='kw'>=</span> <span class='fu'>c</span>(
      <span class='fu'>coef</span>(<span class='no'>fm4.7</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>1</span>]
      , <span class='fu'>coef</span>(<span class='no'>fm4.7</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>2</span>]
      , (<span class='fl'>1</span>-<span class='fu'>coef</span>(<span class='no'>fm4.7</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>2</span>])*
        <span class='fu'>exp</span>(-<span class='fl'>1</span>/<span class='fu'>coef</span>(<span class='no'>fm4.7</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>1</span>])
    )
  )

<span class='no'>fm4.7.ACF</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/ACF'>ACF</a></span>(<span class='no'>fm4.7</span>)


<span class='co'>##----fm4.7.ANOVA----</span>
 <span class='no'>fm4.7.ANOVA</span></div><div class='output co'>#&gt; Denom. DF: 68 
#&gt;                         numDF   F-value p-value
#&gt; (Intercept)                 1 21284.944  &lt;.0001
#&gt; polBlocks                   4    94.361  &lt;.0001
#&gt; variety                     3    88.053  &lt;.0001
#&gt; rawWeeks[, 1]               1  1548.209  &lt;.0001
#&gt; rawWeeks[, 2]               1    29.762  &lt;.0001
#&gt; polBlocks:rawWeeks[, 1]     4    11.277  &lt;.0001
#&gt; polBlocks:rawWeeks[, 2]     4     0.794  0.5335
#&gt; polBlocks:polWeeks[, 3]     4     0.034  0.9978
#&gt; polBlocks:polWeeks[, 4]     4     1.011  0.4081
#&gt; variety:rawWeeks[, 1]       3    19.094  &lt;.0001
#&gt; variety:rawWeeks[, 2]       3     8.219  0.0001</div><div class='input'>
<span class='co'>##----fm4.7.Coef----</span>
 <span class='no'>fm4.7.Coef</span></div><div class='output co'>#&gt; # A tibble: 32 x 5
#&gt;    term          estimate std.error statistic  p.value
#&gt;    &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
#&gt;  1 (Intercept)    4.68       0.122     38.4   7.73e-48
#&gt;  2 polBlocks1    -6.45       0.609    -10.6   5.13e-16
#&gt;  3 polBlocks2    -1.26       0.609     -2.07  4.25e- 2
#&gt;  4 polBlocks3    -0.110      0.609     -0.180 8.58e- 1
#&gt;  5 polBlocks4     0.369      0.609      0.605 5.47e- 1
#&gt;  6 variety2       0.785      0.172      4.56  2.23e- 5
#&gt;  7 variety3       0.0732     0.172      0.425 6.72e- 1
#&gt;  8 variety4       0.501      0.172      2.91  4.92e- 3
#&gt;  9 rawWeeks[, 1] -0.379      0.0829    -4.57  2.12e- 5
#&gt; 10 rawWeeks[, 2] -0.00429    0.0136    -0.316 7.53e- 1
#&gt; # ... with 22 more rows</div><div class='input'>
<span class='co'>##----fm4.7.Par----</span>
 <span class='no'>fm4.7.Par</span></div><div class='output co'>#&gt; # A tibble: 3 x 2
#&gt;   Parameter   Value
#&gt;   &lt;chr&gt;       &lt;dbl&gt;
#&gt; 1 Range     2.84e+9
#&gt; 2 Nugget    4.61e-1
#&gt; 3 rho       5.39e-1</div><div class='input'>
<span class='co'>##----fm4.7.Plot1----</span>
<span class='fu'>plot</span>(<span class='no'>fm4.7.ACF</span>)</div><div class='img'><img src='example4-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm4.7.Plot2----</span>
<span class='fu'>plot</span>(<span class='no'>fm4.7</span>, <span class='kw'>sub.caption</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Residuals from quadratic regression model"</span>)</div><div class='output co'>#&gt; <span class='error'>Error in (function (x, form = resid(., type = "pearson") ~ fitted(.),     abline, id = NULL, idLabels = NULL, idResType = c("pearson",         "normalized"), grid, ...) {    object &lt;- x    if (!inherits(form, "formula")) {        stop("'form' must be a formula")    }    allV &lt;- all.vars(asOneFormula(form, id, idLabels))    allV &lt;- allV[is.na(match(allV, c("T", "F", "TRUE", "FALSE")))]    if (length(allV) &gt; 0) {        data &lt;- getData(object)        if (is.null(data)) {            alist &lt;- lapply(as.list(allV), as.name)            names(alist) &lt;- allV            alist &lt;- c(list(quote(data.frame)), alist)            mode(alist) &lt;- "call"            data &lt;- eval(alist, sys.parent(1))        }        else {            if (any(naV &lt;- is.na(match(allV, names(data))))) {                stop(sprintf(ngettext(sum(naV), "%s not found in data",                   "%s not found in data"), allV[naV]), domain = NA)            }        }    }    else data &lt;- NULL    if (inherits(data, "groupedData")) {        ff &lt;- formula(data)        rF &lt;- deparse(getResponseFormula(ff)[[2]])        cF &lt;- c_deparse(getCovariateFormula(ff)[[2]])        lbs &lt;- attr(data, "labels")        unts &lt;- attr(data, "units")        if (!is.null(lbs$x))             cL &lt;- paste(lbs$x, unts$x)        else cF &lt;- NULL        if (!is.null(lbs$y))             rL &lt;- paste(lbs$y, unts$y)        else rF &lt;- NULL    }    else {        rF &lt;- cF &lt;- NULL    }    dots &lt;- list(...)    if (length(dots) &gt; 0)         args &lt;- dots    else args &lt;- list()    data &lt;- as.list(c(as.list(data), . = list(object)))    covF &lt;- getCovariateFormula(form)    .x &lt;- eval(covF[[2]], data)    if (!is.numeric(.x)) {        stop("covariate must be numeric")    }    argForm &lt;- ~.x    argData &lt;- data.frame(.x = .x, check.names = FALSE)    if (is.null(xlab &lt;- attr(.x, "label"))) {        xlab &lt;- deparse(covF[[2]])        if (!is.null(cF) &amp;&amp; (xlab == cF))             xlab &lt;- cL        else if (!is.null(rF) &amp;&amp; (xlab == rF))             xlab &lt;- rL    }    if (is.null(args$xlab))         args$xlab &lt;- xlab    respF &lt;- getResponseFormula(form)    if (!is.null(respF)) {        .y &lt;- eval(respF[[2]], data)        if (is.null(ylab &lt;- attr(.y, "label"))) {            ylab &lt;- deparse(respF[[2]])            if (!is.null(cF) &amp;&amp; (ylab == cF))                 ylab &lt;- cL            else if (!is.null(rF) &amp;&amp; (ylab == rF))                 ylab &lt;- rL        }        argForm &lt;- .y ~ .x        argData[, ".y"] &lt;- .y        if (is.null(args$ylab))             args$ylab &lt;- ylab    }    grpsF &lt;- getGroupsFormula(form)    if (!is.null(grpsF)) {        gr &lt;- splitFormula(grpsF, sep = "*")        for (i in seq_along(gr)) {            auxGr &lt;- all.vars(gr[[i]])            for (j in auxGr) {                argData[[j]] &lt;- eval(as.name(j), data)            }        }        if (length(argForm) == 2)             argForm &lt;- eval(parse(text = paste("~ .x |", deparse(grpsF[[2]]))))        else argForm &lt;- eval(parse(text = paste(".y ~ .x |",             deparse(grpsF[[2]]))))    }    args &lt;- c(list(argForm, data = argData), args)    if (is.null(args$cex))         args$cex &lt;- par("cex")    if (is.null(args$adj))         args$adj &lt;- par("adj")    if (!is.null(id)) {        idResType &lt;- match.arg(idResType)        id &lt;- switch(mode(id), numeric = {            if ((id &lt;= 0) || (id &gt;= 1)) {                stop("'id' must be between 0 and 1")            }            as.logical(abs(resid(object, type = idResType)) &gt;                 -qnorm(id/2))        }, call = eval(asOneSidedFormula(id)[[2]], data), stop("'id' can only be a formula or numeric"))        if (is.null(idLabels)) {            idLabels &lt;- getGroups(object)            if (length(idLabels) == 0)                 idLabels &lt;- 1:object$dims$N            idLabels &lt;- as.character(idLabels)        }        else {            if (mode(idLabels) == "call") {                idLabels &lt;- as.character(eval(asOneSidedFormula(idLabels)[[2]],                   data))            }            else if (is.vector(idLabels)) {                if (length(idLabels &lt;- unlist(idLabels)) != length(id)) {                  stop("'idLabels' of incorrect length")                }                idLabels &lt;- as.character(idLabels)            }            else {                stop("'idLabels' can only be a formula or a vector")            }        }    }    if (missing(abline)) {        if (missing(form)) {            abline &lt;- c(0, 0)        }        else {            abline &lt;- NULL        }    }    assign("abl", abline)    if (length(argForm) == 3) {        if (is.numeric(.y)) {            plotFun &lt;- "xyplot"            if (is.null(args$panel)) {                args &lt;- c(args, panel = list(function(x, y, subscripts,                   ...) {                  x &lt;- as.numeric(x)                  y &lt;- as.numeric(y)                  dots &lt;- list(...)                  if (grid) panel.grid()                  panel.xyplot(x, y, ...)                  if (any(ids &lt;- id[subscripts])) {                    ltext(x[ids], y[ids], idLabels[subscripts][ids],                       cex = dots$cex, adj = dots$adj)                  }                  if (!is.null(abl)) {                    if (length(abl) == 2) panel.abline(a = abl,                       ...) else panel.abline(h = abl, ...)                  }                }))            }        }        else {            plotFun &lt;- "bwplot"            if (is.null(args$panel)) {                args &lt;- c(args, panel = list(function(x, y, ...) {                  if (grid) panel.grid()                  panel.bwplot(x, y, ...)                  if (!is.null(abl)) {                    panel.abline(v = abl[1], ...)                  }                }))            }        }    }    else {        plotFun &lt;- "histogram"        if (is.null(args$panel)) {            args &lt;- c(args, panel = list(function(x, ...) {                if (grid) panel.grid()                panel.histogram(x, ...)                if (!is.null(abl)) {                  panel.abline(v = abl[1], ...)                }            }))        }    }    if (missing(grid)) {        if (plotFun == "xyplot")             grid &lt;- TRUE        else grid &lt;- FALSE    }    do.call(plotFun, as.list(args))})(x = fm4.7, sub.caption = NA, main = "Residuals from quadratic regression model"): object 'fm4.7' not found</span></div><div class='input'>
<span class='co'>##----fm4.8----</span>
<span class='no'>fm4.8</span> <span class='kw'>&lt;-</span>  <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/gls'>gls</a></span>(
  <span class='no'>y</span> ~ <span class='no'>Replicate</span> * (<span class='no'>rawWeeks</span>[,<span class='fl'>1</span>] + <span class='no'>rawWeeks</span>[,<span class='fl'>2</span>] + <span class='no'>polWeeks</span>[,<span class='fl'>3</span>] + <span class='no'>polWeeks</span>[,<span class='fl'>4</span>]) +
    <span class='no'>variety</span> * (<span class='no'>rawWeeks</span>[,<span class='fl'>1</span>] + <span class='no'>rawWeeks</span>[,<span class='fl'>2</span>])
  ,  <span class='kw'>corr</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/corExp'>corExp</a></span>(<span class='kw'>form</span> <span class='kw'>=</span> ~ <span class='no'>varweek</span> <span class='kw'>|</span> <span class='no'>factplot</span>, <span class='kw'>nugget</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='no'>sorghum</span>)
<span class='no'>fm4.8.ANOVA</span> <span class='kw'>&lt;-</span> <span class='fu'>anova</span>(<span class='no'>fm4.8</span>)
<span class='no'>fm4.8.Coef</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>broom</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/broom/topics/tidy'>tidy</a></span>(<span class='no'>fm4.8</span>)
<span class='no'>fm4.8.vcov</span> <span class='kw'>&lt;-</span> <span class='fu'>vcov</span>(<span class='no'>fm4.8</span>)

<span class='no'>fm4.8.Par</span> <span class='kw'>&lt;-</span>
  <span class='kw pkg'>tibble</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/tibble/topics/tibble'>tibble</a></span>(
    <span class='st'>"Parameter"</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Range"</span>, <span class='st'>"Nugget"</span>, <span class='st'>"rho"</span>)
    , <span class='st'>"Value"</span>     <span class='kw'>=</span> <span class='fu'>c</span>(
      <span class='fu'>coef</span>(<span class='no'>fm4.8</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>1</span>]
      , <span class='fu'>coef</span>(<span class='no'>fm4.8</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>2</span>]
      , (<span class='fl'>1</span>-<span class='fu'>coef</span>(<span class='no'>fm4.8</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>2</span>])*
        <span class='fu'>exp</span>(-<span class='fl'>1</span>/<span class='fu'>coef</span>(<span class='no'>fm4.8</span>$<span class='no'>modelStruct</span>$<span class='no'>corStruct</span>, <span class='kw'>unconstrained</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)[<span class='fl'>1</span>])
    )
  )

<span class='no'>fm4.8.ACF</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>nlme</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/ACF'>ACF</a></span>(<span class='no'>fm4.8</span>)

<span class='co'>##----fm4.8.ANOVA----</span>
 <span class='no'>fm4.8.ANOVA</span></div><div class='output co'>#&gt; Denom. DF: 66 
#&gt;                         numDF   F-value p-value
#&gt; (Intercept)                 1 21467.274  &lt;.0001
#&gt; Replicate                   4    95.007  &lt;.0001
#&gt; rawWeeks[, 1]               1  1811.798  &lt;.0001
#&gt; rawWeeks[, 2]               1    39.995  &lt;.0001
#&gt; polWeeks[, 3]               1    10.228  0.0021
#&gt; polWeeks[, 4]               1    10.559  0.0018
#&gt; variety                     3    88.215  &lt;.0001
#&gt; Replicate:rawWeeks[, 1]     4    13.217  &lt;.0001
#&gt; Replicate:rawWeeks[, 2]     4     1.068  0.3795
#&gt; Replicate:polWeeks[, 3]     4     0.046  0.9959
#&gt; Replicate:polWeeks[, 4]     4     1.398  0.2443
#&gt; rawWeeks[, 1]:variety       3    22.388  &lt;.0001
#&gt; rawWeeks[, 2]:variety       3    10.994  &lt;.0001</div><div class='input'>
<span class='co'>##----fm4.8.Coef----</span>
 <span class='no'>fm4.8.Coef</span></div><div class='output co'>#&gt; # A tibble: 34 x 5
#&gt;    term          estimate std.error statistic  p.value
#&gt;    &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
#&gt;  1 (Intercept)    5.46       0.155     35.2   1.62e-44
#&gt;  2 Replicate2    -0.302      0.173     -1.75  8.53e- 2
#&gt;  3 Replicate3    -0.569      0.173     -3.29  1.63e- 3
#&gt;  4 Replicate4    -1.18       0.173     -6.83  3.23e- 9
#&gt;  5 Replicate5    -1.84       0.173    -10.6   6.47e-16
#&gt;  6 rawWeeks[, 1] -0.412      0.102     -4.05  1.37e- 4
#&gt;  7 rawWeeks[, 2] -0.00938    0.0166    -0.566 5.73e- 1
#&gt;  8 polWeeks[, 3]  0.385      0.217      1.78  7.97e- 2
#&gt;  9 polWeeks[, 4] -0.686      0.216     -3.18  2.24e- 3
#&gt; 10 variety2       0.786      0.155      5.07  3.38e- 6
#&gt; # ... with 24 more rows</div><div class='input'>
<span class='co'>##----fm4.8.Par----</span>
 <span class='no'>fm4.8.Par</span></div><div class='output co'>#&gt; # A tibble: 3 x 2
#&gt;   Parameter  Value
#&gt;   &lt;chr&gt;      &lt;dbl&gt;
#&gt; 1 Range     42.8  
#&gt; 2 Nugget     0.359
#&gt; 3 rho        0.627</div><div class='input'>
<span class='co'>##----fm4.8.Plot1----</span>
<span class='fu'>plot</span>(<span class='no'>fm4.8.ACF</span>)</div><div class='img'><img src='example4-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##----fm4.8.Plot2----</span>
<span class='fu'>plot</span>(<span class='no'>fm4.8</span>,<span class='kw'>sub.caption</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Quadratic treatment-by-weeks model with full
blocks-by-weeks model"</span>)</div><div class='output co'>#&gt; <span class='error'>Error in (function (x, form = resid(., type = "pearson") ~ fitted(.),     abline, id = NULL, idLabels = NULL, idResType = c("pearson",         "normalized"), grid, ...) {    object &lt;- x    if (!inherits(form, "formula")) {        stop("'form' must be a formula")    }    allV &lt;- all.vars(asOneFormula(form, id, idLabels))    allV &lt;- allV[is.na(match(allV, c("T", "F", "TRUE", "FALSE")))]    if (length(allV) &gt; 0) {        data &lt;- getData(object)        if (is.null(data)) {            alist &lt;- lapply(as.list(allV), as.name)            names(alist) &lt;- allV            alist &lt;- c(list(quote(data.frame)), alist)            mode(alist) &lt;- "call"            data &lt;- eval(alist, sys.parent(1))        }        else {            if (any(naV &lt;- is.na(match(allV, names(data))))) {                stop(sprintf(ngettext(sum(naV), "%s not found in data",                   "%s not found in data"), allV[naV]), domain = NA)            }        }    }    else data &lt;- NULL    if (inherits(data, "groupedData")) {        ff &lt;- formula(data)        rF &lt;- deparse(getResponseFormula(ff)[[2]])        cF &lt;- c_deparse(getCovariateFormula(ff)[[2]])        lbs &lt;- attr(data, "labels")        unts &lt;- attr(data, "units")        if (!is.null(lbs$x))             cL &lt;- paste(lbs$x, unts$x)        else cF &lt;- NULL        if (!is.null(lbs$y))             rL &lt;- paste(lbs$y, unts$y)        else rF &lt;- NULL    }    else {        rF &lt;- cF &lt;- NULL    }    dots &lt;- list(...)    if (length(dots) &gt; 0)         args &lt;- dots    else args &lt;- list()    data &lt;- as.list(c(as.list(data), . = list(object)))    covF &lt;- getCovariateFormula(form)    .x &lt;- eval(covF[[2]], data)    if (!is.numeric(.x)) {        stop("covariate must be numeric")    }    argForm &lt;- ~.x    argData &lt;- data.frame(.x = .x, check.names = FALSE)    if (is.null(xlab &lt;- attr(.x, "label"))) {        xlab &lt;- deparse(covF[[2]])        if (!is.null(cF) &amp;&amp; (xlab == cF))             xlab &lt;- cL        else if (!is.null(rF) &amp;&amp; (xlab == rF))             xlab &lt;- rL    }    if (is.null(args$xlab))         args$xlab &lt;- xlab    respF &lt;- getResponseFormula(form)    if (!is.null(respF)) {        .y &lt;- eval(respF[[2]], data)        if (is.null(ylab &lt;- attr(.y, "label"))) {            ylab &lt;- deparse(respF[[2]])            if (!is.null(cF) &amp;&amp; (ylab == cF))                 ylab &lt;- cL            else if (!is.null(rF) &amp;&amp; (ylab == rF))                 ylab &lt;- rL        }        argForm &lt;- .y ~ .x        argData[, ".y"] &lt;- .y        if (is.null(args$ylab))             args$ylab &lt;- ylab    }    grpsF &lt;- getGroupsFormula(form)    if (!is.null(grpsF)) {        gr &lt;- splitFormula(grpsF, sep = "*")        for (i in seq_along(gr)) {            auxGr &lt;- all.vars(gr[[i]])            for (j in auxGr) {                argData[[j]] &lt;- eval(as.name(j), data)            }        }        if (length(argForm) == 2)             argForm &lt;- eval(parse(text = paste("~ .x |", deparse(grpsF[[2]]))))        else argForm &lt;- eval(parse(text = paste(".y ~ .x |",             deparse(grpsF[[2]]))))    }    args &lt;- c(list(argForm, data = argData), args)    if (is.null(args$cex))         args$cex &lt;- par("cex")    if (is.null(args$adj))         args$adj &lt;- par("adj")    if (!is.null(id)) {        idResType &lt;- match.arg(idResType)        id &lt;- switch(mode(id), numeric = {            if ((id &lt;= 0) || (id &gt;= 1)) {                stop("'id' must be between 0 and 1")            }            as.logical(abs(resid(object, type = idResType)) &gt;                 -qnorm(id/2))        }, call = eval(asOneSidedFormula(id)[[2]], data), stop("'id' can only be a formula or numeric"))        if (is.null(idLabels)) {            idLabels &lt;- getGroups(object)            if (length(idLabels) == 0)                 idLabels &lt;- 1:object$dims$N            idLabels &lt;- as.character(idLabels)        }        else {            if (mode(idLabels) == "call") {                idLabels &lt;- as.character(eval(asOneSidedFormula(idLabels)[[2]],                   data))            }            else if (is.vector(idLabels)) {                if (length(idLabels &lt;- unlist(idLabels)) != length(id)) {                  stop("'idLabels' of incorrect length")                }                idLabels &lt;- as.character(idLabels)            }            else {                stop("'idLabels' can only be a formula or a vector")            }        }    }    if (missing(abline)) {        if (missing(form)) {            abline &lt;- c(0, 0)        }        else {            abline &lt;- NULL        }    }    assign("abl", abline)    if (length(argForm) == 3) {        if (is.numeric(.y)) {            plotFun &lt;- "xyplot"            if (is.null(args$panel)) {                args &lt;- c(args, panel = list(function(x, y, subscripts,                   ...) {                  x &lt;- as.numeric(x)                  y &lt;- as.numeric(y)                  dots &lt;- list(...)                  if (grid) panel.grid()                  panel.xyplot(x, y, ...)                  if (any(ids &lt;- id[subscripts])) {                    ltext(x[ids], y[ids], idLabels[subscripts][ids],                       cex = dots$cex, adj = dots$adj)                  }                  if (!is.null(abl)) {                    if (length(abl) == 2) panel.abline(a = abl,                       ...) else panel.abline(h = abl, ...)                  }                }))            }        }        else {            plotFun &lt;- "bwplot"            if (is.null(args$panel)) {                args &lt;- c(args, panel = list(function(x, y, ...) {                  if (grid) panel.grid()                  panel.bwplot(x, y, ...)                  if (!is.null(abl)) {                    panel.abline(v = abl[1], ...)                  }                }))            }        }    }    else {        plotFun &lt;- "histogram"        if (is.null(args$panel)) {            args &lt;- c(args, panel = list(function(x, ...) {                if (grid) panel.grid()                panel.histogram(x, ...)                if (!is.null(abl)) {                  panel.abline(v = abl[1], ...)                }            }))        }    }    if (missing(grid)) {        if (plotFun == "xyplot")             grid &lt;- TRUE        else grid &lt;- FALSE    }    do.call(plotFun, as.list(args))})(x = fm4.8, sub.caption = NA, main = "Quadratic treatment-by-weeks model with full\nblocks-by-weeks model"): object 'fm4.8' not found</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
<ol>
<li><p>Rodney N. Edmondson (<a href='mailto:rodney.edmondson@gmail.com'>rodney.edmondson@gmail.com</a>)</p></li>
<li><p>Hans-Peter Piepho (<a href='mailto:piepho@uni-hohenheim.de'>piepho@uni-hohenheim.de</a>)</p></li>
<li><p>Muhammad Yaseen (<a href='mailto:myaseen208@gmail.com'>myaseen208@gmail.com</a>)</p></li>
</ol>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Rodney Edmondson, Hans-Peter Piepho, Muhammad Yaseen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

